function List(t){Map.call(this,t)}function Map(t){void 0!=t&&"object"==typeof t||(t={}),this.contents=t}function SongBookMusicConfig(t,e,o){Map.call(this,o),this.configuration=t,this.number=e,this.name=null,this.composer=null,this.tonality=null,this.spotifyLink=null,this.openLink=null,this.youtubeUrl=null,this.sheetStartTime=null,this.sheetEndTime=null,this.syncLastBar=null,this.getName(),this.getComposer(),this.getTonality(),this.getSpotifyLink(),this.getOpenLink(),this.getYoutubeUrl(),this.getSheetStartTime(),this.getSheetEndTime(),this.getSyncLastBar(),this.partMap=this.buildPartMap()}function SongBookMusicBarConfig(t,e,o,r){void 0==r&&(r=[]),this.data=r,this.partConfig=t,this.number=o,this.startTime=null,this.endTime=null,this.customLineBars=null,this.speed=e,this.getStartTime(),this.getEndTime(),this.getCustomLineBars()}function SongBookMusicPartConfig(t,e,o){Map.call(this,o),this.musicConfig=t,this.number=e,this.display=null,this.normalSeekStartTime=null,this.normalSeekEndTime=null,this.slowSeekStartTime=null,this.slowSeekEndTime=null,this.getDisplay(),this.getNormalSeekStartTime(),this.getNormalSeekEndTime(),this.getSlowSeekStartTime(),this.getSlowSeekEndTime(),this.normalBarMap=this.buildBarMap(SongBookPlayer.PLAY_NORMAL_SPEED_TYPE),this.slowBarMap=this.buildBarMap(SongBookPlayer.PLAY_SLOW_SPEED_TYPE)}function SongBookConfiguration(t,e){Map.call(this,e),this.songBook=t,this.sheetUrlPrefix=null,this.version=null,this.name=null,this.fullname=null,this.debug=null,this.getVersion(),this.getName(),this.getFullName(),this.isDebugging(),this.musicMap=this.buildMusicMap()}function BarDebuggerOutput(t,e,o){SelectableElement.call(this,o),this.partOutput=t,this.barConfig=e,this.element=o,this.firstSync=!0,this.buildMappings()}function SongBookDebugger(t){this.songbook=t,this.modified=!1,this.editing=!1,this.syncStarted=!1,this.element=null,this.size=null,this.outputManager=new DebuggerOutputManager(this),this.messenger=new DebuggerMessenger(this),this.buildMappings()}function DebuggerMessenger(t){this.element=null,this.debug=t}function DebuggerOutputManager(t){this.debug=t,this.outputMap=new Map,this.partLogMap=new Map,this.firstSync=!0,this.lastSync=!1,this.lastCreatedBarNumber=0,this.changeSheetTimes=!1}function PartLogDebuggerOutput(t,e,o){SelectableElement.call(this,o),this.outputManager=t,this.partConfig=e,this.element=o,this.buildMappings()}function PartDebuggerOutput(t,e,o){SelectableElement.call(this,o),this.speedOutput=t,this.partConfig=e,this.firstCreatedBarNumber=1,this.currentSpeedLabel=t.getSpeedLabel(),this.element=o,this.barsMap=new Map,this.buildMappings()}function SpeedDebuggerOutput(t,e,o){SelectableElement.call(this,o),this.outputManager=t,this.speedLabel=e,this.element=o,this.partsMap=new Map,this.buildMappings()}function SongBook(t){this.configuration=new SongBookConfiguration(this,t),this.name=this.getConfiguration().getName(),this.element=null,this.updateName(),this.getElement(),this.musicList=new SongBookMusicList(this),this.musicPanel=new SongBookMusicPanel(this),this.songBookPlayer=new SongBookPlayer(this),this.populateSongbookInfo(),this.debugger=new SongBookDebugger(this),this.sheetReviewer=new SongBookSheetReviewer(this),this.buildMappings()}function SongBookMusic(t,e){SelectableElement.call(this,e),this.songbook=t,this.element=e,this.number=null,this.name=null,this.composer=null,this.tonality=null,this.youtubeUrl="",this.buttons={},this.selected=!1,this.partList=new SongBookMusicPartList(this),this.getName(),this.getComposer(),this.getTonality(),this.buildMappings()}function SongBookMusicList(t){this.element=null,this.songbook=t,this.list={},this.getElement(),this.buildMusicList()}function SongBookMusicPanel(t){this.element=null,this.songbook=t,this.currentSongBookMusic=null,this.getElement()}function SongBookMusicPart(t,e){SelectableElement.call(this),this.songBookMusic=t,this.element=null,this.partConfig=e,this.selected=!1}function SongBookMusicPartList(t){this.songBookMusic=t,this.list={},this.buildMusicPartList()}function SongBookPlayerButton(t,e){SelectableElement.call(this,e),this.playerPanel=t,this.element=e,this.selected=!1,this.startSelected=null,this.type=null,this.value=null,this.getType(),this.getValue(),this.buildMappings()}function SongBookPlayer(t,e){this.name=e,this.element=null,this.songBook=t,this.player=null,this.playerSize=SongBookPlayer.FULLHD_PLAYER_SIZE,this.enabled=!0,this.repeat=!1,this.playSpeedType=SongBookPlayer.PLAY_NORMAL_SPEED_TYPE,this.playerPanel=new SongBookPlayerPanel(this),this.sheetViewer=new SongBookSheetViewer(this),this.sheetPreloader=new SongBookSheetPreloader(this),this.watchTimeout=null}function SongBookPlayerPanel(t){this.player=t,this.buttons=this.buildButtons(),this.element=null}function SongBookSheetPreloader(t){this.element=null,this.songBookPlayer=t,this.imageMap=null,this.getElement()}function SheetReviewerCompassButton(t,e,o){SelectableElement.call(this,o),this.sheetReviewer=t,this.name=e,this.element=o,this.compassNumber=0,this.getElement(),this.buildMappings()}function SongBookSheetReviewer(t){this.element=null,this.songBook=t,this.currentBarNumber=null,this.currentBarOutput=null,this.viewsMap=new Map,this.compassButtonsMap=new Map,this.getElement(),this.buildViewsMap(),this.buildCompassButtonsMap(),this.buildMappings()}function SheetReviewerView(t,e,o){this.sheetReviewer=t,this.name=e,this.element=o,this.url=null,this.barNumber=null,this.getElement(),this.buildMappings()}function SongBookSheetViewer(t){this.element=null,this.displayImageElement=null,this.songBookPlayer=t,this.showNoteNames=!1,this.lastUrl=null,this.lastPartNumber=null,this.url=null,this.displayType=SongBookSheetViewer.PART_TYPE,this.getElement(),this.zoomController=new SongBookSheetZoomController(this),this.buildMappings()}function SongBookSheetZoomController(t){this.sheetViewer=t,this.element=null,this.placeHoldElement=null,this.placeHoldDeimiterElement=null,this.zoomContainerElement=null,this.enabled=!0,this.getElement(),this.getPlaceHoldElement(),this.getPlaceHoldDelimiterElement(),this.getZoomContainerElement(),this.buildMappings()}List.prototype=Object.create(Map.prototype),List.prototype.constructor=List,List.prototype.add=function(t,e){return this.put(t,e),this},Map.prototype.getContents=function(){return this.contents},Map.prototype.setContents=function(t){return this.contents=t,this},Map.prototype.put=function(t,e){return"string"==typeof t&&t.indexOf(".")>-1?this.setByString(t,e):this.getContents()[t]=e,this},Map.prototype.remove=function(t){return delete this.getContents()[t],this},Map.prototype.get=function(t){return"string"==typeof t&&t.indexOf(".")>-1?this.getByString(t):this.getContents()[t]},Map.prototype.each=function(t){var e=this.getContents();for(var o in e){var r=t.call(this,o,e[o]);if(void 0!=r&&0==r)break}},Map.prototype.eachOf=function(t,e){var o=this.getByString(t);if("function"==typeof e)for(var r in o){var n=e.call(this,r,o[r]);if(void 0!=n&&0==n)break}},Map.prototype.getByString=function(t){var e=t,o=this.getContents();try{for(var r=(e=(e=e.replace(/\[(\w+)\]/g,".$1")).replace(/^\./,"")).split("."),n=0,i=r.length;n<i;++n){var u=r[n];if(!(u in o))return;o=o[u]}return o}catch(t){return}},Map.prototype.setByString=function(t,e){for(var o=t.split("."),r=this.getContents(),n=0;n<o.length-1;)void 0===r[o[n]]&&(r[o[n]]={}),r=r[o[n]],n++;return r[o[o.length-1]]=e,this},Map.prototype.isEmpty=function(){var t=this.getContents();for(var e in t)if(t.hasOwnProperty(e))return!1;return JSON.stringify(t)===JSON.stringify({})},Map.prototype.isFirstValue=function(t){var e=this.getContents();return t==e[Object.keys(e)[0]]},Map.prototype.isLastValue=function(t){var e=this.getContents(),o=Object.keys(e);return t==e[o[o.length-1]]},Map.prototype.getKeys=function(){return Object.keys(this.contents)},Map.prototype.size=function(){return this.getKeys().length},Map.prototype.sort=function(t,e){var o=this.contents,r={};for(var n in o){var i=o[n];r[t]=i,t=e.call(this,n,i)}return this.contents=r,this},Map.prototype.clear=function(){return this.contents={},this},SongBookMusicConfig.prototype=Object.create(Map.prototype),SongBookMusicConfig.prototype.constructor=SongBookMusicConfig,SongBookMusicConfig.SYNC_PREFIX="syncData",SongBookMusicConfig.SYNC_PARTS_PREFIX="parts",SongBookMusicConfig.prototype.getConfigMirror=function(){var t=this.getConfiguration(),e=this.getNumber();return t.getMusic(e)},SongBookMusicConfig.prototype.getConfiguration=function(){return this.configuration},SongBookMusicConfig.prototype.getNumber=function(){return null==this.number&&(this.number=0),this.number},SongBookMusicConfig.prototype.setNumber=function(t){return this.number=t,this},SongBookMusicConfig.prototype.getName=function(){return null==this.name&&(this.name=this.get("name")),this.name},SongBookMusicConfig.prototype.getComposer=function(){return null==this.composer&&(this.composer=this.get("composer")),this.composer},SongBookMusicConfig.prototype.getTonality=function(){return null==this.tonality&&(this.tonality=this.get("tonality")),this.tonality},SongBookMusicConfig.prototype.getSpotifyLink=function(){return null==this.spotifyLink&&(this.spotifyLink=this.get("spotify_permalink")),this.spotifyLink},SongBookMusicConfig.prototype.getOpenLink=function(){return null==this.openLink&&(this.openLink=this.get("open_permalink")),this.openLink},SongBookMusicConfig.prototype.getYoutubeUrl=function(){return null==this.youtubeUrl&&(this.youtubeUrl=this.get("youtubeUrl")),this.youtubeUrl},SongBookMusicConfig.prototype.getSheetStartTime=function(){return this.sheetStartTime=this.get("sheetStart"),void 0==this.sheetStartTime&&(this.sheetStartTime=0),"string"==typeof this.sheetStartTime&&(this.sheetStartTime=1*this.sheetStartTime),this.sheetStartTime},SongBookMusicConfig.prototype.setSheetStartTime=function(t){return this.sheetStartTime=t,this.put("sheetStart",t),void 0!=this.getConfigMirror()&&(this.getConfigMirror().sheetStartTime=t,this.getConfigMirror().put("sheetStart",t)),this},SongBookMusicConfig.prototype.getSheetEndTime=function(){return this.sheetEndTime=this.get("sheetEnd"),void 0==this.sheetEndTime&&(this.sheetEndTime=999999),"string"==typeof this.sheetEndTime&&(this.sheetEndTime=1*this.sheetEndTime),this.sheetEndTime},SongBookMusicConfig.prototype.setSheetEndTime=function(t){return this.sheetEndTime=t,this.put("sheetEnd",t),void 0!=this.getConfigMirror()&&(this.getConfigMirror().sheetEndTime=t,this.getConfigMirror().put("sheetEnd",t)),this},SongBookMusicConfig.prototype.getSyncLastBar=function(){return this.syncLastBar=this.get(SongBookMusicConfig.SYNC_PREFIX+".lastBar"),void 0==this.syncLastBar&&(this.syncLastBar=0),this.syncLastBar},SongBookMusicConfig.prototype.setSyncLastBar=function(t){return this.syncLastBar=t,this.put(SongBookMusicConfig.SYNC_PREFIX+".lastBar",t),void 0!=this.getConfigMirror()&&(this.getConfigMirror().syncLastBar=t,this.getConfigMirror().put(SongBookMusicConfig.SYNC_PREFIX+".lastBar",t)),this},SongBookMusicConfig.prototype.buildPartMap=function(){var t=this,e=new Map;return this.eachOf(SongBookMusicConfig.SYNC_PARTS_PREFIX,function(o,r){var n=new SongBookMusicPartConfig(t,o,r);e.put(o,n)}),e},SongBookMusicConfig.prototype.getPartMap=function(){return this.partMap},SongBookMusicConfig.prototype.getPart=function(t){return this.getPartMap().get(t)},SongBookMusicConfig.prototype.addPart=function(t,e){return this.getPartMap().put(t,e),this},SongBookMusicConfig.prototype.removePart=function(t){return this.getPartMap().remove(t),this},SongBookMusicConfig.prototype.eachSpeed=function(t,e){return"function"!=typeof e?this:(this.eachOf(SongBookMusicConfig.SYNC_PREFIX+"."+t,function(t,o){e.call(this,{label:t})}),this)},SongBookMusicConfig.prototype.eachPart=function(t){return"function"!=typeof t?this:(this.getPartMap().each(function(e,o){t.call(this,e,o)}),this)},SongBookMusicBarConfig.prototype.getConfigMirror=function(){var t=this.getPartConfig().getMusicConfig().getConfiguration(),e=this.getPartConfig().getMusicConfig().getNumber(),o=this.getPartConfig().getNumber(),r=this.getNumber();return t.getMusic(e).getPart(o).getBar(this.getSpeed(),r)},SongBookMusicBarConfig.prototype.getSpeed=function(){return this.speed},SongBookMusicBarConfig.prototype.getNumber=function(){return null==this.number&&(this.number=0),this.number},SongBookMusicBarConfig.prototype.setNumber=function(t){return this.number=t,this},SongBookMusicBarConfig.prototype.getPartConfig=function(){return this.partConfig},SongBookMusicBarConfig.prototype.getStartTime=function(){return null==this.startTime&&(this.startTime=this.data[0]),this.startTime},SongBookMusicBarConfig.prototype.setStartTime=function(t){return this.startTime=t,this.data[0]=t,void 0!=this.getConfigMirror()&&(this.getConfigMirror().startTime=t,this.getConfigMirror().data[0]=t),this},SongBookMusicBarConfig.prototype.getEndTime=function(){return null==this.endTime&&(this.endTime=this.data[1]),this.endTime},SongBookMusicBarConfig.prototype.setEndTime=function(t){return this.endTime=t,this.data[1]=t,void 0!=this.getConfigMirror()&&(this.getConfigMirror().endTime=t,this.getConfigMirror().data[1]=t),this},SongBookMusicBarConfig.prototype.getCustomLineBars=function(){return null==this.customLineBars&&(this.customLineBars=this.data[2]),this.customLineBars},SongBookMusicBarConfig.prototype.setCustomLineBars=function(t){return this.customLineBars=t,this.data[2]=t,void 0!=this.getConfigMirror()&&(this.getConfigMirror().customLineBars=t,this.getConfigMirror().data[2]=t),this},SongBookMusicBarConfig.prototype.hasCustomLineBars=function(){return void 0!=this.getCustomLineBars()},SongBookMusicPartConfig.prototype=Object.create(Map.prototype),SongBookMusicPartConfig.prototype.constructor=SongBookMusicPartConfig,SongBookMusicPartConfig.prototype.getConfigMirror=function(){var t=this.getMusicConfig().getConfiguration(),e=this.getMusicConfig().getNumber(),o=this.getNumber();return t.getMusic(e).getPart(o)},SongBookMusicPartConfig.prototype.getNumber=function(){return null==this.number&&(this.number=0),this.number},SongBookMusicPartConfig.prototype.setNumber=function(t){return this.number=t,this},SongBookMusicPartConfig.prototype.getMusicConfig=function(){return this.musicConfig},SongBookMusicPartConfig.prototype.getDisplay=function(){return null==this.display&&(this.display=this.get("display")),this.display},SongBookMusicPartConfig.prototype.setDisplay=function(t){return this.display=t,this.put("display",t),void 0!=this.getConfigMirror()&&(this.getConfigMirror().display=t,this.getConfigMirror().put("display",t)),this},SongBookMusicPartConfig.prototype.getNormalSeekStartTime=function(){return this.normalSeekStartTime=this.get("timeToSeek.normal.start"),this.normalSeekStartTime},SongBookMusicPartConfig.prototype.setNormalSeekStartTime=function(t){return this.normalSeekStartTime=t,this.put("timeToSeek.normal.start",t),void 0!=this.getConfigMirror()&&(this.getConfigMirror().normalSeekStartTime=t,this.getConfigMirror().put("timeToSeek.normal.start",t)),this},SongBookMusicPartConfig.prototype.getNormalSeekEndTime=function(){return this.normalSeekEndTime=this.get("timeToSeek.normal.end"),this.normalSeekEndTime},SongBookMusicPartConfig.prototype.setNormalSeekEndTime=function(t){return this.normalSeekEndTime=t,this.put("timeToSeek.normal.end",t),void 0!=this.getConfigMirror()&&(this.getConfigMirror().normalSeekEndTime=t,this.getConfigMirror().put("timeToSeek.normal.end",t)),this},SongBookMusicPartConfig.prototype.getSlowSeekStartTime=function(){return this.slowSeekStartTime=this.get("timeToSeek.slow.start"),this.slowSeekStartTime},SongBookMusicPartConfig.prototype.setSlowSeekStartTime=function(t){return this.slowSeekStartTime=t,this.put("timeToSeek.slow.start",t),void 0!=this.getConfigMirror()&&(this.getConfigMirror().slowSeekStartTime=t,this.getConfigMirror().put("timeToSeek.slow.start",t)),this},SongBookMusicPartConfig.prototype.getSlowSeekEndTime=function(){return this.slowSeekEndTime=this.get("timeToSeek.slow.end"),this.slowSeekEndTime},SongBookMusicPartConfig.prototype.setSlowSeekEndTime=function(t){return this.slowSeekEndTime=t,this.put("timeToSeek.slow.end",t),void 0!=this.getConfigMirror()&&(this.getConfigMirror().slowSeekEndTime=t,this.getConfigMirror().put("timeToSeek.slow.end",t)),this},SongBookMusicPartConfig.prototype.buildBarMap=function(t){var e=this,o=new Map;return this.getMusicConfig().eachOf("syncData.parts."+t+"."+this.getNumber(),function(r,n){var i=new SongBookMusicBarConfig(e,t,r,n);i.setNumber(r),o.put(r,i)}),o},SongBookMusicPartConfig.prototype.getNormalBarMap=function(){return this.normalBarMap},SongBookMusicPartConfig.prototype.getSlowBarMap=function(){return this.slowBarMap},SongBookMusicPartConfig.prototype.addBar=function(t,e,o){return(o==SongBookPlayer.PLAY_NORMAL_SPEED_TYPE?this.getNormalBarMap():this.getSlowBarMap()).put(t,new SongBookMusicBarConfig(e,o,t)),this},SongBookMusicPartConfig.prototype.removeBar=function(t,e){return(e==SongBookPlayer.PLAY_NORMAL_SPEED_TYPE?this.getNormalBarMap():this.getSlowBarMap()).remove(t),this},SongBookMusicPartConfig.prototype.getBar=function(t,e){return t==SongBookPlayer.PLAY_NORMAL_SPEED_TYPE?this.getNormalBarMap().get(e):t==SongBookPlayer.PLAY_SLOW_SPEED_TYPE?this.getSlowBarMap().get(e):void 0},SongBookMusicPartConfig.prototype.eachBar=function(t,e,o){if("function"!=typeof o)return this;(e==SongBookPlayer.PLAY_NORMAL_SPEED_TYPE?this.getNormalBarMap():this.getSlowBarMap()).each(function(t,e){return o.call(this,t,e)})},SongBookConfiguration.prototype=Object.create(Map.prototype),SongBookConfiguration.prototype.constructor=SongBookConfiguration,SongBookConfiguration.prototype.getSongBook=function(){return this.songBook},SongBookConfiguration.prototype.getVersion=function(){return null==this.version&&(this.version=this.get("version")),this.version},SongBookConfiguration.prototype.getName=function(){return null==this.name&&(this.name=this.get("name")),this.name},SongBookConfiguration.prototype.getFullName=function(){return null==this.fullname&&(this.fullname=this.get("fullname")),this.fullname},SongBookConfiguration.prototype.isDebugging=function(){return null==this.debug&&(this.debug=this.get("debug")),1==this.debug},SongBookConfiguration.prototype.getSheetUrlPrefix=function(){return null==this.sheetUrlPrefix&&(this.sheetUrlPrefix=this.get("sheetUrlPrefix")),void 0==this.sheetUrlPrefix&&(this.sheetUrlPrefix=""),this.sheetUrlPrefix},SongBookConfiguration.prototype.buildMusicMap=function(){var t=this,e=new Map;return this.eachOf("musicList",function(o,r){var n=new SongBookMusicConfig(t,o,r);e.put(o,n)}),e},SongBookConfiguration.prototype.getMusicMap=function(){return this.musicMap},SongBookConfiguration.prototype.getMusic=function(t){return this.getMusicMap().get(t)},BarDebuggerOutput.prototype=Object.create(SelectableElement.prototype),BarDebuggerOutput.prototype.constructor=BarDebuggerOutput,BarDebuggerOutput.BARS_PER_LINE=4,BarDebuggerOutput.prototype.getSongBook=function(){return this.getDebugger().getSongBook()},BarDebuggerOutput.prototype.getDebugger=function(){return this.getOutputManager().getDebugger()},BarDebuggerOutput.prototype.getOutputManager=function(){return this.getSpeedOutput().getOutputManager()},BarDebuggerOutput.prototype.getSpeedOutput=function(){return this.getPartOutput().getSpeedOutput()},BarDebuggerOutput.prototype.getPartOutput=function(){return this.partOutput},BarDebuggerOutput.prototype.getPartLogOutput=function(){var t=this.getOutputManager(),e=this.getPartOutput().getNumber();return t.getPartLogOutput(e)},BarDebuggerOutput.prototype.getBarConfig=function(){return this.barConfig},BarDebuggerOutput.prototype.setFirstSync=function(t){return this.firstSync=t,this},BarDebuggerOutput.prototype.isFirstSync=function(){return 1==this.firstSync},BarDebuggerOutput.prototype.isFirst=function(){return this.getPartOutput().isFirstBar(this)},BarDebuggerOutput.prototype.isLast=function(){return this.getPartOutput().isLastBar(this)},BarDebuggerOutput.prototype.isEmpty=function(){var t=this.getBarConfig().getStartTime(),e=this.getBarConfig().getStartTime();return void 0==t&&void 0==e},BarDebuggerOutput.prototype.isLastOfSheet=function(){var t=this.getOutputManager();this.getSongBook().getSelectedMusic().getConfig();return this.getNumber()==t.getLastBarNumber()},BarDebuggerOutput.prototype.getNumber=function(){return this.getBarConfig().getNumber()},BarDebuggerOutput.prototype.setNumber=function(t){return this.getBarConfig().setNumber(t),this.getNumberLabelElement().text(t),this},BarDebuggerOutput.prototype.getElement=function(){return this.element},BarDebuggerOutput.prototype.getNumberLabelElement=function(){return this.getElement().find("em.number")},BarDebuggerOutput.prototype.getStartTimeElement=function(){return this.getElement().find("em.start")},BarDebuggerOutput.prototype.getEndTimeElement=function(){return this.getElement().find("em.end")},BarDebuggerOutput.prototype.getLineBarsElement=function(){return this.getElement().find("em.line-bars span.bar-num")},BarDebuggerOutput.prototype.select=function(t){void 0==t&&(t=!1);var e=this.getOutputManager(),o=this.getSongBook().getPlayer(),r=this.getSpeedOutput().getSpeedLabel(),n=this.getBarConfig().getStartTime();return e.selectBarOutput(this,r),this.getDebugger().isReview()?this.getSongBook().getSheetReviewer().setCurrentBarOutput(this):this.getDebugger().isEditing()&&this.getDebugger().isSyncStarted()?(this.isEmpty()||(o.seekTo(n),o.getSheetViewer().updateWithBarOutput(this),o.checkSheetDisplayRange(n)),o.pause()):o.seekTo(n),this},BarDebuggerOutput.prototype.getPreviousBarOutput=function(){var t=this.getNumber();"string"==typeof t&&(t*=1);var e=BarDebuggerOutput.BARS_PER_LINE;this.hasCustomLineBars()&&(e=this.getCustomLineBars());this.getSpeedOutput().getOutputManager();var o=t-e,r=this.getPartOutput().getBarOutput(o);if(void 0==r)for(var n=this.getNumber()-1;n>=1&&void 0==(r=this.getPartOutput().getBarOutput(n));)n--;var i=this.getSpeedOutput().getSpeedLabel();return void 0==r?i==SongBookPlayer.PLAY_NORMAL_SPEED_TYPE&&1==t?this:r=this.getPartOutput().getPreviousPartOutput().getLastBarOutput():r},BarDebuggerOutput.prototype.getNextBarOutput=function(){var t=this.getNumber();"string"==typeof t&&(t*=1);var e=BarDebuggerOutput.BARS_PER_LINE;this.hasCustomLineBars()&&(e=this.getCustomLineBars());var o=this.getOutputManager().getLastBarNumber(),r=t+e,n=this.getPartOutput().getBarOutput(r),i=this.getSpeedOutput().getSpeedLabel();if(void 0==n){if(r>o&&i==SongBookPlayer.PLAY_SLOW_SPEED_TYPE)return this;var u=this.getPartOutput().getNextPartOutput();if(void 0==u)return;return n=u.getFirstBarOutput()}return n},BarDebuggerOutput.prototype.setStartTime=function(t){return this.getBarConfig().setStartTime(t),this.getStartTimeElement().text(t),this},BarDebuggerOutput.prototype.setEndTime=function(t){return this.getBarConfig().setEndTime(t),this.getEndTimeElement().text(t),this},BarDebuggerOutput.prototype.getStartTime=function(){return this.getBarConfig().getStartTime()},BarDebuggerOutput.prototype.getEndTime=function(){return this.getBarConfig().getEndTime()},BarDebuggerOutput.prototype.hasCustomLineBars=function(){return this.getBarConfig().hasCustomLineBars()},BarDebuggerOutput.prototype.getCustomLineBars=function(){return this.getBarConfig().getCustomLineBars()},BarDebuggerOutput.prototype.setCustomLineBars=function(t,e){return void 0==e&&(e=!0),this.getBarConfig().setCustomLineBars(t),this.updateLineBars(),e&&(this.getSpeedOutput().reorderBarsAfter(this),this.getMirror().getSpeedOutput().reorderBarsAfter(this.getMirror())),this},BarDebuggerOutput.prototype.updateLineBars=function(){if(this.hasCustomLineBars()){var t=this.getCustomLineBars();t!=BarDebuggerOutput.BARS_PER_LINE?(this.getElement().addClass("custom-bars"),this.getLineBarsElement().text(t)):this.getElement().removeClass("custom-bars")}else this.getElement().removeClass("custom-bars")},BarDebuggerOutput.prototype.getMirror=function(){var t=this.getOutputManager(),e=this.getPartOutput();return this.getSpeedOutput().getSpeedLabel()==SongBookPlayer.PLAY_NORMAL_SPEED_TYPE?t.getSpeedOutput(SongBookPlayer.PLAY_SLOW_SPEED_TYPE).getPartOutput(e.getNumber()).getBarOutput(this.getNumber()):t.getSpeedOutput(SongBookPlayer.PLAY_NORMAL_SPEED_TYPE).getPartOutput(e.getNumber()).getBarOutput(this.getNumber())},BarDebuggerOutput.prototype.delete=function(){this.getOutputManager();var t=this.getSpeedOutput(),e=this.getPartOutput(),o=this.getSongBook().getSelectedMusic().getPart(e.getNumber());e.setFirstCreatedBarNumber(e.getFirstBarOutput().getNumber()),this.getElement().remove(),e.removeBar(this.getNumber()),o.removeBar(this.getNumber(),t.getSpeedLabel()),t.reorderBarsAfter(this)},BarDebuggerOutput.prototype.buildMappings=function(){var t=this;return this.getElement().click(function(){t.select(!0)}),this.updateLineBars(),this},SongBookDebugger.SYNC_REWIND_OFFSET=3,SongBookDebugger.HOTKEYS={space:function(t){var e=t.getSongBook().getPlayer();return function(o){if(e.isPlaying()?e.pause():e.play(),t.isEditing())return t.isSyncStarted()||(t.setSyncStarted(!0),t.getMessenger().showMessage("002",!0)),!1}},backspace:function(t){return function(e){if(t.isDebugging()){var o=t.getSongBook().getPlayer();return t.isEditing()&&t.isSyncStarted()&&!o.isPaused()&&t.syncBack(),!1}}},tab:function(t){return function(e){if(t.isDebugging()){var o=t.getSongBook().getPlayer();return t.isEditing()&&t.isSyncStarted()&&!o.isPaused()&&t.syncFoward(),!1}}},"shift+p":function(t){return function(e){if(t.isDebugging())return t.isEditing()&&t.createSyncPart(),!1}},"shift+b":function(t){return function(e){if(t.isDebugging())return t.isEditing()&&t.createSyncBar(),!1}},"alt+shift+b":function(t){return function(e){if(t.isDebugging())return t.isEditing()&&t.createSyncBar(!1),!1}},"alt+1":function(t){return function(e){if(t.isDebugging())return t.isEditing()&&t.updateBarLines(1),t.isReview()&&t.setReviewCompassNumber(1),!1}},"alt+2":function(t){return function(e){if(t.isDebugging())return t.isEditing()&&t.updateBarLines(2),t.isReview()&&t.setReviewCompassNumber(2),!1}},"alt+3":function(t){return function(e){if(t.isDebugging())return t.isEditing()&&t.updateBarLines(3),t.isReview()&&t.setReviewCompassNumber(3),!1}},"alt+4":function(t){return function(e){if(t.isDebugging())return t.isEditing()&&t.updateBarLines(4),t.isReview()&&t.setReviewCompassNumber(4),!1}},"alt+5":function(t){return function(e){if(t.isDebugging())return t.isEditing()&&t.updateBarLines(5),t.isReview()&&t.setReviewCompassNumber(5),!1}},"alt+6":function(t){return function(e){if(t.isDebugging())return t.isEditing()&&t.updateBarLines(6),t.isReview()&&t.setReviewCompassNumber(6),!1}},"alt+7":function(t){return function(e){if(t.isDebugging())return t.isEditing()&&t.updateBarLines(7),t.isReview()&&t.setReviewCompassNumber(7),!1}},"alt+8":function(t){return function(e){if(t.isDebugging())return t.isEditing()&&t.updateBarLines(8),t.isReview()&&t.setReviewCompassNumber(8),!1}},"alt+9":function(t){return function(e){if(t.isDebugging())return t.isEditing()&&t.updateBarLines(9),t.isReview()&&t.setReviewCompassNumber(9),!1}},del:function(t){return function(e){if(t.isDebugging())return t.isEditing()&&t.deleteSelectedOutput(),!1}},right:function(t){return function(e){if(t.isDebugging())return t.navigateRight(),!1}},left:function(t){return function(e){if(t.isDebugging())return t.navigateLeft(),!1}},up:function(t){return function(e){if(t.isDebugging())return t.navigateUp(),!1}},"ctrl+up":function(t){return function(e){if(t.isDebugging())return t.navigateToTop(),!1}},down:function(t){return function(e){if(t.isDebugging())return t.navigateDown(),!1}},"ctrl+down":function(t){return function(e){if(t.isDebugging())return t.navigateToBottom(),!1}},"ctrl+return":function(t){return function(e){if(t.isDebugging())return t.isEditing()&&t.splitParts(),!1}}},SongBookDebugger.prototype.getSongBook=function(){return this.songbook},SongBookDebugger.prototype.getOutputManager=function(){return this.outputManager},SongBookDebugger.prototype.getMessenger=function(){return this.messenger},SongBookDebugger.prototype.getElement=function(){return null==this.element&&(this.element=this.getSongBook().getElement().find("div.smb7-debugger-container")),this.element},SongBookDebugger.prototype.getSpeedElements=function(){return this.getElement().find("ul.smb7-debugger li.speed-type:not(.initial-tree)")},SongBookDebugger.prototype.getFirstSpeedElement=function(){return this.getElement().find("ul.smb7-debugger li.speed-type:first")},SongBookDebugger.prototype.getLastSpeedElement=function(){return this.getElement().find("ul.smb7-debugger li.speed-type:last")},SongBookDebugger.prototype.getFirstPartElement=function(t){return void 0==t&&(t=this.getElement().find("ul.music-parts:first")),t.find("li.music-part:first")},SongBookDebugger.prototype.getFirstPartElements=function(){return this.getElement().find("ul.music-parts li.music-part:first-child")},SongBookDebugger.prototype.getLastPartElement=function(t){return void 0==t&&(t=this.getElement().find("ul.music-parts:first")),t.find("li.music-part:last")},SongBookDebugger.prototype.getPartLogElements=function(){return this.getElement().find("ul.smb7-music-parts li.part:not(.initial-tree)")},SongBookDebugger.prototype.getFirstPartLogElement=function(){return this.getElement().find("ul.smb7-music-parts li.part:first")},SongBookDebugger.prototype.getLastPartLogElement=function(){return this.getElement().find("ul.smb7-music-parts li.part:last")},SongBookDebugger.prototype.getFirstBarElement=function(t){return void 0==t&&(t=this.getElement().find("ul.music-bars:first")),t.find("li.music-bar:first")},SongBookDebugger.prototype.getFirstBarElements=function(){return this.getElement().find("ul.music-bars li.music-bar:first-child")},SongBookDebugger.prototype.getLastBarElement=function(t){return void 0==t&&(t=this.getElement().find("ul.music-bars:first")),t.find("li.music-bar:last")},SongBookDebugger.prototype.getSheetStartTimeElement=function(){return this.getElement().find("div.sheet-limits em.sheet-start-time")},SongBookDebugger.prototype.getSheetEndTimeElement=function(){return this.getElement().find("div.sheet-limits em.sheet-end-time")},SongBookDebugger.prototype.getEditButtonElement=function(){return this.getElement().find("a.edit-button")},SongBookDebugger.prototype.getReviewButtonElement=function(){return this.getElement().find("a.review-button")},SongBookDebugger.prototype.isModified=function(){return 1==this.modified},SongBookDebugger.prototype.setModified=function(t){return this.modified=t,this},SongBookDebugger.prototype.isEditing=function(){return 1==this.editing},SongBookDebugger.prototype.setEditing=function(t){return this.editing=t,this.isEditing()?(this.getEditButtonElement().addClass("enabled"),this.getOutputManager().startEditing()):(this.getEditButtonElement().removeClass("enabled"),this.setSyncStarted(!1),this.getOutputManager().stopEditing()),this},SongBookDebugger.prototype.toggleEditing=function(){return this.isEditing()?this.setEditing(!1):this.setEditing(!0),this},SongBookDebugger.prototype.isReview=function(){return 1==this.review},SongBookDebugger.prototype.setReview=function(t){return this.review=t,this.isReview()?(this.getReviewButtonElement().addClass("enabled"),this.getSongBook().getPlayer().getElement().addClass("review-mode"),this.getOutputManager().startReview()):(this.getReviewButtonElement().removeClass("enabled"),this.getSongBook().getPlayer().getElement().removeClass("review-mode"),this.getOutputManager().stopReview()),this},SongBookDebugger.prototype.toggleReview=function(){return this.isReview()?this.setReview(!1):this.setReview(!0),this},SongBookDebugger.prototype.isSyncStarted=function(){return 1==this.syncStarted},SongBookDebugger.prototype.setSyncStarted=function(t){return this.syncStarted=t,this},SongBookDebugger.prototype.isDebugging=function(){return this.getSongBook().getConfiguration().isDebugging()},SongBookDebugger.prototype.setSize=function(t){return this.size=t,this.getElement().removeClass(SongBookPlayer.SMALL_PLAYER_SIZE),this.getElement().removeClass(SongBookPlayer.MEDIUM_PLAYER_SIZE),this.getElement().removeClass(SongBookPlayer.FULLHD_PLAYER_SIZE),this.getElement().addClass(t),this},SongBookDebugger.prototype.addDebuggingClasses=function(){this.getSongBook().getPlayer().getElement().addClass("debugging"),this.getElement().addClass("enabled")},SongBookDebugger.prototype.resetOutput=function(){this.getSpeedElements().remove(),this.getPartLogElements().remove(),this.getSheetStartTimeElement().text(""),this.getSheetEndTimeElement().text("")},SongBookDebugger.prototype.createSpeedOutput=function(t){var e=this.getFirstSpeedElement(),o=(this.getLastSpeedElement(),e.clone());return o.attr("value",t),o.find("span.speed-type-label em.speed").text(t),o.removeClass("initial-tree"),this.getOutputManager().addSpeed(t,o),o},SongBookDebugger.prototype.createPartOutput=function(t,e,o,r){var n,i,u=this.getFirstPartElement(o).clone();return r==SongBookPlayer.PLAY_NORMAL_SPEED_TYPE?(n=e.getNormalSeekStartTime(),i=e.getNormalSeekEndTime()):(n=e.getSlowSeekStartTime(),i=e.getSlowSeekEndTime()),u.find("span.part-times em.part-start").text(n),u.find("span.part-times em.part-end").text(i),u.find("span.music-part-label em.value").text(t),u.removeClass("initial-tree"),this.getOutputManager().addPart(r,e,u),u},SongBookDebugger.prototype.createPartLogOutput=function(t,e){var o,r,n,i,u=this.getFirstPartLogElement().clone();return o=e.getNormalSeekStartTime(),r=e.getNormalSeekEndTime(),n=e.getSlowSeekStartTime(),i=e.getSlowSeekEndTime(),u.attr("partNumber",t),u.find("em.number").text(t),u.find("em.ns").text(o),u.find("em.ne").text(r),u.find("em.ss").text(n),u.find("em.se").text(i),u.removeClass("initial-tree"),this.getOutputManager().addPartLog(e,u),u},SongBookDebugger.prototype.createBarOutput=function(t,e,o,r,n){var i=this.getFirstBarElement(n).clone();return i.find("em.number").text(t),i.find("em.start").text(o.getStartTime()),i.find("em.end").text(o.getEndTime()),i.removeClass("initial-tree"),this.getOutputManager().addBar(r,e,o,i),i},SongBookDebugger.prototype.updateOutput=function(){this.resetOutput();this.getSongBook().getConfiguration();var t=this.getSongBook().getSelectedMusic().getNumber(),e=this.getSongBook().getConfiguration().getMusic(t),o=this;return o.getOutputManager().reset(),o.getOutputManager().setSheetStartTime(e.getSheetStartTime()),o.getOutputManager().setSheetEndTime(e.getSheetEndTime()),e.eachSpeed(SongBookSheetViewer.PART_TYPE,function(t){var r=o.getLastSpeedElement(),n=t.label,i=o.createSpeedOutput(n);e.eachPart(function(t,e){var r,u=o.getLastPartElement(i),s=o.getLastPartLogElement(),g=o.createPartOutput(t,e,i,n);n==SongBookPlayer.PLAY_NORMAL_SPEED_TYPE&&(r=o.createPartLogOutput(t,e)),e.eachBar(SongBookSheetViewer.PART_TYPE,n,function(t,r){var i=o.getLastBarElement(g);o.createBarOutput(t,e,r,n,g).insertAfter(i)}),g.insertAfter(u),n==SongBookPlayer.PLAY_NORMAL_SPEED_TYPE&&r.insertAfter(s)}),i.insertAfter(r)}),this.getOutputManager().checkLastOutputs(),this},SongBookDebugger.prototype.selectBarOutput=function(t,e){this.getOutputManager().selectBarOutput(t,e)},SongBookDebugger.prototype.bindHotKeys=function(){var t=SongBookDebugger.HOTKEYS;for(var e in t){var o=t[e];jQuery(document).bind("keydown",e,o.call(this,this))}},SongBookDebugger.prototype.syncBack=function(){var t=this.getSongBook().getPlayer();if(t.isPlaying()){var e=this.getOutputManager(),o=e.getSelectedBarOutput();if(void 0!=o){var r=o.getPreviousBarOutput(),n=r,i=r.getPartOutput().getSpeedOutput().getSpeedLabel();if(e.selectBarOutput(r,i),o==r)return syncTime=0,o.setStartTime(0),o.setEndTime(0),o.setFirstSync(!0),t.seekTo(0),t.hideSheets(),this;syncTime=r.getBarConfig().getStartTime(),t.getSheetViewer().updateWithBarOutput(n),t.seekTo(syncTime)}}return this},SongBookDebugger.prototype.syncFoward=function(){return this.getSongBook().getPlayer().isPlaying()&&void 0!=this.getOutputManager().getSelectedBarOutput()&&this.syncFromExistentOutput(),this},SongBookDebugger.prototype.syncFromExistentOutput=function(){var t=this.getSongBook().getPlayer(),e=this.getOutputManager(),o=e.getSelectedBarOutput(),r=o,n=o.getNextBarOutput(),i=n.getSpeedOutput().getSpeedLabel(),u=t.getCurrentTime();if(e.update(u)&&(e.selectBarOutput(n,i),r=n),this.isEditing())t.getSheetViewer().updateWithBarOutput(r);else{var s=1*parseFloat(u+"").toFixed(6);t.getSheetViewer().update(s),t.checkSheetDisplayRange(s)}return this},SongBookDebugger.prototype.createSyncPart=function(){var t=this.getOutputManager();return void 0!=t.getSelectedSpeedOutput()&&t.createNewPartOutput(),this},SongBookDebugger.prototype.createSyncBar=function(t){var e=this.getOutputManager(),o=e.getSelectedPartOutput();if(void 0!=o){var r=e.createNewBarOutput(o,t);void 0!=r&&r.select()}return this},SongBookDebugger.prototype.updateBarLines=function(t){var e=this.getOutputManager().getSelectedBarOutput();return void 0!=e&&(e.setCustomLineBars(t),e.getMirror().setCustomLineBars(t)),this},SongBookDebugger.prototype.setReviewCompassNumber=function(t){var e=this.getOutputManager(),o=this.getSongBook().getSheetReviewer();return void 0!=e.getSelectedBarOutput()&&o.setCompassNumber(t),this},SongBookDebugger.prototype.deleteSelectedOutput=function(){var t=this.getOutputManager(),e=t.getSelectedBarOutput(),o=t.getSelectedPartOutput();return void 0!=e?(e.delete(),e.getMirror().delete(!0)):void 0!=o&&(o.delete(),o.getMirror().delete(!0)),this},SongBookDebugger.prototype.navigateLeft=function(){var t=this.getOutputManager(),e=t.getSelectedBarOutput(),o=t.getSelectedPartOutput();if(void 0!=e){var r=e.getPartOutput();void 0!=r&&r.select()}else if(void 0!=o){var n=o.getSpeedOutput();void 0!=n&&n.select()}return this},SongBookDebugger.prototype.navigateRight=function(){var t=this.getOutputManager(),e=t.getSelectedPartOutput(),o=t.getSelectedSpeedOutput();if(void 0!=e){var r=e.getFirstBarOutput();void 0!=r&&(r.isSelected()||r.select())}else if(void 0!=o){var n=o.getFirstPartOutput();void 0!=n&&(n.isSelected()||n.select())}return this},SongBookDebugger.prototype.navigateUp=function(){var t=this.getOutputManager(),e=t.getSelectedBarOutput(),o=t.getSelectedPartOutput(),r=t.getSelectedSpeedOutput();if(void 0!=e){var n=e.getPreviousBarOutput();void 0!=n&&n.select()}else if(void 0!=o){var i=o.getPreviousPartOutput(!0);void 0!=i&&i.select()}else if(void 0!=r){var u=r.getPreviousSpeedOutput();void 0!=u&&u.select()}return this},SongBookDebugger.prototype.navigateDown=function(){var t=this.getOutputManager(),e=t.getSelectedBarOutput(),o=t.getSelectedPartOutput(),r=t.getSelectedSpeedOutput();if(void 0!=e){var n=e.getNextBarOutput();void 0!=n&&n.select()}else if(void 0!=o){var i=o.getNextPartOutput(!0);void 0!=i&&i.select()}else if(void 0!=r){var u=r.getNextSpeedOutput();void 0!=u&&u.select()}return this},SongBookDebugger.prototype.navigateToTop=function(){var t=this.getOutputManager(),e=t.getSelectedBarOutput(),o=t.getSelectedPartOutput();if(void 0!=e){var r=e.getPartOutput().getFirstBarOutput();void 0!=r&&r.select()}else if(void 0!=o){var n=o.getSpeedOutput().getFirstPartOutput();void 0!=n&&n.select()}return this},SongBookDebugger.prototype.navigateToBottom=function(){var t=this.getOutputManager(),e=t.getSelectedBarOutput(),o=t.getSelectedPartOutput();if(void 0!=e){var r=e.getPartOutput().getLastBarOutput();void 0!=r&&r.select()}else if(void 0!=o){var n=o.getSpeedOutput().getLastPartOutput();void 0!=n&&n.select()}return this},SongBookDebugger.prototype.splitParts=function(){var t=this.getOutputManager(),e=t.getSelectedBarOutput();return void 0!=e&&t.splitParts(e),this},SongBookDebugger.prototype.scrollTo=function(t){this.getElement().clearQueue().stop(),this.getElement().scrollTo(t.getElement(),450,{offset:-280})},SongBookDebugger.prototype.buildMappings=function(){var t=this;return this.isDebugging()&&(this.addDebuggingClasses(),this.getEditButtonElement().click(function(){return t.toggleEditing(),!1}),this.getReviewButtonElement().click(function(){return t.toggleReview(),!1}),this.bindHotKeys()),this},DebuggerMessenger.MESSAGES={"001":"<div class='message-type'>MODO SYNC</div>PRESSIONE A TECLA <span class='command'><em>Espaço</em></span><br/>PARA CONTINUAR / PAUSAR","002":"<div class='message-type'>MODO SYNC</div>PRESSIONE <span class='command'><em>TAB</em></span> PARA SINCRONIZAR OU <span class='command'><em>BACKSPACE</em></span> PARA VOLTAR"},DebuggerMessenger.prototype.getDebugger=function(){return this.debug},DebuggerMessenger.prototype.getElement=function(){return null==this.element&&(this.element=this.getDebugger().getSongBook().getElement().find("div.smb7-debugger-messages")),this.element},DebuggerMessenger.prototype.getDialogElement=function(){return this.getElement().find("div.modal-dialog")},DebuggerMessenger.prototype.show=function(){return this.getElement().fadeIn(300),this},DebuggerMessenger.prototype.hide=function(){return this.getElement().fadeOut(300),this},DebuggerMessenger.prototype.showMessage=function(t,e){var o=this;isNaN(t)||(t=DebuggerMessenger.MESSAGES[t]),this.getDialogElement().html(t),this.show(300),1!=e&&window.setTimeout(function(){o.hide(300)},5e3)},DebuggerOutputManager.prototype.setChangeSheetTimes=function(t){return this.changeSheetTimes=t,this},DebuggerOutputManager.prototype.isChangeSheetTimes=function(){return 1==this.changeSheetTimes},DebuggerOutputManager.prototype.setLastCreatedBarNumber=function(t){return this.lastCreatedBarNumber=t,this},DebuggerOutputManager.prototype.getLastCreatedBarNumber=function(){return this.lastCreatedBarNumber},DebuggerOutputManager.prototype.setFirstSync=function(t){return this.firstSync=t,this},DebuggerOutputManager.prototype.isFirstSync=function(){return 1==this.firstSync},DebuggerOutputManager.prototype.setLastSync=function(t){return this.lastSync=t,this},DebuggerOutputManager.prototype.isLastSync=function(){return 1==this.lastSync},DebuggerOutputManager.prototype.getDebugger=function(){return this.debug},DebuggerOutputManager.prototype.getSongBook=function(){return this.getDebugger().getSongBook()},DebuggerOutputManager.prototype.getOutputMap=function(){return this.outputMap},DebuggerOutputManager.prototype.getPartLogMap=function(){return this.partLogMap},DebuggerOutputManager.prototype.reset=function(){return this.outputMap=new Map,this},DebuggerOutputManager.prototype.addSpeed=function(t,e){return this.getOutputMap().put(t,new SpeedDebuggerOutput(this,t,e)),this},DebuggerOutputManager.prototype.addPart=function(t,e,o){var r=this.getOutputMap().get(t);if(void 0!=r)return r.addPart(e,o),this},DebuggerOutputManager.prototype.addPartLog=function(t,e){return this.getPartLogMap().put(t.getNumber(),new PartLogDebuggerOutput(this,t,e)),this},DebuggerOutputManager.prototype.addBar=function(t,e,o,r){var n=e.getNumber(),i=this.getOutputMap().get(t).getPartOutput(n);if(void 0!=i)return i.addBar(o,r),this},DebuggerOutputManager.prototype.getSpeedOutput=function(t){return this.getOutputMap().get(t)},DebuggerOutputManager.prototype.eachSpeedOutput=function(t){this.getOutputMap().each(function(e,o){return t.call(this,e,o)})},DebuggerOutputManager.prototype.getPartLogOutput=function(t){return this.getPartLogMap().get(t)},DebuggerOutputManager.prototype.deselectAll=function(){return this.eachSpeedOutput(function(t,e){e.deselect(),e.deselectAllParts(),e.eachPartOutput(function(t,e){e.deselectAllBars()})}),this},DebuggerOutputManager.prototype.getSelectedBarOutput=function(){var t;return this.eachSpeedOutput(function(e,o){o.eachPartOutput(function(e,o){o.eachBarOutput(function(e,o){if(o.isSelected())return t=o,!1})})}),t},DebuggerOutputManager.prototype.getSelectedPartOutput=function(){var t;return this.eachSpeedOutput(function(e,o){o.eachPartOutput(function(e,o){if(o.isSelected())return t=o,!1})}),t},DebuggerOutputManager.prototype.getSelectedSpeedOutput=function(){var t;return this.eachSpeedOutput(function(e,o){if(o.isSelected())return t=o,!1}),t},DebuggerOutputManager.prototype.getLastBarNumber=function(){var t=0;return this.eachSpeedOutput(function(e,o){o.eachPartOutput(function(e,o){o.eachBarOutput(function(e,o){t=e})})}),t},DebuggerOutputManager.prototype.selectBarByNumber=function(t,e){if(0==t)return this;var o=this.getSongBook().getSelectedMusic().getSelectedPart().getNumber(),r=this.getSpeedOutput(e),n=r.getPartOutput(o),i=n.getBarOutput(t);return this.deselectAll(),r.setSelected(!0),n.setSelected(!0),i.setSelected(!0),this.getDebugger().scrollTo(i),this},DebuggerOutputManager.prototype.selectBarByOutput=function(t,e){var o=this.getSongBook().getSelectedMusic(),r=(o.getNumber(),t.getBarConfig().getNumber(),t.getPartOutput().getNumber()),n=this.getSpeedOutput(e);if(void 0==n)return this;var i=n.getPartOutput(r);if(void 0==i)return this;var u=o.getPart(i.getNumber()),s=i.getSpeedOutput().getSpeedLabel();this.deselectAll(),n.setSelected(!0),i.setSelected(!0),this.getDebugger().isEditing()&&void 0!=u&&(songbook.getPlayer().setPlaySpeedType(s),u.select()),t.setSelected(!0),this.getDebugger().scrollTo(t)},DebuggerOutputManager.prototype.selectBarOutput=function(t,e){return isNaN(t)?this.selectBarByOutput(t,e):this.selectBarByNumber(t,e),this},DebuggerOutputManager.prototype.eachBarOutput=function(t){return"function"!=typeof t?this:(this.eachSpeedOutput(function(e,o){o.eachPartOutput(function(e,o){o.eachBarOutput(function(e,o){return t.call(this,e,o)})})}),this)},DebuggerOutputManager.prototype.checkLastOutputs=function(){return this.eachSpeedOutput(function(t,e){e.eachPartOutput(function(t,e){e.isLast()&&e.getElement().addClass("last"),e.eachBarOutput(function(t,e){e.isLast()&&e.getElement().addClass("last")})})}),this},DebuggerOutputManager.prototype.selectFirstSpeedOutput=function(){var t=this.getOutputMap().contents,e=null;for(var o in t)return(e=t[o]).select(),e;if(null==e){var r=this.createNewSpeedOutput(SongBookPlayer.PLAY_NORMAL_SPEED_TYPE);this.createNewSpeedOutput(SongBookPlayer.PLAY_SLOW_SPEED_TYPE);return r}},DebuggerOutputManager.prototype.selectFirstBarOutput=function(){var t,e,o=this.getSpeedOutput(SongBookPlayer.PLAY_NORMAL_SPEED_TYPE);return void 0!=o&&(t=o.getFirstPartOutput()),void 0!=t&&(e=t.getFirstBarOutput()),void 0!=e&&e.select(),e},DebuggerOutputManager.prototype.getSyncTimes=function(t){var e=[],o=parseFloat(t+"").toFixed(6);if("NaN"==o)return[0,0];var r=o.split("."),n=1*r[0],i=r[1],u=1*r[1],s=o,g=0;return void 0!=u?u--:n--,g=0==i.indexOf("0")?n+".0"+u:n+"."+u,e[0]=(1*g).toFixed(6),e[1]=(1*s).toFixed(6),e},DebuggerOutputManager.prototype.updatePartTimes=function(t){var e=this.getSelectedBarOutput(),o=e.getPartOutput().getSpeedOutput().getSpeedLabel(),r=this.getSongBook().getSelectedMusic(),n=e.getStartTime(),i=t[0];o==SongBookPlayer.PLAY_NORMAL_SPEED_TYPE?e.isFirst()&&this.isChangeSheetTimes()?(e.getPartOutput().setNormalStartTime(n),e.getPartLogOutput().setNormalStartTime(n),this.isFirstSync()&&this.setSheetStartTime(n)):e.isLast()&&(e.getPartOutput().setNormalEndTime(i),e.getPartLogOutput().setNormalEndTime(i)):e.isFirst()?(e.getPartOutput().setSlowStartTime(n),e.getPartLogOutput().setSlowStartTime(n)):e.isLast()&&(e.getPartOutput().setSlowEndTime(i),e.getPartLogOutput().setSlowEndTime(i),this.isLastSync()&&(r.getConfig().setSheetEndTime(i),this.setSheetEndTime(i)))},DebuggerOutputManager.prototype.update=function(t){var e=this.getSelectedBarOutput(),o=e.getPartOutput().getSpeedOutput().getSpeedLabel(),r=e.getNextBarOutput(),n=this.getSongBook().getSelectedMusic(),i=this.getSyncTimes(t),u=i[0],s=i[1],g=!0;return e.isFirst()&&o==SongBookPlayer.PLAY_NORMAL_SPEED_TYPE?e.isFirstSync()?(e.setStartTime(s),n.setSheetStartTime(s),e.setFirstSync(!1),this.setChangeSheetTimes(!0),g=!1):(e.setEndTime(u),r.setStartTime(s),e.setFirstSync(!1),r.setFirstSync(!1),this.setChangeSheetTimes(!0),g=!0):e.isLastOfSheet()&&o==SongBookPlayer.PLAY_SLOW_SPEED_TYPE?e.isFirstSync()?(e.setStartTime(s),e.setFirstSync(!1),this.setChangeSheetTimes(!1),g=!1):(e.setEndTime(u),e.setFirstSync(!1),this.setLastSync(!0),this.setChangeSheetTimes(!1),g=!0):(e.setEndTime(i[0]),r.setStartTime(i[1]),r.setFirstSync(!1),this.setChangeSheetTimes(!1),g=!0),this.updatePartTimes(i),this.setFirstSync(!1),g},DebuggerOutputManager.prototype.resetAllBarsSync=function(){this.eachBarOutput(function(t,e){e.setFirstSync(!0)})},DebuggerOutputManager.prototype.setSheetStartTime=function(t){this.getSongBook().getConfiguration();var e=this.getSongBook().getSelectedMusic().getNumber(),o=this.getSongBook().getConfiguration().getMusic(e);return this.getDebugger().getSheetStartTimeElement().text(t),o.setSheetStartTime(t),this},DebuggerOutputManager.prototype.setSheetEndTime=function(t){this.getSongBook().getConfiguration();var e=this.getSongBook().getSelectedMusic().getNumber(),o=this.getSongBook().getConfiguration().getMusic(e);return this.getDebugger().getSheetEndTimeElement().text(t),o.setSheetEndTime(t),this},DebuggerOutputManager.prototype.getNewPartNumber=function(t){var e=0;return this.getSpeedOutput(t).eachPartOutput(function(t,o){"string"==typeof t&&(t*=1),e=t}),e+1},DebuggerOutputManager.prototype.createNewSpeedOutput=function(t){var e=this.getDebugger().createSpeedOutput(t),o=this.getDebugger().getLastSpeedElement(),r=this.getSongBook().getSelectedMusic().getConfig();e.insertAfter(o);var n=SongBookMusicConfig.SYNC_PREFIX+"."+SongBookSheetViewer.PART_TYPE+"."+t;return r.put(n,{}),this.getSpeedOutput(t)},DebuggerOutputManager.prototype.createNewPartOutput=function(){var t,e=this;if(this.eachSpeedOutput(function(o,r){var n=e.getDebugger(),o=r.getSpeedLabel(),i=e.getNewPartNumber(o),u=e.getSongBook().getSelectedMusic(),s=new SongBookMusicPartConfig(u.getConfig(),i),g=n.createPartOutput(i,s,r.getElement(),o),a=n.getLastPartElement(r.getElement()),p=n.getLastPartLogElement();g.insertAfter(a),o==SongBookPlayer.PLAY_NORMAL_SPEED_TYPE&&n.createPartLogOutput(i,s).insertAfter(p),u.createPart(s,o),t=i}),void 0!=t)return this.getSpeedOutput(SongBookPlayer.PLAY_NORMAL_SPEED_TYPE).getPartOutput(t)},DebuggerOutputManager.prototype.getNextBarNumber=function(t,e){var o;void 0==e&&(e=!0);var r=(o=t.isFirst()||t.getBarsSize()>1?t:t.getPreviousPartOutput(!0)).getLastBarOutput();if(void 0==r&&t.getSpeedOutput().getPartsSize()>2){for(var n=t.getNumber()-1;n>1;){var i=t.getSpeedOutput().getPartOutput(n);if(void 0!=i.getLastBarOutput()){r=i.getLastBarOutput();break}i.delete(),n--}r=t.getSpeedOutput().getPartOutput(n).getLastBarOutput()}return void 0==r?1:e&&t.isEmpty()?r.getNumber():r.hasCustomLineBars()?r.getNumber()+r.getCustomLineBars():r.getNumber()+BarDebuggerOutput.BARS_PER_LINE},DebuggerOutputManager.prototype.placeNewBarElement=function(t,e){var o=this.getSongBook().getSelectedMusic(),r=o.getPart(t.getNumber()).getPartConfig(),n=t.getSpeedOutput().getSpeedLabel(),i=t.getPartConfig(),u=new SongBookMusicBarConfig(i,n,e),s=this.getDebugger().getLastBarElement(t.getElement());this.getDebugger().createBarOutput(e,i,u,n,t.getElement()).insertAfter(s);var g=SongBookMusicConfig.SYNC_PREFIX+"."+SongBookSheetViewer.PART_TYPE+"."+n+"."+t.getNumber()+"."+e;return i.put(g,{}),r.addBar(e,u,n),o.getConfig().setSyncLastBar(e),t.getBarOutput(e)},DebuggerOutputManager.prototype.createNewBarOutput=function(t,e){var o=this.getNextBarNumber(t,e);t.isEmpty()&&t.setFirstCreatedBarNumber(o);var r=this.placeNewBarElement(t,o);return this.placeNewBarElement(t.getMirror(),o),r},DebuggerOutputManager.prototype.removePartLog=function(t){var e=this.getPartLogMap().get(t);return void 0!=e&&(e.getElement().remove(),this.getPartLogMap().remove(t)),this},DebuggerOutputManager.prototype.reorderPartLogs=function(){var t=1;return this.getPartLogMap().sort(t,function(e,o){return o.setNumber(t),t+=1}),this},DebuggerOutputManager.prototype.splitParts=function(t){var e=this,o=t.getPartOutput(),r=o.getNextPartOutput(!0),n=new Map;r==o&&(r=this.createNewPartOutput()),o.eachBarOutput(function(e,o){e>=t.getNumber()&&(n.put(e,{firstSync:o.isFirstSync(),startTime:o.getStartTime(),endTime:o.getEndTime(),customLineBars:o.getCustomLineBars()}),e>t.getNumber()&&(o.getMirror().delete(),o.delete()))});var i;return n.each(function(t,o){void 0==i&&(i=1*t);var n=e.createNewBarOutput(r,!0);n.setFirstSync(o.firstSync),n.setStartTime(o.startTime),n.setEndTime(o.endTime),n.setCustomLineBars(o.customLineBars,!1),n.getMirror().setFirstSync(o.firstSync),n.getMirror().setStartTime(o.startTime),n.getMirror().setEndTime(o.endTime),n.getMirror().setCustomLineBars(o.customLineBars,!1)}),r.select(),void 0==i&&(i=1),r.setFirstCreatedBarNumber(i),r.getMirror().setFirstCreatedBarNumber(i),this},DebuggerOutputManager.prototype.startEditing=function(){var t=this.getSongBook().getPlayer();this.setFirstSync(!0);var e,o;void 0!=(e=this.selectFirstSpeedOutput())&&(o=e.selectFirstPartOutput()),void 0!=o&&(barPartOutput=o.selectFirstBarOutput()),this.getDebugger().isReview()||(this.getDebugger().getMessenger().showMessage("001",!0),t.hideSheets(),t.seekTo(0),t.pause())},DebuggerOutputManager.prototype.stopEditing=function(){if(!this.getDebugger().isReview()){var t=this.getSongBook(),e=t.getPlayer(),o=t.getSelectedMusic();this.setFirstSync(!1),this.resetAllBarsSync(),e.hideSheets(),this.getDebugger().isReview()||(e.setPlaySpeedType(SongBookPlayer.PLAY_NORMAL_SPEED_TYPE),this.getDebugger().getMessenger().hide(),o.selectFirstPart(),e.seekTo(0),e.play())}},DebuggerOutputManager.prototype.startReview=function(){return this.getSongBook().getPlayer().stop().disable(),this.getSongBook().getSheetReviewer().reset(),this.getDebugger().getMessenger().hide(),this},DebuggerOutputManager.prototype.stopReview=function(){return this.getSongBook().getPlayer().enable(),this.getDebugger().isEditing()&&this.startEditing(),this},PartLogDebuggerOutput.prototype=Object.create(SelectableElement.prototype),PartLogDebuggerOutput.prototype.constructor=PartLogDebuggerOutput,PartLogDebuggerOutput.prototype.getOutputManager=function(){return this.outputManager},PartLogDebuggerOutput.prototype.getPartConfig=function(){return this.partConfig},PartLogDebuggerOutput.prototype.getNumber=function(){return this.getPartConfig().getNumber()},PartLogDebuggerOutput.prototype.setNumber=function(t){return this.getPartConfig().setNumber(t),this.getLabelElement().text(t),this},PartLogDebuggerOutput.prototype.getElement=function(){return this.element},PartLogDebuggerOutput.prototype.getLabelElement=function(){return this.getElement().find("em.number")},PartLogDebuggerOutput.prototype.getNormalTimeStartElement=function(){return this.getElement().find("em.ns")},PartLogDebuggerOutput.prototype.getNormalTimeEndElement=function(){return this.getElement().find("em.ne")},PartLogDebuggerOutput.prototype.getSlowTimeStartElement=function(){return this.getElement().find("em.ss")},PartLogDebuggerOutput.prototype.getSlowTimeEndElement=function(){return this.getElement().find("em.se")},PartLogDebuggerOutput.prototype.setNormalStartTime=function(t){return this.getNormalTimeStartElement().text(t),this},PartLogDebuggerOutput.prototype.setNormalEndTime=function(t){return this.getNormalTimeEndElement().text(t),this},PartLogDebuggerOutput.prototype.setSlowStartTime=function(t){return this.getSlowTimeStartElement().text(t),this},PartLogDebuggerOutput.prototype.setSlowEndTime=function(t){return this.getSlowTimeEndElement().text(t),this},PartLogDebuggerOutput.prototype.buildMappings=function(){var t=this;return this.getElement().click(function(){t.select()}),this},PartDebuggerOutput.prototype=Object.create(SelectableElement.prototype),PartDebuggerOutput.prototype.constructor=PartDebuggerOutput,PartDebuggerOutput.prototype.getSongBook=function(){return this.getDebugger().getSongBook()},PartDebuggerOutput.prototype.getDebugger=function(){return this.getOutputManager().getDebugger()},PartDebuggerOutput.prototype.getOutputManager=function(){return this.getSpeedOutput().getOutputManager()},PartDebuggerOutput.prototype.getSpeedOutput=function(){return this.speedOutput},PartDebuggerOutput.prototype.getPartConfig=function(){return this.partConfig},PartDebuggerOutput.prototype.getCurrentSpeedLabel=function(){return this.currentSpeedLabel},PartDebuggerOutput.prototype.getNumber=function(){return this.getPartConfig().getNumber()},PartDebuggerOutput.prototype.getNumber=function(){return this.getPartConfig().getNumber()},PartDebuggerOutput.prototype.setNumber=function(t){return this.getPartConfig().setNumber(t),this.getNumberLabelElement().text(t),this},PartDebuggerOutput.prototype.setFirstCreatedBarNumber=function(t){return this.firstCreatedBarNumber=t,this},PartDebuggerOutput.prototype.getFirstCreatedBarNumber=function(){return this.firstCreatedBarNumber},PartDebuggerOutput.prototype.getElement=function(){return this.element},PartDebuggerOutput.prototype.getLabelElement=function(){return this.getElement().find(">span.label")},PartDebuggerOutput.prototype.getNumberLabelElement=function(){return this.getLabelElement().find("em.number")},PartDebuggerOutput.prototype.getTimeStartElement=function(){return this.getElement().find(">span.part-times em.part-start")},PartDebuggerOutput.prototype.getTimeEndElement=function(){return this.getElement().find(">span.part-times em.part-end")},PartDebuggerOutput.prototype.setNormalStartTime=function(t){return this.getPartConfig().setNormalSeekStartTime(t),this.getTimeStartElement().text(t),this},PartDebuggerOutput.prototype.setNormalEndTime=function(t){return this.getPartConfig().setNormalSeekEndTime(t),this.getTimeEndElement().text(t),this},PartDebuggerOutput.prototype.setSlowStartTime=function(t){return this.getPartConfig().setSlowSeekStartTime(t),this.getTimeStartElement().text(t),this},PartDebuggerOutput.prototype.setSlowEndTime=function(t){return this.getPartConfig().setSlowSeekEndTime(t),this.getTimeEndElement().text(t),this},PartDebuggerOutput.prototype.getBarsMap=function(){return this.barsMap},PartDebuggerOutput.prototype.isFirstBar=function(t){return this.getBarsMap().isFirstValue(t)},PartDebuggerOutput.prototype.isLastBar=function(t){return this.getBarsMap().isLastValue(t)},PartDebuggerOutput.prototype.isFirst=function(){return this.getSpeedOutput().isFirstPart(this)},PartDebuggerOutput.prototype.isLast=function(){return this.getSpeedOutput().isLastPart(this)},PartDebuggerOutput.prototype.deselectAllBars=function(){return this.getBarsMap().each(function(t,e){e.setSelected(!1)}),this},PartDebuggerOutput.prototype.getBarOutput=function(t){return this.getBarsMap().get(t)},PartDebuggerOutput.prototype.addBar=function(t,e){return this.getBarsMap().put(t.getNumber(),new BarDebuggerOutput(this,t,e)),this},PartDebuggerOutput.prototype.select=function(){var t=this.getOutputManager(),e=(this.getSpeedOutput(),this.getSongBook()),o=e.getSelectedMusic();if(void 0!=o){t.deselectAll(),this.setSelected(!0);var r=this.getPartConfig().getNumber(),n=o.getPart(r);if(void 0!=n){var i=this.getSpeedOutput().getSpeedLabel();t.getSpeedOutput(i).setSelected(!0),e.getPlayer().setPlaySpeedType(i),n.select()}this.getDebugger().scrollTo(this)}return this},PartDebuggerOutput.prototype.eachBarOutput=function(t){this.getBarsMap().each(function(e,o){return t.call(this,e,o)})},PartDebuggerOutput.prototype.selectFirstBarOutput=function(){var t=this.getBarsMap().contents;for(var e in t){var o=t[e];return o.select(),o}},PartDebuggerOutput.prototype.getFirstBarOutput=function(){var t=this.getBarsMap().contents;for(var e in t)return t[e]},PartDebuggerOutput.prototype.getLastBarOutput=function(){var t,e=this.getBarsMap().contents;for(var o in e)t=e[o];return t},PartDebuggerOutput.prototype.getPreviousPartOutput=function(t){var e=this.getNumber();"string"==typeof e&&(e*=1);var o=e-1,r=this.getOutputManager(),n=this.getSpeedOutput().getPartOutput(o),i=this.getSpeedOutput().getSpeedLabel();if(1==t){if(o<1)return this;n=r.getSpeedOutput(i).getPartOutput(o)}else{if(o<1&&i==SongBookPlayer.PLAY_NORMAL_SPEED_TYPE)return this;n=i==SongBookPlayer.PLAY_NORMAL_SPEED_TYPE?r.getSpeedOutput(SongBookPlayer.PLAY_SLOW_SPEED_TYPE).getPartOutput(o):r.getSpeedOutput(SongBookPlayer.PLAY_NORMAL_SPEED_TYPE).getPartOutput(e)}return n},PartDebuggerOutput.prototype.getNextPartOutput=function(t){var e=this.getSpeedOutput().getPartsSize(),o=this.getNumber();"string"==typeof o&&(o*=1);var r=o+1,n=this.getOutputManager(),i=this.getSpeedOutput().getPartOutput(r),u=this.getSpeedOutput().getSpeedLabel();if(r>e&&"slow"==u)return this;if(1==t){if(void 0==(i=n.getSpeedOutput(u).getPartOutput(r)))return this}else i=u==SongBookPlayer.PLAY_NORMAL_SPEED_TYPE?n.getSpeedOutput(SongBookPlayer.PLAY_SLOW_SPEED_TYPE).getPartOutput(o):n.getSpeedOutput(SongBookPlayer.PLAY_NORMAL_SPEED_TYPE).getPartOutput(r);return i},PartDebuggerOutput.prototype.getBarsSize=function(){return this.getBarsMap().size()},PartDebuggerOutput.prototype.getMirror=function(){var t=this.getOutputManager();return this.getSpeedOutput().getSpeedLabel()==SongBookPlayer.PLAY_NORMAL_SPEED_TYPE?t.getSpeedOutput(SongBookPlayer.PLAY_SLOW_SPEED_TYPE).getPartOutput(this.getNumber()):t.getSpeedOutput(SongBookPlayer.PLAY_NORMAL_SPEED_TYPE).getPartOutput(this.getNumber())},PartDebuggerOutput.prototype.delete=function(t){var e=this.getOutputManager(),o=(e.getPartLogOutput(this.getNumber()),this.getSpeedOutput()),r=this.getSongBook().getSelectedMusic(),n=this.getPreviousPartOutput(!0),i=n.getLastBarOutput();this.getElement().remove(),t||e.removePartLog(this.getNumber()),t||r.removePart(this.getNumber()),o.removePart(this.getNumber()),r.reorderParts(),o.reorderParts(),e.reorderPartLogs(),n==this&&(i=void 0),o.reorderBarsAfter(i)},PartDebuggerOutput.prototype.removeBar=function(t){return this.getBarsMap().remove(t)},PartDebuggerOutput.prototype.reorderBars=function(t){var e=this.getBarsMap(),o=this.getFirstCreatedBarNumber();return void 0!=t&&(o=t),e.sort(o,function(t,e){return e.setNumber(o),e.isLast()||(e.hasCustomLineBars()?o+=e.getCustomLineBars():o+=BarDebuggerOutput.BARS_PER_LINE),o}),this.getOutputManager().setLastCreatedBarNumber(o),o},PartDebuggerOutput.prototype.isEmpty=function(){return void 0==this.getFirstBarOutput()},PartDebuggerOutput.prototype.buildMappings=function(){var t=this;return this.getLabelElement().click(function(){t.select()}),this},SpeedDebuggerOutput.prototype=Object.create(SelectableElement.prototype),SpeedDebuggerOutput.prototype.constructor=SpeedDebuggerOutput,SpeedDebuggerOutput.prototype.getSongBook=function(){return this.getOutputManager().getSongBook()},SpeedDebuggerOutput.prototype.getDebugger=function(){return this.getOutputManager().getDebugger()},SpeedDebuggerOutput.prototype.getOutputManager=function(){return this.outputManager},SpeedDebuggerOutput.prototype.getSpeedLabel=function(){return this.speedLabel},SpeedDebuggerOutput.prototype.getElement=function(){return this.element},SpeedDebuggerOutput.prototype.getLabelElement=function(){return this.getElement().find(">span.label")},SpeedDebuggerOutput.prototype.getPartsMap=function(){return this.partsMap},SpeedDebuggerOutput.prototype.getPartOutput=function(t){return this.getPartsMap().get(t)},SpeedDebuggerOutput.prototype.isFirstPart=function(t){return this.getPartsMap().isFirstValue(t)},SpeedDebuggerOutput.prototype.isLastPart=function(t){return this.getPartsMap().isLastValue(t)},SpeedDebuggerOutput.prototype.addPart=function(t,e){return this.getPartsMap().put(t.getNumber(),new PartDebuggerOutput(this,t,e)),this},SpeedDebuggerOutput.prototype.deselectAllParts=function(){return this.getPartsMap().each(function(t,e){e.setSelected(!1)}),this},SpeedDebuggerOutput.prototype.select=function(){var t=this.getSongBook().getPlayer().getButton(SongBookPlayerButton.NORMAL_VIDEO_BUTTON),e=this.getSongBook().getPlayer().getButton(SongBookPlayerButton.SLOW_VIDEO_BUTTON);return this.getOutputManager().deselectAll(),this.setSelected(!0),this.getSpeedLabel()==SongBookPlayer.PLAY_NORMAL_SPEED_TYPE?(e.deselect(),t.select()):this.getSpeedLabel()==SongBookPlayer.PLAY_SLOW_SPEED_TYPE&&(e.select(),t.deselect()),this.getDebugger().scrollTo(this),this},SpeedDebuggerOutput.prototype.selectFirstPartOutput=function(){var t=null,e=this.getPartsMap().contents;for(var o in e)return(t=e[o]).select(),t;if(null==t)return(t=this.getOutputManager().createNewPartOutput(this)).select(),t},SpeedDebuggerOutput.prototype.getFirstPartOutput=function(){var t=this.getPartsMap().contents;for(var e in t)return t[e]},SpeedDebuggerOutput.prototype.getPreviousSpeedOutput=function(){var t=this.getSpeedLabel(),e=this.getOutputManager();return t==SongBookPlayer.PLAY_NORMAL_SPEED_TYPE?this:e.getSpeedOutput(SongBookPlayer.PLAY_NORMAL_SPEED_TYPE)},SpeedDebuggerOutput.prototype.getNextSpeedOutput=function(){var t=this.getSpeedLabel(),e=this.getOutputManager();return t==SongBookPlayer.PLAY_SLOW_SPEED_TYPE?this:e.getSpeedOutput(SongBookPlayer.PLAY_SLOW_SPEED_TYPE)},SpeedDebuggerOutput.prototype.getLastPartOutput=function(){var t,e=this.getPartsMap().contents;for(var o in e)t=e[o];return t},SpeedDebuggerOutput.prototype.eachPartOutput=function(t){this.getPartsMap().each(function(e,o){return t.call(this,e,o)})},SpeedDebuggerOutput.prototype.getPartsSize=function(){return this.getPartsMap().size()},SpeedDebuggerOutput.prototype.removePart=function(t){return this.getPartsMap().remove(t)},SpeedDebuggerOutput.prototype.reorderParts=function(){var t=1;return this.getPartsMap().sort(t,function(e,o){return o.setNumber(t),t+=1}),this},SpeedDebuggerOutput.prototype.reorderBarsAfter=function(t){if(void 0==t){var e=this.getFirstPartOutput();if(void 0==e)return this;if(void 0==(t=e.getFirstBarOutput()))return this}var o=t.getPartOutput(),r=this.getSongBook().getSelectedMusic(),n=r.getPart(o.getNumber()),i=o.reorderBars();return n.reorderBars(),this.eachPartOutput(function(t,e){if(e.getNumber()>o.getNumber()){var n=r.getPart(e.getNumber());i=e.reorderBars(i),n.reorderBars(i)}}),this},SpeedDebuggerOutput.prototype.buildMappings=function(){var t=this;return this.getLabelElement().click(function(){t.select()}),this},SongBook.WINDOW_RESIZE_HANDLER=function(t){return function(){var e=window.innerHeight;e<=793?(t.getPlayer().setPlayerSize(SongBookPlayer.SMALL_PLAYER_SIZE),t.getDebugger().setSize(SongBookPlayer.SMALL_PLAYER_SIZE)):e>=794&&e<=917?(t.getPlayer().setPlayerSize(SongBookPlayer.MEDIUM_PLAYER_SIZE),t.getDebugger().setSize(SongBookPlayer.MEDIUM_PLAYER_SIZE)):(t.getPlayer().setPlayerSize(SongBookPlayer.FULLHD_PLAYER_SIZE),t.getDebugger().setSize(SongBookPlayer.FULLHD_PLAYER_SIZE))}},SongBook.prototype.getConfiguration=function(){return this.configuration},SongBook.prototype.getDebugger=function(){return this.debugger},SongBook.prototype.getSheetReviewer=function(){return this.sheetReviewer},SongBook.prototype.getName=function(){return this.name},SongBook.prototype.getPlayer=function(){return this.songBookPlayer},SongBook.prototype.getMusicList=function(){return this.musicList},SongBook.prototype.getMusicPanel=function(){return this.musicPanel},SongBook.prototype.getElement=function(){return null==this.element&&(this.element=jQuery("div.smb7-songbook[name='"+this.getName()+"']")),this.element},SongBook.prototype.getBookLogoElement=function(){return this.getElement().find("div.book-logo img")},SongBook.prototype.getFirstMusicElement=function(){return this.getElement().find("ul.smb7-music-list li:first")},SongBook.prototype.getLastMusicElement=function(){return this.getElement().find("ul.smb7-music-list li:last")},SongBook.prototype.getBookContentsElement=function(){return this.getElement().find("div.smb7-songbook.book-contents")},SongBook.prototype.getMusicNameElement=function(){return this.getElement().find("div.smb7-music-name")},SongBook.prototype.getMusicNameHeaderElement=function(){return this.getMusicNameElement().find("h1")},SongBook.prototype.getMenuButtonElement=function(){return this.getElement().find("div.smb7-menu-placeholder a.smb7-menu-button")},SongBook.prototype.getHomeButtonElement=function(){return this.getElement().find("div.smb7-menu-placeholder a.smb7-home-button")},SongBook.prototype.getPlayButtonElement=function(){return this.getElement().find("div.smb7-control-buttons a.button.play")},SongBook.prototype.getPauseButtonElement=function(){return this.getElement().find("div.smb7-control-buttons a.button.paused")},SongBook.prototype.getStopButtonElement=function(){return this.getElement().find("div.smb7-control-buttons a.button.stop")},SongBook.prototype.getRepeatButtonElement=function(){return this.getElement().find("div.smb7-control-buttons a.button.repeat")},SongBook.prototype.getMenuElement=function(){return this.getElement().find("div.samba7-menu")},SongBook.prototype.getPlayerContainerElement=function(){return this.getElement().find("div.samba7-player")},SongBook.prototype.isPlaying=function(){return!1},SongBook.prototype.updateName=function(){return jQuery("div.smb7-songbook").attr("name",this.getName()),this},SongBook.prototype.getSelectedMusic=function(){return this.getMusicList().getSelectedMusic()},SongBook.prototype.getMusic=function(t){return this.getMusicList().get(t)},SongBook.prototype.toggleMenu=function(){var t=this.getMenuElement();return t.hasClass("open")?t.removeClass("open"):t.addClass("open"),this},SongBook.prototype.goToHome=function(){var t=this.getParameterByName("skipMenu");return null==t&&(t="false"),"true"!=t&&(document.location.href=SONGBOOK_CONFIG.homeUrl),this},SongBook.prototype.stop=function(){return this.getPlayer().stop(),this},SongBook.prototype.play=function(){return this.getPlayer().isPlaying()?this.getPlayer().pause():this.getPlayer().play(),this},SongBook.prototype.checkButtonsState=function(){var t=this.getPlayButtonElement(),e=this.getStopButtonElement();return e.removeClass("selected"),t.removeClass("paused"),t.removeClass("selected"),this.getPlayer().isPlaying()?(t.addClass("paused"),t.addClass("selected")):this.getPlayer().isPaused()?(t.removeClass("paused"),t.addClass("selected")):this.getPlayer().isStopped()&&e.addClass("selected"),this},SongBook.prototype.toggleRepeat=function(){var t=this.getRepeatButtonElement();return this.getPlayer().isRepeating()?(t.removeClass("selected"),this.getPlayer().setRepeat(!1)):(t.addClass("selected"),this.getPlayer().setRepeat(!0)),this},SongBook.prototype.getPartByTime=function(t){var e=this,o=this.getPlayer(),r=this.getSelectedMusic(),n=r.getSelectedPart(),i=e.getPlayer().getSheetViewer();if(void 0!=n)return i.setLastPartNumber(n.getNumber()),r.eachPart(function(e){var r=e.getNormalSyncStartTime(),i=e.getNormalSyncEndTime(),u=e.getSlowSyncStartTime(),s=e.getSlowSyncEndTime();return t>=r&&t<=i?(n=e,o.setPlaySpeedType(SongBookPlayer.PLAY_NORMAL_SPEED_TYPE),o.updateButtons(),!1):t>=u&&t<=s?(n=e,o.setPlaySpeedType(SongBookPlayer.PLAY_SLOW_SPEED_TYPE),o.updateButtons(),!1):void 0}),n},SongBook.prototype.selectPartByTime=function(t){var e=this.getPartByTime(t);return void 0==e?this:(this.getSelectedMusic().getPartList().clearSelectedPart(),e.setSelected(!0),this)},SongBook.prototype.populateSongbookInfo=function(){var t=this;return this.getMusicList().create(),this.getMusicList().eachMusic(function(e){var o=t.getConfiguration().getMusic(e.getNumber());e.setName(o.getName()),e.setYoutubeUrl(o.getYoutubeUrl())}),this},SongBook.prototype.updateInfo=function(){var t=this.getSelectedMusic();if(void 0!=t){var e=t.getNumber();null==e&&(e=1);var o=t.getName(),r=t.getTonality();this.getMusicNameHeaderElement().text(o+" ("+r+")"),this.getPlayer().playVideoById(t.getYoutubeUrl()).stop()}return this},SongBook.prototype.buildMappings=function(){var t=this;this.getMenuButtonElement().click(function(){return t.toggleMenu(),!1}),this.getHomeButtonElement().click(function(){return t.goToHome(),!1}),this.getPlayButtonElement().click(function(){return t.play(),!1}),this.getStopButtonElement().click(function(){return t.stop(),!1}),this.getRepeatButtonElement().click(function(){return t.toggleRepeat(),!1});var e=this.getParameterByName("music");null==e&&(e=1);var o=this.getParameterByName("skipMenu");null==o&&(o="false");var r=SongBook.WINDOW_RESIZE_HANDLER(this);jQuery(window).on("resize",r);var n=this.getMusic(e);void 0!=n&&n.select(),"true"==o&&this.disableMenu(),"function"==typeof r&&r()},SongBook.prototype.createPlayer=function(t){return this.songBookPlayer.create(t),this},SongBook.prototype.disableMenu=function(){this.getMenuElement().remove(),this.getMenuButtonElement().css("visibility","hidden"),this.toggleMenu=function(){}},SongBook.prototype.getParameterByName=function(t,e){e||(e=window.location.href),t=t.replace(/[\[\]]/g,"\\$&");var o=new RegExp("[?&]"+t+"(=([^&#]*)|&|#|$)").exec(e);return o?o[2]?decodeURIComponent(o[2].replace(/\+/g," ")):"":null},SongBookMusic.prototype=Object.create(SelectableElement.prototype),SongBookMusic.prototype.constructor=SongBookMusic,SongBookMusic.prototype.getSongBook=function(){return this.songbook},SongBookMusic.prototype.getConfig=function(){return this.getSongBook().getConfiguration().getMusic(this.getNumber())},SongBookMusic.prototype.getNumberElement=function(){return this.getElement().find("div.smb7-music-number")},SongBookMusic.prototype.getNameElement=function(){return this.getElement().find("div.smb7-music-info em.m-name")},SongBookMusic.prototype.getComposerElement=function(){return this.getElement().find("div.smb7-music-info em.m-composer")},SongBookMusic.prototype.getPartList=function(){return this.partList},SongBookMusic.prototype.getFirstPart=function(){return this.getPartList().getFirstPart()},SongBookMusic.prototype.getSelectedPart=function(){return this.getPartList().getSelectedPart()},SongBookMusic.prototype.selectFirstPart=function(){this.clearSelectedPart();var t=this.getFirstPart();return void 0!=t&&t.setSelected(!0),this},SongBookMusic.prototype.getPart=function(t){return this.getPartList().get(t)},SongBookMusic.prototype.removePart=function(t){var e=this.getPart(t);return void 0!=e&&e.getElement().remove(),this.getConfig().removePart(t),this.getPartList().remove(t),this},SongBookMusic.prototype.getNumber=function(){return null==this.number&&(this.number=this.getNumberElement().text(),this.number=1*this.number,isNaN(this.number)&&(this.number=0)),this.number},SongBookMusic.prototype.setYoutubeUrl=function(t){return this.youtubeUrl=t,this},SongBookMusic.prototype.getYoutubeUrl=function(){return this.youtubeUrl},SongBookMusic.prototype.setNumber=function(t){return this.number=t,this},SongBookMusic.prototype.getName=function(){return null==this.name&&(this.name=this.getNameElement().text(),void 0!=this.name&&null!=this.name||(this.name="")),this.name},SongBookMusic.prototype.setName=function(t){return this.name=t,this},SongBookMusic.prototype.getComposer=function(){return null==this.composer&&(this.composer=this.getComposerElement().text(),void 0!=this.composer&&null!=this.composer||(this.composer="")),this.composer},SongBookMusic.prototype.setComposer=function(t){return this.composer=t,this},SongBookMusic.prototype.getTonality=function(){if(null==this.tonality&&(this.tonality=this.getName(),this.tonality.indexOf("(")>-1)){var t=this.tonality.split(" ");this.tonality=t[t.length-1],this.tonality=this.tonality.replace("(",""),this.tonality=this.tonality.replace(")","")}return this.tonality},SongBookMusic.prototype.setTonality=function(t){return this.tonality=t,this},SongBookMusic.prototype.setSheetStartTime=function(t){return this.getSongBook().getConfiguration().getMusic(this.getNumber()).setSheetStartTime(t),this},SongBookMusic.prototype.setSheetEndTime=function(t){return this.getSongBook().getConfiguration().getMusic(this.getNumber()).setSheetEndTime(t),this},SongBookMusic.prototype.select=function(){return this.getSongBook().getMusicList().clearSelectedMusic(),this.setSelected(!0),this.getSongBook().getPlayer().hideSheets(),this.getSongBook().getMusicPanel().setCurrentSongBookMusic(this),this.getSongBook().updateInfo(),this.getSongBook().getPlayer().seekTo(0),this.getSongBook().getMusicPanel().populateMusicParts(this),this.getSongBook().getPlayer().getSheetPreloader().preload(),void 0!=this.getSongBook().getDebugger()&&this.getSongBook().getDebugger().isDebugging()&&(this.getSongBook().getDebugger().setReview(!1),this.getSongBook().getDebugger().setEditing(!1),this.getSongBook().getDebugger().updateOutput()),this},SongBookMusic.prototype.clearSelectedPart=function(){return this.getPartList().clearSelectedPart(),this},SongBookMusic.prototype.open=function(){return this.select(),this},SongBookMusic.prototype.eachPart=function(t){return this.getPartList().eachPart(t)},SongBookMusic.prototype.createPart=function(t,e){var o=this.getSongBook(),r=this.getPartList(),n=t.getNumber(),i=SongBookMusicConfig.SYNC_PREFIX+"."+SongBookSheetViewer.PART_TYPE+"."+e+"."+n;t.setDisplay(n),this.getConfig().put(i,{}),this.getConfig().addPart(n,t),r.add(n,new SongBookMusicPart(r.getSongBookMusic(),t)),o.getMusicPanel().populateMusicParts(this)},SongBookMusic.prototype.reorderParts=function(){var t=this.getPartList(),e=1;return this.getConfig().getPartMap().sort(e,function(t,o){return o.setNumber(e),e+=1}),e=1,t.sort(e,function(t,o){return o.setNumber(e),e+=1}),this},SongBookMusic.prototype.buildMappings=function(){var t=this;this.getElement().click(function(){return t.open(),t.getSongBook().toggleMenu(),!1})},SongBookMusicList.prototype.getSongBook=function(){return this.songbook},SongBookMusicList.prototype.getList=function(){return this.list},SongBookMusicList.prototype.getElement=function(){return null==this.element&&(this.element=this.getSongBook().getElement().find("ul.smb7-music-list")),this.element},SongBookMusicList.prototype.getMusicElements=function(){return this.getElement().find("li.smb7-music")},SongBookMusicList.prototype.get=function(t){return this.list[t]},SongBookMusicList.prototype.getFirstMusic=function(){return this.get(1)},SongBookMusicList.prototype.add=function(t){return this.list[t.getNumber()]=t,this},SongBookMusicList.prototype.buildMusicList=function(){var t=this;this.getMusicElements().each(function(){var e=jQuery(this);t.add(new SongBookMusic(t.getSongBook(),e))})},SongBookMusicList.prototype.clear=function(){return this.list={},this},SongBookMusicList.prototype.eachMusic=function(t){var e=this.getList();for(var o in e)t(e[o])},SongBookMusicList.prototype.clearSelectedMusic=function(){return this.eachMusic(function(t){t.deselect()}),this},SongBookMusicList.prototype.getSelectedMusic=function(){var t=null;return this.eachMusic(function(e){e.isSelected()&&(t=e)}),null==t?this.getFirstMusic():t},SongBookMusicList.prototype.create=function(){var t=this.getSongBook().getFirstMusicElement(),e=this;return this.getSongBook().getConfiguration().getMusicMap().each(function(o,r){var n=e.getSongBook().getLastMusicElement(),i=t.clone(),u=o;o<=9&&(o="0"+u);var s=r.getName(),g=r.getTonality(),a=r.getComposer(),p=r.getSpotifyLink(),l=r.getOpenLink();i.find("div.smb7-music-number").html(u),i.find("em.m-name").html(s+" ("+g+")"),i.find("em.m-composer").html(a),i.find("a.music-button.spotify").attr("href",p),i.find("a.music-button.play").attr("href",l),i.insertAfter(n)}),this.clear(),t.remove(),this.buildMusicList(),this},SongBookMusicPanel.prototype.getSongBook=function(){return this.songbook},SongBookMusicPanel.prototype.getCurrentSongBookMusic=function(){return this.currentSongBookMusic},SongBookMusicPanel.prototype.setCurrentSongBookMusic=function(t){return this.currentSongBookMusic=t,this},SongBookMusicPanel.prototype.getElement=function(){return null==this.element&&(this.element=this.getSongBook().getElement().find("div.smb7-music-panel")),this.element},SongBookMusicPanel.prototype.clear=function(){return this.getPartsElement().html("<li></li>"),this},SongBookMusicPanel.prototype.getPartsElement=function(){return this.getElement().find("ul.songbook-music-part-list")},SongBookMusicPanel.prototype.getFirstPartElement=function(){return this.getPartsElement().find("li:first")},SongBookMusicPanel.prototype.getLastPartElement=function(){return this.getPartsElement().find("li:last")},SongBookMusicPanel.prototype.selectFirstPart=function(){var t=this.getCurrentSongBookMusic().getFirstPart();return null!=t&&void 0!=t&&t.select(),this},SongBookMusicPanel.prototype.populateMusicParts=function(t){var e=this;e.clear();var o=this.getFirstPartElement();return t.eachPart(function(t){var r=e.getLastPartElement(),n=o.clone();n.text(t.getDisplay()),n.insertAfter(r),t.setElement(n)}),o.remove(),e.selectFirstPart(),this},SongBookMusicPart.prototype=Object.create(SelectableElement.prototype),SongBookMusicPart.prototype.constructor=SongBookMusicPart,SongBookMusicPart.prototype.getSongBookMusic=function(){return this.songBookMusic},SongBookMusicPart.prototype.getElement=function(){return null==this.element?jQuery():this.element},SongBookMusicPart.prototype.setElement=function(t){return this.element=t,this.buildMappings(),this},SongBookMusicPart.prototype.getPartConfig=function(){return this.partConfig},SongBookMusicPart.prototype.setNumber=function(t){return this.getElement().text(t),this},SongBookMusicPart.prototype.getSlowBarMap=function(){return this.getPartConfig().getSlowBarMap()},SongBookMusicPart.prototype.getNormalBarMap=function(){return this.getPartConfig().getNormalBarMap()},SongBookMusicPart.prototype.getNumber=function(){return this.getPartConfig().getNumber()},SongBookMusicPart.prototype.getDisplay=function(){return this.getPartConfig().getDisplay()},SongBookMusicPart.prototype.getSlowSyncStartTime=function(){return this.getPartConfig().getSlowSeekStartTime()},SongBookMusicPart.prototype.getSlowSyncEndTime=function(){return this.getPartConfig().getSlowSeekEndTime()},SongBookMusicPart.prototype.getSlowSyncTime=function(){return this.getSlowSyncStartTime()},SongBookMusicPart.prototype.getNormalSyncStartTime=function(){return this.getPartConfig().getNormalSeekStartTime()},SongBookMusicPart.prototype.getNormalSyncEndTime=function(){return this.getPartConfig().getNormalSeekEndTime()},SongBookMusicPart.prototype.getNormalSyncTime=function(){return this.getNormalSyncStartTime()},SongBookMusicPart.prototype.select=function(t){void 0==t&&(t=!1),this.getSongBookMusic().getPartList().clearSelectedPart(),this.setSelected(!0);var e=this.getSongBookMusic().getSongBook().getPlayer();return this.getSongBookMusic().getSongBook().getDebugger().isEditing()||(t?(e.setPlaySpeedType(SongBookPlayer.PLAY_NORMAL_SPEED_TYPE),e.seekTo(this.getNormalSyncTime())):e.getPlaySpeedType()==SongBookPlayer.PLAY_NORMAL_SPEED_TYPE?e.seekTo(this.getNormalSyncTime()):e.seekTo(this.getSlowSyncTime())),this},SongBookMusicPart.prototype.removeBar=function(t,e){return this.getPartConfig().removeBar(t,e),this},SongBookMusicPart.prototype.reorderBarsFrom=function(t,e){var o=1;return void 0!=e&&(o=e),t.sort(o,function(t,e){return e.setNumber(o),e.hasCustomLineBars()?o+=e.getCustomLineBars():o+=BarDebuggerOutput.BARS_PER_LINE,o}),o},SongBookMusicPart.prototype.reorderBars=function(t){return this.reorderBarsFrom(this.getNormalBarMap(),t),this.reorderBarsFrom(this.getSlowBarMap(),t),this},SongBookMusicPart.prototype.buildMappings=function(){var t=this;return this.getElement().click(function(){t.select(!0)}),this},SongBookMusicPartList.prototype.getSongBookMusic=function(){return this.songBookMusic},SongBookMusicPartList.prototype.getList=function(){return this.list},SongBookMusicPartList.prototype.get=function(t){return this.list[t]},SongBookMusicPartList.prototype.getFirstPart=function(){return this.get(1)},SongBookMusicPartList.prototype.eachPart=function(t){var e=this.getList();for(var o in e)if(0==t(e[o]))break;return this},SongBookMusicPartList.prototype.clearSelectedPart=function(){return this.eachPart(function(t){t.deselect()}),this},SongBookMusicPartList.prototype.getSelectedPart=function(){var t=null;return this.eachPart(function(e){e.isSelected()&&(t=e)}),null==t?this.getFirstPart():t},SongBookMusicPartList.prototype.add=function(t,e){return this.list[t]=e,this},SongBookMusicPartList.prototype.remove=function(t){return delete this.list[t],this},SongBookMusicPartList.prototype.sort=function(t,e){var o=this.list,r={};for(var n in o){var i=o[n];r[t]=i,t=e.call(this,n,i)}return this.list=r,this},SongBookMusicPartList.prototype.buildMusicPartList=function(){var t=this,e=this.getSongBookMusic().getSongBook().getConfiguration(),o=this.getSongBookMusic().getNumber(),r=e.getMusic(o);return void 0==r?this:(r.eachPart(function(e,o){t.add(e,new SongBookMusicPart(t.getSongBookMusic(),o))}),this)},SongBookPlayerButton.prototype=Object.create(SelectableElement.prototype),SongBookPlayerButton.prototype.constructor=SongBookPlayerButton,SongBookPlayerButton.NORMAL_VIDEO_BUTTON=0,SongBookPlayerButton.SLOW_VIDEO_BUTTON=1,SongBookPlayerButton.NORMAL_PLAYER_BUTTON=2,SongBookPlayerButton.SLOW_PLAYER_BUTTON=3,SongBookPlayerButton.VERYSLOW_PLAYER_BUTTON=4,SongBookPlayerButton.ULTRASLOW_PLAYER_BUTTON=5,SongBookPlayerButton.ZOOM_SHEET_BUTTON=6,SongBookPlayerButton.NOTE_SHEET_BUTTON=7,SongBookPlayerButton.NORMAL_SHEET_BUTTON=8,SongBookPlayerButton.TABLATURE_SHEET_BUTTON=9,SongBookPlayerButton.prototype.getPlayerPanel=function(){return this.playerPanel},SongBookPlayerButton.prototype.getType=function(){return null==this.type&&(this.type=this.getElement().attr("type")),this.type},SongBookPlayerButton.prototype.getValue=function(){return null==this.value&&(this.value=this.getElement().attr("value")),this.value},SongBookPlayerButton.prototype.getStartSelected=function(){return null==this.startSelected&&(this.startSelected=this.getElement().attr("startSelected"),this.startSelected=this.startSelected+"","true"==this.startSelected?this.startSelected=!0:this.startSelected=!1),this.startSelected},SongBookPlayerButton.prototype.isStartSelected=function(){return 1==this.getStartSelected()},SongBookPlayerButton.prototype.run=function(){return this.getPlayerPanel().runButton(this)},SongBookPlayerButton.prototype.select=function(){return this.setSelected(!0),this.run(),this},SongBookPlayerButton.prototype.buildMappings=function(){var t=this;return this.getElement().click(function(){t.select()}),this},SongBookPlayer.PLAY_NORMAL_SPEED_TYPE="normal",SongBookPlayer.PLAY_SLOW_SPEED_TYPE="slow",SongBookPlayer.SMALL_PLAYER_SIZE="small",SongBookPlayer.MEDIUM_PLAYER_SIZE="medium",SongBookPlayer.FULLHD_PLAYER_SIZE="fullhd",SongBookPlayer.TIME_WATCH_FUNCTIONS={selectPartByTime:function(t){var e=t.getCurrentTime(),o=t.getSongBook(),r=o.getSelectedMusic().getSelectedPart(),n=o.getPartByTime(e),i=0,u=0,s=0,g=0;void 0!=r&&void 0!=n&&(t.checkSheetDisplayRange(e),t.getPlaySpeedType()==SongBookPlayer.PLAY_NORMAL_SPEED_TYPE?(i=r.getNormalSyncStartTime(),u=r.getNormalSyncEndTime(),s=n.getNormalSyncStartTime(),g=n.getNormalSyncEndTime()):(i=r.getSlowSyncStartTime(),u=r.getSlowSyncEndTime(),s=n.getSlowSyncStartTime(),g=n.getSlowSyncEndTime()),i!=s&&u!=g&&(t.isRepeating()?t.seekTo(i):(o.getSelectedMusic().clearSelectedPart(),n.setSelected(!0))))},updateSheetDisplay:function(t){var e=t.getCurrentTime();t.getSheetViewer().update(e)}},SongBookPlayer.onReadyHandler=function(t){return function(){}},SongBookPlayer.onStateChangeHandler=function(t){return function(){if(t.getPlayer().getPlayerState()==YT.PlayerState.PLAYING?t.startTimeWatch():t.pauseTimeWatch(),t.getSongBook().checkButtonsState(),t.isPaused()){var e=t.getSongBook().getDebugger(),o=t.getCurrentTime();(!e.isDebugging()||e.isDebugging()&&!e.isEditing())&&(t.getSongBook().selectPartByTime(o),t.getSheetViewer().update(o))}}},SongBookPlayer.prototype.getButton=function(t){return this.getPlayerPanel().getButton(t)},SongBookPlayer.prototype.getPlayer=function(){return this.player},SongBookPlayer.prototype.getPlayerPanel=function(){return this.playerPanel},SongBookPlayer.prototype.getSheetViewer=function(){return this.sheetViewer},SongBookPlayer.prototype.getSheetPreloader=function(){return this.sheetPreloader},SongBookPlayer.prototype.getPlaySpeedType=function(){return this.playSpeedType},SongBookPlayer.prototype.setPlaySpeedType=function(t){return this.playSpeedType=t,this},SongBookPlayer.prototype.getPlayerSize=function(){return this.playerSize},SongBookPlayer.prototype.setPlayerSize=function(t){return this.playerSize=t,this.getElement().removeClass(SongBookPlayer.SMALL_PLAYER_SIZE),this.getElement().removeClass(SongBookPlayer.MEDIUM_PLAYER_SIZE),this.getElement().removeClass(SongBookPlayer.FULLHD_PLAYER_SIZE),this.getElement().addClass(t),this},SongBookPlayer.prototype.getName=function(){return this.name},SongBookPlayer.prototype.setName=function(t){return this.name=t,this},SongBookPlayer.prototype.getSongBook=function(){return this.songBook},SongBookPlayer.prototype.getElement=function(){return null==this.element&&(this.element=this.getSongBook().getElement().find("div.smb7-songbook-player")),this.element},SongBookPlayer.prototype.disable=function(){return this.enabled=!1,this},SongBookPlayer.prototype.enable=function(){return this.enabled=!0,this},SongBookPlayer.prototype.isEnabled=function(){return 1==this.enabled},SongBookPlayer.prototype.getCurrentTime=function(){return this.getPlayer().getCurrentTime()},SongBookPlayer.prototype.toggleNoteNames=function(){return this.getSheetViewer().toggleNoteNames(),this},SongBookPlayer.prototype.updateButtons=function(){var t=this.getButton(SongBookPlayerButton.NORMAL_VIDEO_BUTTON),e=this.getButton(SongBookPlayerButton.SLOW_VIDEO_BUTTON);return this.getPlaySpeedType()==SongBookPlayer.PLAY_NORMAL_SPEED_TYPE?(t.setSelected(!0),e.setSelected(!1)):(t.setSelected(!1),e.setSelected(!0)),this},SongBookPlayer.prototype.runWatchFunctions=function(){var t=SongBookPlayer.TIME_WATCH_FUNCTIONS,e=this.getSongBook().getDebugger();if(!e.isDebugging()||e.isDebugging()&&!e.isEditing())for(var o in t){var r=t[o];"function"==typeof r&&r.call(this,this)}return this},SongBookPlayer.prototype.startTimeWatch=function(){var t=this,e=this.getPlayer();return this.watchTimeout=window.setTimeout(function(){e.getCurrentTime();t.runWatchFunctions(),t.startTimeWatch()},100),this},SongBookPlayer.prototype.pauseTimeWatch=function(){return window.clearTimeout(this.watchTimeout),this},SongBookPlayer.prototype.updateViewSize=function(){var t=this.getSheetViewer().getDisplayType();t==SongBookSheetViewer.PART_TYPE?(this.getElement().addClass(SongBookSheetViewer.PART_TYPE+"-view"),this.getElement().removeClass(SongBookSheetViewer.TAB_TYPE+"-view")):t==SongBookSheetViewer.TAB_TYPE&&(this.getElement().removeClass(SongBookSheetViewer.PART_TYPE+"-view"),this.getElement().addClass(SongBookSheetViewer.TAB_TYPE+"-view"))},SongBookPlayer.prototype.checkSheetDisplayRange=function(t){var e=this.getSongBook().getConfiguration(),o=this.getSongBook().getSelectedMusic().getNumber(),r=e.getMusic(o),n=r.getSheetStartTime(),i=r.getSheetEndTime();t>=n&&t<=i?this.showSheets():this.hideSheets()},SongBookPlayer.prototype.hideSheets=function(){this.getElement().addClass("no-sheet")},SongBookPlayer.prototype.showSheets=function(){this.getElement().removeClass("no-sheet")},SongBookPlayer.prototype.setRepeat=function(t){return this.repeat=t,this},SongBookPlayer.prototype.isRepeating=function(){return 1==this.repeat},SongBookPlayer.prototype.playVideoById=function(t){return null==this.getPlayer()||void 0==this.getPlayer()?this:(void 0==t&&(t=""),this.getPlayer().loadVideoById(t),this)},SongBookPlayer.prototype.play=function(){return null!=this.getPlayer()&&void 0!=this.getPlayer()&&this.isEnabled()?(this.getPlayer().playVideo(),this):this},SongBookPlayer.prototype.pause=function(){return null!=this.getPlayer()&&void 0!=this.getPlayer()&&this.isEnabled()?(this.getPlayer().pauseVideo(),this):this},SongBookPlayer.prototype.stop=function(){return null!=this.getPlayer()&&void 0!=this.getPlayer()&&this.isEnabled()?(void 0!=this.getPlayer().stopVideo&&this.getPlayer().stopVideo(),this):this},SongBookPlayer.prototype.seekTo=function(t){return null!=this.getPlayer()&&void 0!=this.getPlayer()&&this.isEnabled()?(void 0!=this.getPlayer().seekTo&&this.getPlayer().seekTo(t),this):this},SongBookPlayer.prototype.setPlaybackRate=function(t){return null!=this.getPlayer()&&void 0!=this.getPlayer()&&this.isEnabled()?(this.getPlayer().setPlaybackRate(t),this):this},SongBookPlayer.prototype.isPlaying=function(){return null!=this.getPlayer()&&void 0!=this.getPlayer()&&this.getPlayer().getPlayerState()==YT.PlayerState.PLAYING},SongBookPlayer.prototype.isPaused=function(){return null!=this.getPlayer()&&void 0!=this.getPlayer()&&this.getPlayer().getPlayerState()==YT.PlayerState.PAUSED},SongBookPlayer.prototype.isStopped=function(){return null!=this.getPlayer()&&void 0!=this.getPlayer()&&this.getPlayer().getPlayerState()==YT.PlayerState.CUED},SongBookPlayer.prototype.create=function(t){var e=this.getSongBook().getSelectedMusic();this.setName(t),this.player=new YT.Player(this.getName(),{videoId:e.getYoutubeUrl(),events:{onReady:SongBookPlayer.onReadyHandler(this),onStateChange:SongBookPlayer.onStateChangeHandler(this)},playerVars:{rel:0,modestbranding:1}})},SongBookPlayerPanel.CONTROL_BUTTONS_PREFIX=".smb7-player-button",SongBookPlayerPanel.BUTTON_FUNCTIONS={speed:{normal:function(t){var e=t.getPlayerPanel().getPlayer(),o=e.getSongBook().getSelectedMusic().getSelectedPart();if(void 0!=o){var r=o.getNormalSyncTime();e.setPlaySpeedType(SongBookPlayer.PLAY_NORMAL_SPEED_TYPE),e.seekTo(r)}},slow:function(t){var e=t.getPlayerPanel().getPlayer(),o=e.getSongBook().getSelectedMusic().getSelectedPart().getSlowSyncTime();e.setPlaySpeedType(SongBookPlayer.PLAY_SLOW_SPEED_TYPE),e.seekTo(o)},.75:function(t){var e=t.getPlayerPanel().getPlayer(),o=e.getButton(SongBookPlayerButton.SLOW_PLAYER_BUTTON),r=e.getButton(SongBookPlayerButton.VERYSLOW_PLAYER_BUTTON),n=e.getButton(SongBookPlayerButton.ULTRASLOW_PLAYER_BUTTON),i=e.getButton(SongBookPlayerButton.NORMAL_PLAYER_BUTTON);o.setSelected(!0),r.setSelected(!1),n.setSelected(!1),i.setSelected(!1),e.setPlaybackRate(.75)},.5:function(t){var e=t.getPlayerPanel().getPlayer(),o=e.getButton(SongBookPlayerButton.SLOW_PLAYER_BUTTON),r=e.getButton(SongBookPlayerButton.VERYSLOW_PLAYER_BUTTON),n=e.getButton(SongBookPlayerButton.ULTRASLOW_PLAYER_BUTTON),i=e.getButton(SongBookPlayerButton.NORMAL_PLAYER_BUTTON);o.setSelected(!1),r.setSelected(!0),n.setSelected(!1),i.setSelected(!1),e.setPlaybackRate(.5)},.25:function(t){var e=t.getPlayerPanel().getPlayer(),o=e.getButton(SongBookPlayerButton.SLOW_PLAYER_BUTTON),r=e.getButton(SongBookPlayerButton.VERYSLOW_PLAYER_BUTTON),n=e.getButton(SongBookPlayerButton.ULTRASLOW_PLAYER_BUTTON),i=e.getButton(SongBookPlayerButton.NORMAL_PLAYER_BUTTON);o.setSelected(!1),r.setSelected(!1),n.setSelected(!0),i.setSelected(!1),e.setPlaybackRate(.25)},1:function(t){var e=t.getPlayerPanel().getPlayer(),o=e.getButton(SongBookPlayerButton.SLOW_PLAYER_BUTTON),r=e.getButton(SongBookPlayerButton.VERYSLOW_PLAYER_BUTTON),n=e.getButton(SongBookPlayerButton.ULTRASLOW_PLAYER_BUTTON),i=e.getButton(SongBookPlayerButton.NORMAL_PLAYER_BUTTON);o.setSelected(!1),r.setSelected(!1),n.setSelected(!1),i.setSelected(!0),e.setPlaybackRate(1)}},sheet:{zoom:function(t){var e=t.getPlayerPanel().getPlayer(),o=e.getButton(SongBookPlayerButton.ZOOM_SHEET_BUTTON),r=e.getSheetViewer().getZoomController();r.toggle(),o.setSelected(r.isEnabled())},notes:function(t){var e=t.getPlayerPanel().getPlayer(),o=e.getButton(SongBookPlayerButton.NOTE_SHEET_BUTTON),r=e.getButton(SongBookPlayerButton.NORMAL_SHEET_BUTTON),n=e.getButton(SongBookPlayerButton.TABLATURE_SHEET_BUTTON);e.toggleNoteNames(),e.getSheetViewer().setDisplayType(SongBookSheetViewer.PART_TYPE),o.setSelected(e.getSheetViewer().isShowNoteNames()),n.setSelected(!1),r.setSelected(!0),e.isPaused()&&e.getSheetViewer().update(e.getCurrentTime())},parts:function(t){var e=t.getPlayerPanel().getPlayer(),o=e.getButton(SongBookPlayerButton.NORMAL_SHEET_BUTTON),r=e.getButton(SongBookPlayerButton.TABLATURE_SHEET_BUTTON),n=e.getCurrentTime();e.getSheetViewer().setDisplayType(SongBookSheetViewer.PART_TYPE),o.setSelected(!0),r.setSelected(!1),e.getSheetViewer().update(n)},tabs:function(t){var e=t.getPlayerPanel().getPlayer(),o=e.getButton(SongBookPlayerButton.NORMAL_SHEET_BUTTON),r=e.getButton(SongBookPlayerButton.TABLATURE_SHEET_BUTTON),n=e.getButton(SongBookPlayerButton.NOTE_SHEET_BUTTON),i=e.getCurrentTime();n.setSelected(!1),e.getSheetViewer().setShowNoteNames(!1),e.getSheetViewer().setDisplayType(SongBookSheetViewer.TAB_TYPE),o.setSelected(!1),r.setSelected(!0),e.getSheetViewer().update(i)}}},SongBookPlayerPanel.prototype.getPlayer=function(){return this.player},SongBookPlayerPanel.prototype.getButtons=function(){return this.buttons},SongBookPlayerPanel.prototype.getButton=function(t){return this.getButtons()[t]},SongBookPlayerPanel.prototype.getElement=function(){return null==this.element&&(this.element=this.getPlayer().getElement().find("div.player-controls")),this.element},SongBookPlayerPanel.prototype.eachButton=function(t){var e=this.getButtons();for(var o in e)t(e[o]);return this},SongBookPlayerPanel.prototype.clearSelectedButton=function(){return this.eachButton(function(t){t.deselect()}),this},SongBookPlayerPanel.prototype.runButton=function(t){var e=SongBookPlayerPanel.BUTTON_FUNCTIONS[t.getType()];void 0==e&&(e={});var o=e[t.getValue()];return"function"==typeof o&&o.call(this,t),this},SongBookPlayerPanel.prototype.buildButtons=function(){var t={},e=this,o=0;return this.getElement().find(SongBookPlayerPanel.CONTROL_BUTTONS_PREFIX).each(function(){var r=jQuery(this),n=new SongBookPlayerButton(e,r);t[o]=n,n.isStartSelected()&&n.setSelected(!0),o++}),t},SongBookMusic.prototype.open=function(){var t=songbook.getConfiguration().getMusicMap().get(this.getNumber()).getYoutubeUrl(),e=screen.width/100*75,o=screen.height/100*75;return this.select(),window.open("https://www.youtube.com/embed/"+t+"?autoplay=true","ytvid","width="+e+",height="+o),this};var SongBookPlaylist={populateSongBookInfo:function(){window.songbook.getBookLogoElement().attr("title",songbook.getConfiguration().getFullName())},triggerPlayButton:function(){songbook.getElement().find("div.songbook-play-button a.play").click(function(){var t=songbook.getConfiguration().getMusicMap().get(1).getYoutubeUrl(),e=screen.width/100*75,o=screen.height/100*75;return songbook.getMusic(1).select(),window.open("https://www.youtube.com/embed/"+t+"?autoplay=true","ytvid","width="+e+",height="+o),!1})}};SongBookSheetPreloader.prototype.getElement=function(){return null==this.element&&(this.element=this.getSongBookPlayer().getElement().find("div.sheet-preloader")),this.element},SongBookSheetPreloader.prototype.getSongBookPlayer=function(){return this.songBookPlayer},SongBookSheetPreloader.prototype.getSongBook=function(){return this.getSongBookPlayer().getSongBook()},SongBookSheetPreloader.prototype.getLabelElement=function(){return this.getElement().find("div.prld-label")},SongBookSheetPreloader.prototype.getProgressBarElement=function(){return this.getElement().find("div.progress-bar")},SongBookSheetPreloader.prototype.getPercentageElement=function(){return this.getProgressBarElement().find("span.percentage")},SongBookSheetPreloader.prototype.getImageMap=function(){return this.imageMap},SongBookSheetPreloader.prototype.getImagePath=function(t,e){var o=this.getSongBook(),r=o.getConfiguration().getSheetUrlPrefix(),n=o.getSelectedMusic().getNumber();n<10&&(n="0"+n);var i="";return t==SongBookSheetViewer.PART_TYPE?i=SongBookSheetViewer.PARTS_REPOSITORY+"/"+n+"/"+e.getNumber()+".png":t==SongBookSheetViewer.PARTNOTES_TYPE?i=SongBookSheetViewer.PARTNOTES_REPOSITORY+"/"+n+"/"+e.getNumber()+".png":t==SongBookSheetViewer.TAB_TYPE&&(i=SongBookSheetViewer.TABS_REPOSITORY+"/"+n+"/"+e.getNumber()+".png"),r+i},SongBookSheetPreloader.prototype.getPartPath=function(t){return this.getImagePath(SongBookSheetViewer.PART_TYPE,t)},SongBookSheetPreloader.prototype.getPartNotePath=function(t){return this.getImagePath(SongBookSheetViewer.PARTNOTES_TYPE,t)},SongBookSheetPreloader.prototype.getTabPath=function(t){return this.getImagePath(SongBookSheetViewer.TAB_TYPE,t)},SongBookSheetPreloader.prototype.addImage=function(t,e){var o=this.getPartPath(e),r=this.getPartNotePath(e),n=this.getTabPath(e);this.getImageMap().put(t+"-"+SongBookSheetViewer.PART_TYPE,o),this.getImageMap().put(t+"-"+SongBookSheetViewer.PARTNOTES_TYPE,r),this.getImageMap().put(t+"-"+SongBookSheetViewer.TAB_TYPE,n)},SongBookSheetPreloader.prototype.buildImages=function(){var t=this;return this.getSongBook().getSelectedMusic().getConfig().eachPart(function(e,o){o.eachBar(SongBookSheetViewer.PART_TYPE,SongBookPlayer.PLAY_NORMAL_SPEED_TYPE,function(e,o){t.addImage(e,o)}),o.eachBar(SongBookSheetViewer.PARTNOTES_TYPE,SongBookPlayer.PLAY_NORMAL_SPEED_TYPE,function(e,o){t.addImage(e,o)}),o.eachBar(SongBookSheetViewer.TAB_TYPE,SongBookPlayer.PLAY_NORMAL_SPEED_TYPE,function(e,o){t.addImage(e,o)})}),this},SongBookSheetPreloader.prototype.reset=function(){this.imageMap=new Map,this.getPercentageElement().css("width",0)},SongBookSheetPreloader.prototype.finish=function(){this.getElement().hide(),this.getSongBookPlayer().seekTo(0)},SongBookSheetPreloader.prototype.preload=function(){this.reset(),this.getElement().show(),this.buildImages();var t=this,e=this.getPercentageElement(),o=100/this.getImageMap().size(),r=0;this.getImageMap().each(function(n,i){jQuery("<img />").attr("src",i).on("load error",function(){e.stop(!1,!0).animate({width:"+="+o+"%"},100),++r==t.getImageMap().size()&&t.finish()})}),this.getImageMap().isEmpty()&&t.finish()},SheetReviewerCompassButton.prototype=Object.create(SelectableElement.prototype),SheetReviewerCompassButton.prototype.constructor=SheetReviewerCompassButton,SheetReviewerCompassButton.prototype.getSongBook=function(){return this.getSheetReviewer().getSongBook()},SheetReviewerCompassButton.prototype.getSheetReviewer=function(){return this.sheetReviewer},SheetReviewerCompassButton.prototype.getName=function(){return this.name},SheetReviewerCompassButton.prototype.getElement=function(){return this.element},SheetReviewerCompassButton.prototype.getCompassNumber=function(){return this.compassNumber},SheetReviewerCompassButton.prototype.setCompassNumber=function(t){return this.compassNumber=t,this},SheetReviewerCompassButton.prototype.select=function(){return this.getSheetReviewer().clearSelectedCompassButton(),this.setSelected(!0),this},SheetReviewerCompassButton.prototype.buildMappings=function(){var t=this,e=1*this.getElement().text();this.setCompassNumber(e),this.getElement().click(function(){return t.select(),!1})},SongBookSheetReviewer.prototype.getSongBook=function(){return this.songBook},SongBookSheetReviewer.prototype.getDebugger=function(){return this.getSongBook().getDebugger()},SongBookSheetReviewer.prototype.getOutputManager=function(){return this.getDebugger().getOutputManager()},SongBookSheetReviewer.prototype.getElement=function(){return null==this.element&&(this.element=this.getSongBook().getElement().find("div.sheet-reviewer")),this.element},SongBookSheetReviewer.prototype.getViewElements=function(){return this.getElement().find("div.rvw-view")},SongBookSheetReviewer.prototype.getCompassButtonElements=function(){return this.getElement().find("ul.cmp-numbers li.cmp-num")},SongBookSheetReviewer.prototype.getViewsMap=function(){return this.viewsMap},SongBookSheetReviewer.prototype.getCompassButtonsMap=function(){return this.compassButtonsMap},SongBookSheetReviewer.prototype.getCurrentBarNumber=function(){return this.currentBarNumber},SongBookSheetReviewer.prototype.setCurrentBarNumber=function(t){return this.currentBarNumber=t,this},SongBookSheetReviewer.prototype.setCurrentBarOutput=function(t){var e=this;return void 0==t?this.setCurrentBarNumber(1):(this.currentBarOutput=t,this.setCurrentBarNumber(t.getNumber()),t.hasCustomLineBars()?this.setCompassNumber(t.getCustomLineBars()):this.setCompassNumber(BarDebuggerOutput.BARS_PER_LINE)),this.eachView(function(t,o){o.setBarNumber(e.getCurrentBarNumber())}),this},SongBookSheetReviewer.prototype.getCurrentBarOutput=function(){return this.currentBarOutput},SongBookSheetReviewer.prototype.eachView=function(t){return this.getViewsMap().each(function(e,o){return t.call(this,e,o)}),this},SongBookSheetReviewer.prototype.eachCompassButton=function(t){return this.getCompassButtonsMap().each(function(e,o){return t.call(this,e,o)}),this},SongBookSheetReviewer.prototype.clearSelectedCompassButton=function(){return this.eachCompassButton(function(t,e){e.deselect()}),this},SongBookSheetReviewer.prototype.clearViews=function(){return this.getViewsMap().clear(),this},SongBookSheetReviewer.prototype.clearCompassButtons=function(){return this.getCompassButtonsMap().clear(),this},SongBookSheetReviewer.prototype.addView=function(t,e){return this.getViewsMap().put(t,e),this},SongBookSheetReviewer.prototype.getView=function(t){return this.getViewsMap().get(t)},SongBookSheetReviewer.prototype.addCompassButton=function(t,e){return this.getCompassButtonsMap().put(t,e),this},SongBookSheetReviewer.prototype.getCompassButton=function(t){return this.getCompassButtonsMap().get(t)},SongBookSheetReviewer.prototype.setCompassNumber=function(t){var e=this.getCompassButton(t);return void 0!=e&&(this.clearSelectedCompassButton(),e.setSelected(!0)),this},SongBookSheetReviewer.prototype.reset=function(){return this.eachView(function(t,e){e.setUrl("")}),this.getOutputManager().selectFirstBarOutput(),this},SongBookSheetReviewer.prototype.buildViewsMap=function(){var t=this;this.clearViews(),this.getViewElements().each(function(){var e=jQuery(this),o=e.attr("name");t.addView(o,new SheetReviewerView(t,o,e))})},SongBookSheetReviewer.prototype.buildCompassButtonsMap=function(){var t=this;this.clearCompassButtons(),this.getCompassButtonElements().each(function(){var e=jQuery(this),o=e.attr("name");t.addCompassButton(o,new SheetReviewerCompassButton(t,o,e))})},SongBookSheetReviewer.prototype.buildMappings=function(){},SheetReviewerView.prototype.getSongBook=function(){return this.getSheetReviewer().getSongBook()},SheetReviewerView.prototype.getSheetReviewer=function(){return this.sheetReviewer},SheetReviewerView.prototype.getName=function(){return this.name},SheetReviewerView.prototype.getElement=function(){return this.element},SheetReviewerView.prototype.getLabelElement=function(){return this.getElement().find("div.view-label")},SheetReviewerView.prototype.getNotFoundElement=function(){return this.getElement().find("div.not-found-message")},SheetReviewerView.prototype.getNotFoundPathElement=function(){return this.getNotFoundElement().find("em.path")},SheetReviewerView.prototype.getDisplayImageElement=function(){return this.getElement().find("img.display-image")},SheetReviewerView.prototype.getUrl=function(){return this.url},SheetReviewerView.prototype.setUrl=function(t){return this.url=t,this.getNotFoundPathElement().text(t),this.getDisplayImageElement().attr("src",t),this},SheetReviewerView.prototype.getPath=function(){var t=this.getName(),e=this.getSongBook().getSelectedMusic().getNumber();e<10&&(e="0"+e);var o="";return t==SongBookSheetViewer.PARTNOTES_TYPE?o=SongBookSheetViewer.PARTNOTES_REPOSITORY+"/"+e:t==SongBookSheetViewer.PART_TYPE?o=SongBookSheetViewer.PARTS_REPOSITORY+"/"+e:t==SongBookSheetViewer.TAB_TYPE&&(o=SongBookSheetViewer.TABS_REPOSITORY+"/"+e),o},SheetReviewerView.prototype.getBarNumber=function(){return this.barNumber},SheetReviewerView.prototype.setBarNumber=function(t){var e=this.getPath()+"/"+t+".png";return this.barNumber=t,this.setUrl(e),this.getElement().addClass("opened"),this},SheetReviewerView.prototype.buildMappings=function(){},SongBookSheetViewer.PART_TYPE="parts",SongBookSheetViewer.PARTNOTES_TYPE="partnotes",SongBookSheetViewer.TAB_TYPE="tabs",SongBookSheetViewer.PARTS_REPOSITORY="images/musics/parts",SongBookSheetViewer.PARTNOTES_REPOSITORY="images/musics/partnotes",SongBookSheetViewer.TABS_REPOSITORY="images/musics/tabs",SongBookSheetViewer.prototype.getElement=function(){return null==this.element&&(this.element=this.getSongBookPlayer().getElement().find("div.player-sheets")),this.element},SongBookSheetViewer.prototype.getDisplayImageElement=function(){return null==this.displayImageElement&&(this.displayImageElement=this.getElement().find("img.display-image")),this.displayImageElement},SongBookSheetViewer.prototype.getZoomController=function(){return this.zoomController},SongBookSheetViewer.prototype.getSongBook=function(){return this.getSongBookPlayer().getSongBook()},SongBookSheetViewer.prototype.getSongBookPlayer=function(){return this.songBookPlayer},SongBookSheetViewer.prototype.getUrl=function(){return this.url},SongBookSheetViewer.prototype.setUrl=function(t){return this.url=t,this.getDisplayImageElement().attr("src",t),this},SongBookSheetViewer.prototype.getLastUrl=function(){return this.lastUrl},SongBookSheetViewer.prototype.setLastUrl=function(){var t=this.getDisplayImageElement();return this.lastUrl=t.attr("src"),this},SongBookSheetViewer.prototype.getLastPartNumber=function(){return this.lastPartNumber},SongBookSheetViewer.prototype.setLastPartNumber=function(t){return this.lastPartNumber=t,this},SongBookSheetViewer.prototype.getDisplayType=function(){return this.displayType},SongBookSheetViewer.prototype.setDisplayType=function(t){return this.displayType=t,this.getSongBookPlayer().updateViewSize(),this},SongBookSheetViewer.prototype.isShowNoteNames=function(){return 1==this.showNoteNames},SongBookSheetViewer.prototype.setShowNoteNames=function(t){return this.showNoteNames=t,this},SongBookSheetViewer.prototype.toggleNoteNames=function(){return this.isShowNoteNames()?this.showNoteNames=!1:this.showNoteNames=!0,this},SongBookSheetViewer.prototype.updateZoomProperties=function(t){return this.getZoomController().update(t),this},SongBookSheetViewer.prototype.getPath=function(t){void 0==t&&(t=this.getDisplayType());var e=this.getSongBook(),o=e.getConfiguration().getSheetUrlPrefix(),r=e.getSelectedMusic().getNumber();r<10&&(r="0"+r);var n="";return this.isShowNoteNames()?n=SongBookSheetViewer.PARTNOTES_REPOSITORY+"/"+r:t==SongBookSheetViewer.PART_TYPE?n=SongBookSheetViewer.PARTS_REPOSITORY+"/"+r:t==SongBookSheetViewer.TAB_TYPE&&(n=SongBookSheetViewer.TABS_REPOSITORY+"/"+r),o+n},SongBookSheetViewer.prototype.getSyncTimes=function(t){var e=this.getSongBook().getSelectedMusic(),o=(this.getSongBook().getConfiguration(),e.getNumber());return configParser.getMusicSyncTimes(o,SongBookSheetViewer.PART_TYPE)},SongBookSheetViewer.prototype.update=function(t){var e=this.getSongBook(),o=e.getConfiguration(),r=e.getSelectedMusic(),n=r.getSelectedPart();if(void 0==n)return this;var i=n.getNumber(),u=o.getMusic(r.getNumber()).getPart(i),s=this.getPath(),g="",a=!1,p=0,l="",h=0;return this.setLastUrl(),u.eachBar(SongBookSheetViewer.PART_TYPE,SongBookPlayer.PLAY_NORMAL_SPEED_TYPE,function(e,o){var r=o.getStartTime(),n=o.getEndTime(),e=o.getNumber();if(t>=r&&t<=n)return a=!0,g=s+"/"+e+".png",l=SongBookPlayer.PLAY_NORMAL_SPEED_TYPE,p=e,h=u.getNumber(),!1}),0==a&&u.eachBar(SongBookSheetViewer.PART_TYPE,SongBookPlayer.PLAY_SLOW_SPEED_TYPE,function(e,o){var r=o.getStartTime(),n=o.getEndTime(),e=o.getNumber();if(t>=r&&t<=n)return g=s+"/"+o.getNumber()+".png",l=SongBookPlayer.PLAY_SLOW_SPEED_TYPE,p=e,h=u.getNumber(),!1}),(this.getLastUrl()!=g&&""!=g||h!=this.getLastPartNumber())&&(this.setUrl(g),this.updateZoomProperties(g),e.getDebugger().isDebugging()&&!e.getDebugger().isEditing()&&e.getDebugger().selectBarOutput(p,l)),this},SongBookSheetViewer.prototype.updateWithBarOutput=function(t){this.setLastUrl(),this.getSongBookPlayer().showSheets();var e=this.getPath()+"/"+t.getNumber()+".png";this.setUrl(e),this.updateZoomProperties(e)},SongBookSheetViewer.prototype.buildMappings=function(){this.getElement()},SongBookSheetZoomController.CONTROLLER_MARGIN=5,SongBookSheetZoomController.PLACEHOLD_BOLDER=4,SongBookSheetZoomController.CONTROLLER_MOVE=function(t){return function(e){if(t.isEnabled()){var o=$(this).parent().offset(),r=e.pageX-o.left,n=(e.pageY,o.top,t.getElement()),i=t.getZoomContainerElement(),u=t.getPlaceHoldElement(),s=u.width(),g=n.width(),a=r-s/2;a<SongBookSheetZoomController.CONTROLLER_MARGIN?a=SongBookSheetZoomController.CONTROLLER_MARGIN:a+s>g&&(a=g-s-SongBookSheetZoomController.CONTROLLER_MARGIN-SongBookSheetZoomController.PLACEHOLD_BOLDER);var p=r/g*100;u.css("left",a+"px"),i.css("background-position",p+"% center")}}},SongBookSheetZoomController.prototype.getSheetViewer=function(){return this.sheetViewer},SongBookSheetZoomController.prototype.isEnabled=function(){return 1==this.enabled},SongBookSheetZoomController.prototype.disable=function(){return this.getElement().addClass("disabled"),this.enabled=!1,this},SongBookSheetZoomController.prototype.enable=function(){return this.getElement().removeClass("disabled"),this.enabled=!0,this},SongBookSheetZoomController.prototype.toggle=function(){return this.isEnabled()?this.disable():this.enable(),this},SongBookSheetZoomController.prototype.getElement=function(){return null==this.element&&(this.element=this.getSheetViewer().getElement().find("div.zoom-controller")),this.element},SongBookSheetZoomController.prototype.getPlaceHoldElement=function(){return null==this.placeHoldElement&&(this.placeHoldElement=this.getElement().find("div.zoom-placehold")),this.placeHoldElement},SongBookSheetZoomController.prototype.getPlaceHoldDelimiterElement=function(){return null==this.placeHoldDeimiterElement&&(this.placeHoldDeimiterElement=this.getElement().find("div.zoom-placehold-delimiter")),this.placeHoldDeimiterElement},SongBookSheetZoomController.prototype.getZoomContainerElement=function(){return null==this.zoomContainerElement&&(this.zoomContainerElement=this.getElement().find("div.zoom-container")),this.zoomContainerElement},SongBookSheetZoomController.prototype.update=function(t){this.getSheetViewer().getDisplayImageElement().height();return this.getZoomContainerElement().css("background-image","url('"+t+"')"),this},SongBookSheetZoomController.prototype.buildMappings=function(){this.getElement().on("mousemove",SongBookSheetZoomController.CONTROLLER_MOVE(this))};var SongBookSplash={},SongBookWindowControls={element:null,currentData:null};SongBookWindowControls.CONTROLS={minimize:function(){return void 0!=window.ELECTRON&&window.ELECTRON.remote.BrowserWindow.getFocusedWindow().minimize(),!1},maxres:function(){if(void 0!=window.ELECTRON){var t=window.ELECTRON.remote.BrowserWindow.getFocusedWindow(),e=SongBookWindowControls.getMaxResButtonElement();t.isMaximized()?(e.removeClass("restore"),e.addClass("maximize"),t.unmaximize()):(e.addClass("restore"),e.removeClass("maximize"),t.maximize())}return!1},close:function(){return void 0!=window.ELECTRON&&window.ELECTRON.remote.BrowserWindow.getFocusedWindow().close(),!1},focuslogin:function(){if(void 0!=window.ELECTRON){var t=window.ELECTRON.remote.BrowserWindow.fromId(2);void 0!=t&&null!=t&&t.focus()}return!1},chooseAccount:function(){if(void 0!=window.ELECTRON){var t=window.ELECTRON.remote,e=(window.ELECTRON_PATH,t.BrowserWindow.fromId(1)),o=new(0,t.BrowserWindow)({width:450,height:600,backgroundColor:"#fff",frame:!1});SongBookWindowControls.getLoginDialogElement().show(),o.loadURL("https://accounts.google.com/Logout"),o.focus();var r=o.webContents;r.on("did-stop-loading",function(){var t=r.getURL();SongBookWindowControls.isLoginUrl(t)||(e.webContents.send("success-login"),o.close())})}return!1}},SongBookWindowControls.getElement=function(){return this.element},SongBookWindowControls.getMinimizeButtonElement=function(){return this.getElement().find("a.button.minimize")},SongBookWindowControls.getMaxResButtonElement=function(){return this.getElement().find("a.button.max-res")},SongBookWindowControls.getCloseButtonElement=function(){return this.getElement().find("a.button.close")},SongBookWindowControls.getAccountSelectElement=function(){return this.getElement().find("span.account-select")},SongBookWindowControls.getLoginDialogElement=function(){return jQuery("div.login-dialog")},SongBookWindowControls.isLoginUrl=function(t){return-1==t.indexOf("https://myaccount.google.com")},SongBookWindowControls.getParameterByName=function(t,e){e||(e=window.location.href),t=t.replace(/[\[\]]/g,"\\$&");var o=new RegExp("[?&]"+t+"(=([^&#]*)|&|#|$)").exec(e);return o?o[2]?decodeURIComponent(o[2].replace(/\+/g," ")):"":null},SongBookWindowControls.checkLoginRedirect=function(t){var e=SongBookWindowControls.getParameterByName("skipMenu"),o=SongBookWindowControls.getParameterByName("music");void 0==o&&(o=1),document.location.href="true"==e?"songbook.html?logged=1&skipMenu=true&music="+o:"home.html?logged=1"},SongBookWindowControls.build=function(){this.element=jQuery("div.window-title-bar");var t=jQuery("body");this.getMinimizeButtonElement().click(SongBookWindowControls.CONTROLS.minimize),this.getMaxResButtonElement().click(SongBookWindowControls.CONTROLS.maxres),this.getCloseButtonElement().click(SongBookWindowControls.CONTROLS.close),this.getAccountSelectElement().click(SongBookWindowControls.CONTROLS.chooseAccount),void 0!=window.ELECTRON&&(t.addClass("title-window"),window.ELECTRON.ipcRenderer.on("success-login",function(t){SongBookWindowControls.checkLoginRedirect()}),"1"!=SongBookWindowControls.getParameterByName("logged")&&(this.getLoginDialogElement().show(),this.getLoginDialogElement().click(SongBookWindowControls.CONTROLS.focuslogin)))};

function SongBook(t){this.configuration=new SongBookConfiguration(this,t),this.name=this.getConfiguration().getName(),this.element=null,this.updateName(),this.getElement(),this.musicList=new SongBookMusicList(this),this.musicPanel=new SongBookMusicPanel(this),this.songBookPlayer=new SongBookPlayer(this),this.populateSongbookInfo(),this.debugger=new SongBookDebugger(this),this.sheetReviewer=new SongBookSheetReviewer(this),this.buildMappings()}SongBook.WINDOW_RESIZE_HANDLER=function(t){return function(){var e=window.innerHeight;e<=793?(t.getPlayer().setPlayerSize(SongBookPlayer.SMALL_PLAYER_SIZE),t.getDebugger().setSize(SongBookPlayer.SMALL_PLAYER_SIZE)):e>=794&&e<=917?(t.getPlayer().setPlayerSize(SongBookPlayer.MEDIUM_PLAYER_SIZE),t.getDebugger().setSize(SongBookPlayer.MEDIUM_PLAYER_SIZE)):(t.getPlayer().setPlayerSize(SongBookPlayer.FULLHD_PLAYER_SIZE),t.getDebugger().setSize(SongBookPlayer.FULLHD_PLAYER_SIZE))}},SongBook.prototype.getConfiguration=function(){return this.configuration},SongBook.prototype.getDebugger=function(){return this.debugger},SongBook.prototype.getSheetReviewer=function(){return this.sheetReviewer},SongBook.prototype.getName=function(){return this.name},SongBook.prototype.getPlayer=function(){return this.songBookPlayer},SongBook.prototype.getMusicList=function(){return this.musicList},SongBook.prototype.getMusicPanel=function(){return this.musicPanel},SongBook.prototype.getElement=function(){return null==this.element&&(this.element=jQuery("div.smb7-songbook[name='"+this.getName()+"']")),this.element},SongBook.prototype.getBookLogoElement=function(){return this.getElement().find("div.book-logo img")},SongBook.prototype.getFirstMusicElement=function(){return this.getElement().find("ul.smb7-music-list li:first")},SongBook.prototype.getLastMusicElement=function(){return this.getElement().find("ul.smb7-music-list li:last")},SongBook.prototype.getBookContentsElement=function(){return this.getElement().find("div.smb7-songbook.book-contents")},SongBook.prototype.getMusicNameElement=function(){return this.getElement().find("div.smb7-music-name")},SongBook.prototype.getMusicNameHeaderElement=function(){return this.getMusicNameElement().find("h1")},SongBook.prototype.getMenuButtonElement=function(){return this.getElement().find("div.smb7-menu-placeholder a.smb7-menu-button")},SongBook.prototype.getHomeButtonElement=function(){return this.getElement().find("div.smb7-menu-placeholder a.smb7-home-button")},SongBook.prototype.getPlayButtonElement=function(){return this.getElement().find("div.smb7-control-buttons a.button.play")},SongBook.prototype.getPauseButtonElement=function(){return this.getElement().find("div.smb7-control-buttons a.button.paused")},SongBook.prototype.getStopButtonElement=function(){return this.getElement().find("div.smb7-control-buttons a.button.stop")},SongBook.prototype.getRepeatButtonElement=function(){return this.getElement().find("div.smb7-control-buttons a.button.repeat")},SongBook.prototype.getMenuElement=function(){return this.getElement().find("div.samba7-menu")},SongBook.prototype.getPlayerContainerElement=function(){return this.getElement().find("div.samba7-player")},SongBook.prototype.isPlaying=function(){return!1},SongBook.prototype.updateName=function(){return jQuery("div.smb7-songbook").attr("name",this.getName()),this},SongBook.prototype.getSelectedMusic=function(){return this.getMusicList().getSelectedMusic()},SongBook.prototype.getMusic=function(t){return this.getMusicList().get(t)},SongBook.prototype.toggleMenu=function(){var t=this.getMenuElement();return t.hasClass("open")?t.removeClass("open"):t.addClass("open"),this},SongBook.prototype.goToHome=function(){return document.location.href=SONGBOOK_CONFIG.homeUrl,this},SongBook.prototype.stop=function(){return this.getPlayer().stop(),this},SongBook.prototype.play=function(){return this.getPlayer().isPlaying()?this.getPlayer().pause():this.getPlayer().play(),this},SongBook.prototype.checkButtonsState=function(){var t=this.getPlayButtonElement(),e=this.getStopButtonElement();return e.removeClass("selected"),t.removeClass("paused"),t.removeClass("selected"),this.getPlayer().isPlaying()?(t.addClass("paused"),t.addClass("selected")):this.getPlayer().isPaused()?(t.removeClass("paused"),t.addClass("selected")):this.getPlayer().isStopped()&&e.addClass("selected"),this},SongBook.prototype.toggleRepeat=function(){var t=this.getRepeatButtonElement();return this.getPlayer().isRepeating()?(t.removeClass("selected"),this.getPlayer().setRepeat(!1)):(t.addClass("selected"),this.getPlayer().setRepeat(!0)),this},SongBook.prototype.getPartByTime=function(t){var e=this,o=this.getPlayer(),n=this.getSelectedMusic(),i=n.getSelectedPart(),r=e.getPlayer().getSheetViewer();if(void 0!=i)return r.setLastPartNumber(i.getNumber()),n.eachPart(function(e){var n=e.getNormalSyncStartTime(),r=e.getNormalSyncEndTime(),s=e.getSlowSyncStartTime(),u=e.getSlowSyncEndTime();return t>=n&&t<=r?(i=e,o.setPlaySpeedType(SongBookPlayer.PLAY_NORMAL_SPEED_TYPE),o.updateButtons(),!1):t>=s&&t<=u?(i=e,o.setPlaySpeedType(SongBookPlayer.PLAY_SLOW_SPEED_TYPE),o.updateButtons(),!1):void 0}),i},SongBook.prototype.selectPartByTime=function(t){var e=this.getPartByTime(t);return void 0==e?this:(this.getSelectedMusic().getPartList().clearSelectedPart(),e.setSelected(!0),this)},SongBook.prototype.populateSongbookInfo=function(){var t=this;return this.getMusicList().create(),this.getMusicList().eachMusic(function(e){var o=t.getConfiguration().getMusic(e.getNumber());e.setName(o.getName()),e.setYoutubeUrl(o.getYoutubeUrl())}),this},SongBook.prototype.updateInfo=function(){var t=this.getSelectedMusic();if(void 0!=t){var e=t.getNumber();null==e&&(e=1);var o=t.getName(),n=t.getTonality();this.getMusicNameHeaderElement().text(o+" ("+n+")"),this.getPlayer().playVideoById(t.getYoutubeUrl())}return this},SongBook.prototype.buildMappings=function(){var t=this;this.getMenuButtonElement().click(function(){return t.toggleMenu(),!1}),this.getHomeButtonElement().click(function(){return t.goToHome(),!1}),this.getPlayButtonElement().click(function(){return t.play(),!1}),this.getStopButtonElement().click(function(){return t.stop(),!1}),this.getRepeatButtonElement().click(function(){return t.toggleRepeat(),!1});var e=this.getParameterByName("music");null==e&&(e=1);var o=SongBook.WINDOW_RESIZE_HANDLER(this);jQuery(window).on("resize",o);var n=this.getMusic(e);void 0!=n&&n.select(),"function"==typeof o&&o()},SongBook.prototype.createPlayer=function(t){return this.songBookPlayer.create(t),this},SongBook.prototype.getParameterByName=function(t,e){e||(e=window.location.href),t=t.replace(/[\[\]]/g,"\\$&");var o=new RegExp("[?&]"+t+"(=([^&#]*)|&|#|$)").exec(e);return o?o[2]?decodeURIComponent(o[2].replace(/\+/g," ")):"":null};
function SongBookConfiguration(o,t){Map.call(this,t),this.songBook=o,this.version=null,this.name=null,this.fullname=null,this.debug=null,this.getVersion(),this.getName(),this.getFullName(),this.isDebugging(),this.musicMap=this.buildMusicMap()}SongBookConfiguration.prototype=Object.create(Map.prototype),SongBookConfiguration.prototype.constructor=SongBookConfiguration,SongBookConfiguration.prototype.getSongBook=function(){return this.songBook},SongBookConfiguration.prototype.getVersion=function(){return null==this.version&&(this.version=this.get("version")),this.version},SongBookConfiguration.prototype.getName=function(){return null==this.name&&(this.name=this.get("name")),this.name},SongBookConfiguration.prototype.getFullName=function(){return null==this.fullname&&(this.fullname=this.get("fullname")),this.fullname},SongBookConfiguration.prototype.isDebugging=function(){return null==this.debug&&(this.debug=this.get("debug")),1==this.debug},SongBookConfiguration.prototype.buildMusicMap=function(){var o=this,t=new Map;return this.eachOf("musicList",function(n,i){var e=new SongBookMusicConfig(o,n,i);t.put(n,e)}),t},SongBookConfiguration.prototype.getMusicMap=function(){return this.musicMap},SongBookConfiguration.prototype.getMusic=function(o){return this.getMusicMap().get(o)};
function SongBookMusicConfig(t,o,i){Map.call(this,i),this.configuration=t,this.number=o,this.name=null,this.composer=null,this.tonality=null,this.spotifyLink=null,this.openLink=null,this.youtubeUrl=null,this.sheetStartTime=null,this.sheetEndTime=null,this.syncLastBar=null,this.getName(),this.getComposer(),this.getTonality(),this.getSpotifyLink(),this.getOpenLink(),this.getYoutubeUrl(),this.getSheetStartTime(),this.getSheetEndTime(),this.getSyncLastBar(),this.partMap=this.buildPartMap()}SongBookMusicConfig.prototype=Object.create(Map.prototype),SongBookMusicConfig.prototype.constructor=SongBookMusicConfig,SongBookMusicConfig.SYNC_PREFIX="syncData",SongBookMusicConfig.SYNC_PARTS_PREFIX="parts",SongBookMusicConfig.prototype.getConfigMirror=function(){var t=this.getConfiguration(),o=this.getNumber();return t.getMusic(o)},SongBookMusicConfig.prototype.getConfiguration=function(){return this.configuration},SongBookMusicConfig.prototype.getNumber=function(){return null==this.number&&(this.number=0),this.number},SongBookMusicConfig.prototype.setNumber=function(t){return this.number=t,this},SongBookMusicConfig.prototype.getName=function(){return null==this.name&&(this.name=this.get("name")),this.name},SongBookMusicConfig.prototype.getComposer=function(){return null==this.composer&&(this.composer=this.get("composer")),this.composer},SongBookMusicConfig.prototype.getTonality=function(){return null==this.tonality&&(this.tonality=this.get("tonality")),this.tonality},SongBookMusicConfig.prototype.getSpotifyLink=function(){return null==this.spotifyLink&&(this.spotifyLink=this.get("spotify_permalink")),this.spotifyLink},SongBookMusicConfig.prototype.getOpenLink=function(){return null==this.openLink&&(this.openLink=this.get("open_permalink")),this.openLink},SongBookMusicConfig.prototype.getYoutubeUrl=function(){return null==this.youtubeUrl&&(this.youtubeUrl=this.get("youtubeUrl")),this.youtubeUrl},SongBookMusicConfig.prototype.getSheetStartTime=function(){return this.sheetStartTime=this.get("sheetStart"),void 0==this.sheetStartTime&&(this.sheetStartTime=0),"string"==typeof this.sheetStartTime&&(this.sheetStartTime=1*this.sheetStartTime),this.sheetStartTime},SongBookMusicConfig.prototype.setSheetStartTime=function(t){return this.sheetStartTime=t,this.put("sheetStart",t),void 0!=this.getConfigMirror()&&(this.getConfigMirror().sheetStartTime=t,this.getConfigMirror().put("sheetStart",t)),this},SongBookMusicConfig.prototype.getSheetEndTime=function(){return this.sheetEndTime=this.get("sheetEnd"),void 0==this.sheetEndTime&&(this.sheetEndTime=999999),"string"==typeof this.sheetEndTime&&(this.sheetEndTime=1*this.sheetEndTime),this.sheetEndTime},SongBookMusicConfig.prototype.setSheetEndTime=function(t){return this.sheetEndTime=t,this.put("sheetEnd",t),void 0!=this.getConfigMirror()&&(this.getConfigMirror().sheetEndTime=t,this.getConfigMirror().put("sheetEnd",t)),this},SongBookMusicConfig.prototype.getSyncLastBar=function(){return this.syncLastBar=this.get(SongBookMusicConfig.SYNC_PREFIX+".lastBar"),void 0==this.syncLastBar&&(this.syncLastBar=0),this.syncLastBar},SongBookMusicConfig.prototype.setSyncLastBar=function(t){return this.syncLastBar=t,this.put(SongBookMusicConfig.SYNC_PREFIX+".lastBar",t),void 0!=this.getConfigMirror()&&(this.getConfigMirror().syncLastBar=t,this.getConfigMirror().put(SongBookMusicConfig.SYNC_PREFIX+".lastBar",t)),this},SongBookMusicConfig.prototype.buildPartMap=function(){var t=this,o=new Map;return this.eachOf(SongBookMusicConfig.SYNC_PARTS_PREFIX,function(i,n){var e=new SongBookMusicPartConfig(t,i,n);o.put(i,e)}),o},SongBookMusicConfig.prototype.getPartMap=function(){return this.partMap},SongBookMusicConfig.prototype.getPart=function(t){return this.getPartMap().get(t)},SongBookMusicConfig.prototype.addPart=function(t,o){return this.getPartMap().put(t,o),this},SongBookMusicConfig.prototype.removePart=function(t){return this.getPartMap().remove(t),this},SongBookMusicConfig.prototype.eachSpeed=function(t,o){return"function"!=typeof o?this:(this.eachOf(SongBookMusicConfig.SYNC_PREFIX+"."+t,function(t,i){o.call(this,{label:t})}),this)},SongBookMusicConfig.prototype.eachPart=function(t){return"function"!=typeof t?this:(this.getPartMap().each(function(o,i){t.call(this,o,i)}),this)};
function SongBookMusicBarConfig(t,i,o,r){void 0==r&&(r=[]),this.data=r,this.partConfig=t,this.number=o,this.startTime=null,this.endTime=null,this.customLineBars=null,this.speed=i,this.getStartTime(),this.getEndTime(),this.getCustomLineBars()}SongBookMusicBarConfig.prototype.getConfigMirror=function(){var t=this.getPartConfig().getMusicConfig().getConfiguration(),i=this.getPartConfig().getMusicConfig().getNumber(),o=this.getPartConfig().getNumber(),r=this.getNumber();return t.getMusic(i).getPart(o).getBar(this.getSpeed(),r)},SongBookMusicBarConfig.prototype.getSpeed=function(){return this.speed},SongBookMusicBarConfig.prototype.getNumber=function(){return null==this.number&&(this.number=0),this.number},SongBookMusicBarConfig.prototype.setNumber=function(t){return this.number=t,this},SongBookMusicBarConfig.prototype.getPartConfig=function(){return this.partConfig},SongBookMusicBarConfig.prototype.getStartTime=function(){return null==this.startTime&&(this.startTime=this.data[0]),this.startTime},SongBookMusicBarConfig.prototype.setStartTime=function(t){return this.startTime=t,this.data[0]=t,void 0!=this.getConfigMirror()&&(this.getConfigMirror().startTime=t,this.getConfigMirror().data[0]=t),this},SongBookMusicBarConfig.prototype.getEndTime=function(){return null==this.endTime&&(this.endTime=this.data[1]),this.endTime},SongBookMusicBarConfig.prototype.setEndTime=function(t){return this.endTime=t,this.data[1]=t,void 0!=this.getConfigMirror()&&(this.getConfigMirror().endTime=t,this.getConfigMirror().data[1]=t),this},SongBookMusicBarConfig.prototype.getCustomLineBars=function(){return null==this.customLineBars&&(this.customLineBars=this.data[2]),this.customLineBars},SongBookMusicBarConfig.prototype.setCustomLineBars=function(t){return this.customLineBars=t,this.data[2]=t,void 0!=this.getConfigMirror()&&(this.getConfigMirror().customLineBars=t,this.getConfigMirror().data[2]=t),this},SongBookMusicBarConfig.prototype.hasCustomLineBars=function(){return void 0!=this.getCustomLineBars()};
function SongBookMusicPartConfig(t,o,i){Map.call(this,i),this.musicConfig=t,this.number=o,this.display=null,this.normalSeekStartTime=null,this.normalSeekEndTime=null,this.slowSeekStartTime=null,this.slowSeekEndTime=null,this.getDisplay(),this.getNormalSeekStartTime(),this.getNormalSeekEndTime(),this.getSlowSeekStartTime(),this.getSlowSeekEndTime(),this.normalBarMap=this.buildBarMap(SongBookPlayer.PLAY_NORMAL_SPEED_TYPE),this.slowBarMap=this.buildBarMap(SongBookPlayer.PLAY_SLOW_SPEED_TYPE)}SongBookMusicPartConfig.prototype=Object.create(Map.prototype),SongBookMusicPartConfig.prototype.constructor=SongBookMusicPartConfig,SongBookMusicPartConfig.prototype.getConfigMirror=function(){var t=this.getMusicConfig().getConfiguration(),o=this.getMusicConfig().getNumber(),i=this.getNumber();return t.getMusic(o).getPart(i)},SongBookMusicPartConfig.prototype.getNumber=function(){return null==this.number&&(this.number=0),this.number},SongBookMusicPartConfig.prototype.setNumber=function(t){return this.number=t,this},SongBookMusicPartConfig.prototype.getMusicConfig=function(){return this.musicConfig},SongBookMusicPartConfig.prototype.getDisplay=function(){return null==this.display&&(this.display=this.get("display")),this.display},SongBookMusicPartConfig.prototype.setDisplay=function(t){return this.display=t,this.put("display",t),void 0!=this.getConfigMirror()&&(this.getConfigMirror().display=t,this.getConfigMirror().put("display",t)),this},SongBookMusicPartConfig.prototype.getNormalSeekStartTime=function(){return this.normalSeekStartTime=this.get("timeToSeek.normal.start"),this.normalSeekStartTime},SongBookMusicPartConfig.prototype.setNormalSeekStartTime=function(t){return this.normalSeekStartTime=t,this.put("timeToSeek.normal.start",t),void 0!=this.getConfigMirror()&&(this.getConfigMirror().normalSeekStartTime=t,this.getConfigMirror().put("timeToSeek.normal.start",t)),this},SongBookMusicPartConfig.prototype.getNormalSeekEndTime=function(){return this.normalSeekEndTime=this.get("timeToSeek.normal.end"),this.normalSeekEndTime},SongBookMusicPartConfig.prototype.setNormalSeekEndTime=function(t){return this.normalSeekEndTime=t,this.put("timeToSeek.normal.end",t),void 0!=this.getConfigMirror()&&(this.getConfigMirror().normalSeekEndTime=t,this.getConfigMirror().put("timeToSeek.normal.end",t)),this},SongBookMusicPartConfig.prototype.getSlowSeekStartTime=function(){return this.slowSeekStartTime=this.get("timeToSeek.slow.start"),this.slowSeekStartTime},SongBookMusicPartConfig.prototype.setSlowSeekStartTime=function(t){return this.slowSeekStartTime=t,this.put("timeToSeek.slow.start",t),void 0!=this.getConfigMirror()&&(this.getConfigMirror().slowSeekStartTime=t,this.getConfigMirror().put("timeToSeek.slow.start",t)),this},SongBookMusicPartConfig.prototype.getSlowSeekEndTime=function(){return this.slowSeekEndTime=this.get("timeToSeek.slow.end"),this.slowSeekEndTime},SongBookMusicPartConfig.prototype.setSlowSeekEndTime=function(t){return this.slowSeekEndTime=t,this.put("timeToSeek.slow.end",t),void 0!=this.getConfigMirror()&&(this.getConfigMirror().slowSeekEndTime=t,this.getConfigMirror().put("timeToSeek.slow.end",t)),this},SongBookMusicPartConfig.prototype.buildBarMap=function(t){var o=this,i=new Map;return this.getMusicConfig().eachOf("syncData.parts."+t+"."+this.getNumber(),function(e,r){var n=new SongBookMusicBarConfig(o,t,e,r);n.setNumber(e),i.put(e,n)}),i},SongBookMusicPartConfig.prototype.getNormalBarMap=function(){return this.normalBarMap},SongBookMusicPartConfig.prototype.getSlowBarMap=function(){return this.slowBarMap},SongBookMusicPartConfig.prototype.addBar=function(t,o,i){return(i==SongBookPlayer.PLAY_NORMAL_SPEED_TYPE?this.getNormalBarMap():this.getSlowBarMap()).put(t,new SongBookMusicBarConfig(o,i,t)),this},SongBookMusicPartConfig.prototype.removeBar=function(t,o){return(o==SongBookPlayer.PLAY_NORMAL_SPEED_TYPE?this.getNormalBarMap():this.getSlowBarMap()).remove(t),this},SongBookMusicPartConfig.prototype.getBar=function(t,o){return t==SongBookPlayer.PLAY_NORMAL_SPEED_TYPE?this.getNormalBarMap().get(o):t==SongBookPlayer.PLAY_SLOW_SPEED_TYPE?this.getSlowBarMap().get(o):void 0},SongBookMusicPartConfig.prototype.eachBar=function(t,o,i){if("function"!=typeof i)return this;(o==SongBookPlayer.PLAY_NORMAL_SPEED_TYPE?this.getNormalBarMap():this.getSlowBarMap()).each(function(t,o){return i.call(this,t,o)})};
function SongBookDebugger(t){this.songbook=t,this.modified=!1,this.editing=!1,this.syncStarted=!1,this.element=null,this.size=null,this.outputManager=new DebuggerOutputManager(this),this.messenger=new DebuggerMessenger(this),this.buildMappings()}SongBookDebugger.SYNC_REWIND_OFFSET=3,SongBookDebugger.HOTKEYS={space:function(t){var e=t.getSongBook().getPlayer();return function(i){if(e.isPlaying()?e.pause():e.play(),t.isEditing())return t.isSyncStarted()||(t.setSyncStarted(!0),t.getMessenger().showMessage("002",!0)),!1}},backspace:function(t){return function(e){if(t.isDebugging()){var i=t.getSongBook().getPlayer();return t.isEditing()&&t.isSyncStarted()&&!i.isPaused()&&t.syncBack(),!1}}},tab:function(t){return function(e){if(t.isDebugging()){var i=t.getSongBook().getPlayer();return t.isEditing()&&t.isSyncStarted()&&!i.isPaused()&&t.syncFoward(),!1}}},"shift+p":function(t){return function(e){if(t.isDebugging())return t.isEditing()&&t.createSyncPart(),!1}},"shift+b":function(t){return function(e){if(t.isDebugging())return t.isEditing()&&t.createSyncBar(),!1}},"alt+shift+b":function(t){return function(e){if(t.isDebugging())return t.isEditing()&&t.createSyncBar(!1),!1}},"alt+1":function(t){return function(e){if(t.isDebugging())return t.isEditing()&&t.updateBarLines(1),t.isReview()&&t.setReviewCompassNumber(1),!1}},"alt+2":function(t){return function(e){if(t.isDebugging())return t.isEditing()&&t.updateBarLines(2),t.isReview()&&t.setReviewCompassNumber(2),!1}},"alt+3":function(t){return function(e){if(t.isDebugging())return t.isEditing()&&t.updateBarLines(3),t.isReview()&&t.setReviewCompassNumber(3),!1}},"alt+4":function(t){return function(e){if(t.isDebugging())return t.isEditing()&&t.updateBarLines(4),t.isReview()&&t.setReviewCompassNumber(4),!1}},"alt+5":function(t){return function(e){if(t.isDebugging())return t.isEditing()&&t.updateBarLines(5),t.isReview()&&t.setReviewCompassNumber(5),!1}},"alt+6":function(t){return function(e){if(t.isDebugging())return t.isEditing()&&t.updateBarLines(6),t.isReview()&&t.setReviewCompassNumber(6),!1}},"alt+7":function(t){return function(e){if(t.isDebugging())return t.isEditing()&&t.updateBarLines(7),t.isReview()&&t.setReviewCompassNumber(7),!1}},"alt+8":function(t){return function(e){if(t.isDebugging())return t.isEditing()&&t.updateBarLines(8),t.isReview()&&t.setReviewCompassNumber(8),!1}},"alt+9":function(t){return function(e){if(t.isDebugging())return t.isEditing()&&t.updateBarLines(9),t.isReview()&&t.setReviewCompassNumber(9),!1}},del:function(t){return function(e){if(t.isDebugging())return t.isEditing()&&t.deleteSelectedOutput(),!1}},right:function(t){return function(e){if(t.isDebugging())return t.navigateRight(),!1}},left:function(t){return function(e){if(t.isDebugging())return t.navigateLeft(),!1}},up:function(t){return function(e){if(t.isDebugging())return t.navigateUp(),!1}},"ctrl+up":function(t){return function(e){if(t.isDebugging())return t.navigateToTop(),!1}},down:function(t){return function(e){if(t.isDebugging())return t.navigateDown(),!1}},"ctrl+down":function(t){return function(e){if(t.isDebugging())return t.navigateToBottom(),!1}},"ctrl+return":function(t){return function(e){if(t.isDebugging())return t.isEditing()&&t.splitParts(),!1}}},SongBookDebugger.prototype.getSongBook=function(){return this.songbook},SongBookDebugger.prototype.getOutputManager=function(){return this.outputManager},SongBookDebugger.prototype.getMessenger=function(){return this.messenger},SongBookDebugger.prototype.getElement=function(){return null==this.element&&(this.element=this.getSongBook().getElement().find("div.smb7-debugger-container")),this.element},SongBookDebugger.prototype.getSpeedElements=function(){return this.getElement().find("ul.smb7-debugger li.speed-type:not(.initial-tree)")},SongBookDebugger.prototype.getFirstSpeedElement=function(){return this.getElement().find("ul.smb7-debugger li.speed-type:first")},SongBookDebugger.prototype.getLastSpeedElement=function(){return this.getElement().find("ul.smb7-debugger li.speed-type:last")},SongBookDebugger.prototype.getFirstPartElement=function(t){return void 0==t&&(t=this.getElement().find("ul.music-parts:first")),t.find("li.music-part:first")},SongBookDebugger.prototype.getFirstPartElements=function(){return this.getElement().find("ul.music-parts li.music-part:first-child")},SongBookDebugger.prototype.getLastPartElement=function(t){return void 0==t&&(t=this.getElement().find("ul.music-parts:first")),t.find("li.music-part:last")},SongBookDebugger.prototype.getPartLogElements=function(){return this.getElement().find("ul.smb7-music-parts li.part:not(.initial-tree)")},SongBookDebugger.prototype.getFirstPartLogElement=function(){return this.getElement().find("ul.smb7-music-parts li.part:first")},SongBookDebugger.prototype.getLastPartLogElement=function(){return this.getElement().find("ul.smb7-music-parts li.part:last")},SongBookDebugger.prototype.getFirstBarElement=function(t){return void 0==t&&(t=this.getElement().find("ul.music-bars:first")),t.find("li.music-bar:first")},SongBookDebugger.prototype.getFirstBarElements=function(){return this.getElement().find("ul.music-bars li.music-bar:first-child")},SongBookDebugger.prototype.getLastBarElement=function(t){return void 0==t&&(t=this.getElement().find("ul.music-bars:first")),t.find("li.music-bar:last")},SongBookDebugger.prototype.getSheetStartTimeElement=function(){return this.getElement().find("div.sheet-limits em.sheet-start-time")},SongBookDebugger.prototype.getSheetEndTimeElement=function(){return this.getElement().find("div.sheet-limits em.sheet-end-time")},SongBookDebugger.prototype.getEditButtonElement=function(){return this.getElement().find("a.edit-button")},SongBookDebugger.prototype.getReviewButtonElement=function(){return this.getElement().find("a.review-button")},SongBookDebugger.prototype.isModified=function(){return 1==this.modified},SongBookDebugger.prototype.setModified=function(t){return this.modified=t,this},SongBookDebugger.prototype.isEditing=function(){return 1==this.editing},SongBookDebugger.prototype.setEditing=function(t){return this.editing=t,this.isEditing()?(this.getEditButtonElement().addClass("enabled"),this.getOutputManager().startEditing()):(this.getEditButtonElement().removeClass("enabled"),this.setSyncStarted(!1),this.getOutputManager().stopEditing()),this},SongBookDebugger.prototype.toggleEditing=function(){return this.isEditing()?this.setEditing(!1):this.setEditing(!0),this},SongBookDebugger.prototype.isReview=function(){return 1==this.review},SongBookDebugger.prototype.setReview=function(t){return this.review=t,this.isReview()?(this.getReviewButtonElement().addClass("enabled"),this.getSongBook().getPlayer().getElement().addClass("review-mode"),this.getOutputManager().startReview()):(this.getReviewButtonElement().removeClass("enabled"),this.getSongBook().getPlayer().getElement().removeClass("review-mode"),this.getOutputManager().stopReview()),this},SongBookDebugger.prototype.toggleReview=function(){return this.isReview()?this.setReview(!1):this.setReview(!0),this},SongBookDebugger.prototype.isSyncStarted=function(){return 1==this.syncStarted},SongBookDebugger.prototype.setSyncStarted=function(t){return this.syncStarted=t,this},SongBookDebugger.prototype.isDebugging=function(){return this.getSongBook().getConfiguration().isDebugging()},SongBookDebugger.prototype.setSize=function(t){return this.size=t,this.getElement().removeClass(SongBookPlayer.SMALL_PLAYER_SIZE),this.getElement().removeClass(SongBookPlayer.MEDIUM_PLAYER_SIZE),this.getElement().removeClass(SongBookPlayer.FULLHD_PLAYER_SIZE),this.getElement().addClass(t),this},SongBookDebugger.prototype.addDebuggingClasses=function(){this.getSongBook().getPlayer().getElement().addClass("debugging"),this.getElement().addClass("enabled")},SongBookDebugger.prototype.resetOutput=function(){this.getSpeedElements().remove(),this.getPartLogElements().remove(),this.getSheetStartTimeElement().text(""),this.getSheetEndTimeElement().text("")},SongBookDebugger.prototype.createSpeedOutput=function(t){var e=this.getFirstSpeedElement(),i=(this.getLastSpeedElement(),e.clone());return i.attr("value",t),i.find("span.speed-type-label em.speed").text(t),i.removeClass("initial-tree"),this.getOutputManager().addSpeed(t,i),i},SongBookDebugger.prototype.createPartOutput=function(t,e,i,n){var r,o,g=this.getFirstPartElement(i).clone();return n==SongBookPlayer.PLAY_NORMAL_SPEED_TYPE?(r=e.getNormalSeekStartTime(),o=e.getNormalSeekEndTime()):(r=e.getSlowSeekStartTime(),o=e.getSlowSeekEndTime()),g.find("span.part-times em.part-start").text(r),g.find("span.part-times em.part-end").text(o),g.find("span.music-part-label em.value").text(t),g.removeClass("initial-tree"),this.getOutputManager().addPart(n,e,g),g},SongBookDebugger.prototype.createPartLogOutput=function(t,e){var i,n,r,o,g=this.getFirstPartLogElement().clone();return i=e.getNormalSeekStartTime(),n=e.getNormalSeekEndTime(),r=e.getSlowSeekStartTime(),o=e.getSlowSeekEndTime(),g.attr("partNumber",t),g.find("em.number").text(t),g.find("em.ns").text(i),g.find("em.ne").text(n),g.find("em.ss").text(r),g.find("em.se").text(o),g.removeClass("initial-tree"),this.getOutputManager().addPartLog(e,g),g},SongBookDebugger.prototype.createBarOutput=function(t,e,i,n,r){var o=this.getFirstBarElement(r).clone();return o.find("em.number").text(t),o.find("em.start").text(i.getStartTime()),o.find("em.end").text(i.getEndTime()),o.removeClass("initial-tree"),this.getOutputManager().addBar(n,e,i,o),o},SongBookDebugger.prototype.updateOutput=function(){this.resetOutput();this.getSongBook().getConfiguration();var t=this.getSongBook().getSelectedMusic().getNumber(),e=this.getSongBook().getConfiguration().getMusic(t),i=this;return i.getOutputManager().reset(),i.getOutputManager().setSheetStartTime(e.getSheetStartTime()),i.getOutputManager().setSheetEndTime(e.getSheetEndTime()),e.eachSpeed(SongBookSheetViewer.PART_TYPE,function(t){var n=i.getLastSpeedElement(),r=t.label,o=i.createSpeedOutput(r);e.eachPart(function(t,e){var n,g=i.getLastPartElement(o),u=i.getLastPartLogElement(),s=i.createPartOutput(t,e,o,r);r==SongBookPlayer.PLAY_NORMAL_SPEED_TYPE&&(n=i.createPartLogOutput(t,e)),e.eachBar(SongBookSheetViewer.PART_TYPE,r,function(t,n){var o=i.getLastBarElement(s);i.createBarOutput(t,e,n,r,s).insertAfter(o)}),s.insertAfter(g),r==SongBookPlayer.PLAY_NORMAL_SPEED_TYPE&&n.insertAfter(u)}),o.insertAfter(n)}),this.getOutputManager().checkLastOutputs(),this},SongBookDebugger.prototype.selectBarOutput=function(t,e){this.getOutputManager().selectBarOutput(t,e)},SongBookDebugger.prototype.bindHotKeys=function(){var t=SongBookDebugger.HOTKEYS;for(var e in t){var i=t[e];jQuery(document).bind("keydown",e,i.call(this,this))}},SongBookDebugger.prototype.syncBack=function(){var t=this.getSongBook().getPlayer();if(t.isPlaying()){var e=this.getOutputManager(),i=e.getSelectedBarOutput();if(void 0!=i){var n=i.getPreviousBarOutput(),r=n,o=n.getPartOutput().getSpeedOutput().getSpeedLabel();if(e.selectBarOutput(n,o),i==n)return syncTime=0,i.setStartTime(0),i.setEndTime(0),i.setFirstSync(!0),t.seekTo(0),t.hideSheets(),this;syncTime=n.getBarConfig().getStartTime(),t.getSheetViewer().updateWithBarOutput(r),t.seekTo(syncTime)}}return this},SongBookDebugger.prototype.syncFoward=function(){return this.getSongBook().getPlayer().isPlaying()&&void 0!=this.getOutputManager().getSelectedBarOutput()&&this.syncFromExistentOutput(),this},SongBookDebugger.prototype.syncFromExistentOutput=function(){var t=this.getSongBook().getPlayer(),e=this.getOutputManager(),i=e.getSelectedBarOutput(),n=i,r=i.getNextBarOutput(),o=r.getSpeedOutput().getSpeedLabel(),g=t.getCurrentTime();if(e.update(g)&&(e.selectBarOutput(r,o),n=r),this.isEditing())t.getSheetViewer().updateWithBarOutput(n);else{var u=1*parseFloat(g+"").toFixed(6);t.getSheetViewer().update(u),t.checkSheetDisplayRange(u)}return this},SongBookDebugger.prototype.createSyncPart=function(){var t=this.getOutputManager();return void 0!=t.getSelectedSpeedOutput()&&t.createNewPartOutput(),this},SongBookDebugger.prototype.createSyncBar=function(t){var e=this.getOutputManager(),i=e.getSelectedPartOutput();if(void 0!=i){var n=e.createNewBarOutput(i,t);void 0!=n&&n.select()}return this},SongBookDebugger.prototype.updateBarLines=function(t){var e=this.getOutputManager().getSelectedBarOutput();return void 0!=e&&(e.setCustomLineBars(t),e.getMirror().setCustomLineBars(t)),this},SongBookDebugger.prototype.setReviewCompassNumber=function(t){var e=this.getOutputManager(),i=this.getSongBook().getSheetReviewer();return void 0!=e.getSelectedBarOutput()&&i.setCompassNumber(t),this},SongBookDebugger.prototype.deleteSelectedOutput=function(){var t=this.getOutputManager(),e=t.getSelectedBarOutput(),i=t.getSelectedPartOutput();return void 0!=e?(e.delete(),e.getMirror().delete(!0)):void 0!=i&&(i.delete(),i.getMirror().delete(!0)),this},SongBookDebugger.prototype.navigateLeft=function(){var t=this.getOutputManager(),e=t.getSelectedBarOutput(),i=t.getSelectedPartOutput();if(void 0!=e){var n=e.getPartOutput();void 0!=n&&n.select()}else if(void 0!=i){var r=i.getSpeedOutput();void 0!=r&&r.select()}return this},SongBookDebugger.prototype.navigateRight=function(){var t=this.getOutputManager(),e=t.getSelectedPartOutput(),i=t.getSelectedSpeedOutput();if(void 0!=e){var n=e.getFirstBarOutput();void 0!=n&&(n.isSelected()||n.select())}else if(void 0!=i){var r=i.getFirstPartOutput();void 0!=r&&(r.isSelected()||r.select())}return this},SongBookDebugger.prototype.navigateUp=function(){var t=this.getOutputManager(),e=t.getSelectedBarOutput(),i=t.getSelectedPartOutput(),n=t.getSelectedSpeedOutput();if(void 0!=e){var r=e.getPreviousBarOutput();void 0!=r&&r.select()}else if(void 0!=i){var o=i.getPreviousPartOutput(!0);void 0!=o&&o.select()}else if(void 0!=n){var g=n.getPreviousSpeedOutput();void 0!=g&&g.select()}return this},SongBookDebugger.prototype.navigateDown=function(){var t=this.getOutputManager(),e=t.getSelectedBarOutput(),i=t.getSelectedPartOutput(),n=t.getSelectedSpeedOutput();if(void 0!=e){var r=e.getNextBarOutput();void 0!=r&&r.select()}else if(void 0!=i){var o=i.getNextPartOutput(!0);void 0!=o&&o.select()}else if(void 0!=n){var g=n.getNextSpeedOutput();void 0!=g&&g.select()}return this},SongBookDebugger.prototype.navigateToTop=function(){var t=this.getOutputManager(),e=t.getSelectedBarOutput(),i=t.getSelectedPartOutput();if(void 0!=e){var n=e.getPartOutput().getFirstBarOutput();void 0!=n&&n.select()}else if(void 0!=i){var r=i.getSpeedOutput().getFirstPartOutput();void 0!=r&&r.select()}return this},SongBookDebugger.prototype.navigateToBottom=function(){var t=this.getOutputManager(),e=t.getSelectedBarOutput(),i=t.getSelectedPartOutput();if(void 0!=e){var n=e.getPartOutput().getLastBarOutput();void 0!=n&&n.select()}else if(void 0!=i){var r=i.getSpeedOutput().getLastPartOutput();void 0!=r&&r.select()}return this},SongBookDebugger.prototype.splitParts=function(){var t=this.getOutputManager(),e=t.getSelectedBarOutput();return void 0!=e&&t.splitParts(e),this},SongBookDebugger.prototype.scrollTo=function(t){this.getElement().clearQueue().stop(),this.getElement().scrollTo(t.getElement(),450,{offset:-280})},SongBookDebugger.prototype.buildMappings=function(){var t=this;return this.isDebugging()&&(this.addDebuggingClasses(),this.getEditButtonElement().click(function(){return t.toggleEditing(),!1}),this.getReviewButtonElement().click(function(){return t.toggleReview(),!1}),this.bindHotKeys()),this};
function DebuggerMessenger(e){this.element=null,this.debug=e}DebuggerMessenger.MESSAGES={"001":"<div class='message-type'>MODO SYNC</div>PRESSIONE A TECLA <span class='command'><em>Espa√ßo</em></span><br/>PARA CONTINUAR / PAUSAR","002":"<div class='message-type'>MODO SYNC</div>PRESSIONE <span class='command'><em>TAB</em></span> PARA SINCRONIZAR OU <span class='command'><em>BACKSPACE</em></span> PARA VOLTAR"},DebuggerMessenger.prototype.getDebugger=function(){return this.debug},DebuggerMessenger.prototype.getElement=function(){return null==this.element&&(this.element=this.getDebugger().getSongBook().getElement().find("div.smb7-debugger-messages")),this.element},DebuggerMessenger.prototype.getDialogElement=function(){return this.getElement().find("div.modal-dialog")},DebuggerMessenger.prototype.show=function(){return this.getElement().fadeIn(300),this},DebuggerMessenger.prototype.hide=function(){return this.getElement().fadeOut(300),this},DebuggerMessenger.prototype.showMessage=function(e,t){var s=this;isNaN(e)||(e=DebuggerMessenger.MESSAGES[e]),this.getDialogElement().html(e),this.show(300),1!=t&&window.setTimeout(function(){s.hide(300)},5e3)};
function DebuggerOutputManager(t){this.debug=t,this.outputMap=new Map,this.partLogMap=new Map,this.firstSync=!0,this.lastSync=!1,this.lastCreatedBarNumber=0,this.changeSheetTimes=!1}DebuggerOutputManager.prototype.setChangeSheetTimes=function(t){return this.changeSheetTimes=t,this},DebuggerOutputManager.prototype.isChangeSheetTimes=function(){return 1==this.changeSheetTimes},DebuggerOutputManager.prototype.setLastCreatedBarNumber=function(t){return this.lastCreatedBarNumber=t,this},DebuggerOutputManager.prototype.getLastCreatedBarNumber=function(){return this.lastCreatedBarNumber},DebuggerOutputManager.prototype.setFirstSync=function(t){return this.firstSync=t,this},DebuggerOutputManager.prototype.isFirstSync=function(){return 1==this.firstSync},DebuggerOutputManager.prototype.setLastSync=function(t){return this.lastSync=t,this},DebuggerOutputManager.prototype.isLastSync=function(){return 1==this.lastSync},DebuggerOutputManager.prototype.getDebugger=function(){return this.debug},DebuggerOutputManager.prototype.getSongBook=function(){return this.getDebugger().getSongBook()},DebuggerOutputManager.prototype.getOutputMap=function(){return this.outputMap},DebuggerOutputManager.prototype.getPartLogMap=function(){return this.partLogMap},DebuggerOutputManager.prototype.reset=function(){return this.outputMap=new Map,this},DebuggerOutputManager.prototype.addSpeed=function(t,e){return this.getOutputMap().put(t,new SpeedDebuggerOutput(this,t,e)),this},DebuggerOutputManager.prototype.addPart=function(t,e,r){var u=this.getOutputMap().get(t);if(void 0!=u)return u.addPart(e,r),this},DebuggerOutputManager.prototype.addPartLog=function(t,e){return this.getPartLogMap().put(t.getNumber(),new PartLogDebuggerOutput(this,t,e)),this},DebuggerOutputManager.prototype.addBar=function(t,e,r,u){var g=e.getNumber(),a=this.getOutputMap().get(t).getPartOutput(g);if(void 0!=a)return a.addBar(r,u),this},DebuggerOutputManager.prototype.getSpeedOutput=function(t){return this.getOutputMap().get(t)},DebuggerOutputManager.prototype.eachSpeedOutput=function(t){this.getOutputMap().each(function(e,r){return t.call(this,e,r)})},DebuggerOutputManager.prototype.getPartLogOutput=function(t){return this.getPartLogMap().get(t)},DebuggerOutputManager.prototype.deselectAll=function(){return this.eachSpeedOutput(function(t,e){e.deselect(),e.deselectAllParts(),e.eachPartOutput(function(t,e){e.deselectAllBars()})}),this},DebuggerOutputManager.prototype.getSelectedBarOutput=function(){var t;return this.eachSpeedOutput(function(e,r){r.eachPartOutput(function(e,r){r.eachBarOutput(function(e,r){if(r.isSelected())return t=r,!1})})}),t},DebuggerOutputManager.prototype.getSelectedPartOutput=function(){var t;return this.eachSpeedOutput(function(e,r){r.eachPartOutput(function(e,r){if(r.isSelected())return t=r,!1})}),t},DebuggerOutputManager.prototype.getSelectedSpeedOutput=function(){var t;return this.eachSpeedOutput(function(e,r){if(r.isSelected())return t=r,!1}),t},DebuggerOutputManager.prototype.getLastBarNumber=function(){var t=0;return this.eachSpeedOutput(function(e,r){r.eachPartOutput(function(e,r){r.eachBarOutput(function(e,r){t=e})})}),t},DebuggerOutputManager.prototype.selectBarByNumber=function(t,e){if(0==t)return this;var r=this.getSongBook().getSelectedMusic().getSelectedPart().getNumber(),u=this.getSpeedOutput(e),g=u.getPartOutput(r),a=g.getBarOutput(t);return this.deselectAll(),u.setSelected(!0),g.setSelected(!0),a.setSelected(!0),this.getDebugger().scrollTo(a),this},DebuggerOutputManager.prototype.selectBarByOutput=function(t,e){var r=this.getSongBook().getSelectedMusic(),u=(r.getNumber(),t.getBarConfig().getNumber(),t.getPartOutput().getNumber()),g=this.getSpeedOutput(e);if(void 0==g)return this;var a=g.getPartOutput(u);if(void 0==a)return this;var i=r.getPart(a.getNumber()),n=a.getSpeedOutput().getSpeedLabel();this.deselectAll(),g.setSelected(!0),a.setSelected(!0),this.getDebugger().isEditing()&&void 0!=i&&(songbook.getPlayer().setPlaySpeedType(n),i.select()),t.setSelected(!0),this.getDebugger().scrollTo(t)},DebuggerOutputManager.prototype.selectBarOutput=function(t,e){return isNaN(t)?this.selectBarByOutput(t,e):this.selectBarByNumber(t,e),this},DebuggerOutputManager.prototype.eachBarOutput=function(t){return"function"!=typeof t?this:(this.eachSpeedOutput(function(e,r){r.eachPartOutput(function(e,r){r.eachBarOutput(function(e,r){return t.call(this,e,r)})})}),this)},DebuggerOutputManager.prototype.checkLastOutputs=function(){return this.eachSpeedOutput(function(t,e){e.eachPartOutput(function(t,e){e.isLast()&&e.getElement().addClass("last"),e.eachBarOutput(function(t,e){e.isLast()&&e.getElement().addClass("last")})})}),this},DebuggerOutputManager.prototype.selectFirstSpeedOutput=function(){var t=this.getOutputMap().contents,e=null;for(var r in t)return(e=t[r]).select(),e;if(null==e){var u=this.createNewSpeedOutput(SongBookPlayer.PLAY_NORMAL_SPEED_TYPE);this.createNewSpeedOutput(SongBookPlayer.PLAY_SLOW_SPEED_TYPE);return u}},DebuggerOutputManager.prototype.selectFirstBarOutput=function(){var t,e,r=this.getSpeedOutput(SongBookPlayer.PLAY_NORMAL_SPEED_TYPE);return void 0!=r&&(t=r.getFirstPartOutput()),void 0!=t&&(e=t.getFirstBarOutput()),void 0!=e&&e.select(),e},DebuggerOutputManager.prototype.getSyncTimes=function(t){var e=[],r=parseFloat(t+"").toFixed(6);if("NaN"==r)return[0,0];var u=r.split("."),g=1*u[0],a=u[1],i=1*u[1],n=r,s=0;return void 0!=i?i--:g--,s=0==a.indexOf("0")?g+".0"+i:g+"."+i,e[0]=(1*s).toFixed(6),e[1]=(1*n).toFixed(6),e},DebuggerOutputManager.prototype.updatePartTimes=function(t){var e=this.getSelectedBarOutput(),r=e.getPartOutput().getSpeedOutput().getSpeedLabel(),u=this.getSongBook().getSelectedMusic(),g=e.getStartTime(),a=t[0];r==SongBookPlayer.PLAY_NORMAL_SPEED_TYPE?e.isFirst()&&this.isChangeSheetTimes()?(e.getPartOutput().setNormalStartTime(g),e.getPartLogOutput().setNormalStartTime(g),this.isFirstSync()&&this.setSheetStartTime(g)):e.isLast()&&(e.getPartOutput().setNormalEndTime(a),e.getPartLogOutput().setNormalEndTime(a)):e.isFirst()?(e.getPartOutput().setSlowStartTime(g),e.getPartLogOutput().setSlowStartTime(g)):e.isLast()&&(e.getPartOutput().setSlowEndTime(a),e.getPartLogOutput().setSlowEndTime(a),this.isLastSync()&&(u.getConfig().setSheetEndTime(a),this.setSheetEndTime(a)))},DebuggerOutputManager.prototype.update=function(t){var e=this.getSelectedBarOutput(),r=e.getPartOutput().getSpeedOutput().getSpeedLabel(),u=e.getNextBarOutput(),g=this.getSongBook().getSelectedMusic(),a=this.getSyncTimes(t),i=a[0],n=a[1],s=!0;return e.isFirst()&&r==SongBookPlayer.PLAY_NORMAL_SPEED_TYPE?e.isFirstSync()?(e.setStartTime(n),g.setSheetStartTime(n),e.setFirstSync(!1),this.setChangeSheetTimes(!0),s=!1):(e.setEndTime(i),u.setStartTime(n),e.setFirstSync(!1),u.setFirstSync(!1),this.setChangeSheetTimes(!0),s=!0):e.isLastOfSheet()&&r==SongBookPlayer.PLAY_SLOW_SPEED_TYPE?e.isFirstSync()?(e.setStartTime(n),e.setFirstSync(!1),this.setChangeSheetTimes(!1),s=!1):(e.setEndTime(i),e.setFirstSync(!1),this.setLastSync(!0),this.setChangeSheetTimes(!1),s=!0):(e.setEndTime(a[0]),u.setStartTime(a[1]),u.setFirstSync(!1),this.setChangeSheetTimes(!1),s=!0),this.updatePartTimes(a),this.setFirstSync(!1),s},DebuggerOutputManager.prototype.resetAllBarsSync=function(){this.eachBarOutput(function(t,e){e.setFirstSync(!0)})},DebuggerOutputManager.prototype.setSheetStartTime=function(t){this.getSongBook().getConfiguration();var e=this.getSongBook().getSelectedMusic().getNumber(),r=this.getSongBook().getConfiguration().getMusic(e);return this.getDebugger().getSheetStartTimeElement().text(t),r.setSheetStartTime(t),this},DebuggerOutputManager.prototype.setSheetEndTime=function(t){this.getSongBook().getConfiguration();var e=this.getSongBook().getSelectedMusic().getNumber(),r=this.getSongBook().getConfiguration().getMusic(e);return this.getDebugger().getSheetEndTimeElement().text(t),r.setSheetEndTime(t),this},DebuggerOutputManager.prototype.getNewPartNumber=function(t){var e=0;return this.getSpeedOutput(t).eachPartOutput(function(t,r){"string"==typeof t&&(t*=1),e=t}),e+1},DebuggerOutputManager.prototype.createNewSpeedOutput=function(t){var e=this.getDebugger().createSpeedOutput(t),r=this.getDebugger().getLastSpeedElement(),u=this.getSongBook().getSelectedMusic().getConfig();e.insertAfter(r);var g=SongBookMusicConfig.SYNC_PREFIX+"."+SongBookSheetViewer.PART_TYPE+"."+t;return u.put(g,{}),this.getSpeedOutput(t)},DebuggerOutputManager.prototype.createNewPartOutput=function(){var t,e=this;if(this.eachSpeedOutput(function(r,u){var g=e.getDebugger(),r=u.getSpeedLabel(),a=e.getNewPartNumber(r),i=e.getSongBook().getSelectedMusic(),n=i.getConfig(),s=new SongBookMusicPartConfig(n,a),o=g.createPartOutput(a,s,u.getElement(),r),p=g.getLastPartElement(u.getElement()),c=g.getLastPartLogElement();o.insertAfter(p),r==SongBookPlayer.PLAY_NORMAL_SPEED_TYPE&&g.createPartLogOutput(a,s).insertAfter(c),i.createPart(s,r),t=a}),void 0!=t)return this.getSpeedOutput(SongBookPlayer.PLAY_NORMAL_SPEED_TYPE).getPartOutput(t)},DebuggerOutputManager.prototype.getNextBarNumber=function(t,e){var r;void 0==e&&(e=!0);var u=(r=t.isFirst()||t.getBarsSize()>1?t:t.getPreviousPartOutput(!0)).getLastBarOutput();if(void 0==u&&t.getSpeedOutput().getPartsSize()>2){for(var g=t.getNumber()-1;g>1;){var a=t.getSpeedOutput().getPartOutput(g);if(void 0!=a.getLastBarOutput()){u=a.getLastBarOutput();break}a.delete(),g--}u=t.getSpeedOutput().getPartOutput(g).getLastBarOutput()}return void 0==u?1:e&&t.isEmpty()?u.getNumber():u.hasCustomLineBars()?u.getNumber()+u.getCustomLineBars():u.getNumber()+BarDebuggerOutput.BARS_PER_LINE},DebuggerOutputManager.prototype.placeNewBarElement=function(t,e){var r=this.getSongBook().getSelectedMusic(),u=r.getPart(t.getNumber()).getPartConfig(),g=t.getSpeedOutput().getSpeedLabel(),a=t.getPartConfig(),i=new SongBookMusicBarConfig(a,g,e),n=this.getDebugger().getLastBarElement(t.getElement());this.getDebugger().createBarOutput(e,a,i,g,t.getElement()).insertAfter(n);var s=SongBookMusicConfig.SYNC_PREFIX+"."+SongBookSheetViewer.PART_TYPE+"."+g+"."+t.getNumber()+"."+e;return a.put(s,{}),u.addBar(e,i,g),r.getConfig().setSyncLastBar(e),t.getBarOutput(e)},DebuggerOutputManager.prototype.createNewBarOutput=function(t,e){var r=this.getNextBarNumber(t,e);t.isEmpty()&&t.setFirstCreatedBarNumber(r);var u=this.placeNewBarElement(t,r);return this.placeNewBarElement(t.getMirror(),r),u},DebuggerOutputManager.prototype.removePartLog=function(t){var e=this.getPartLogMap().get(t);return void 0!=e&&(e.getElement().remove(),this.getPartLogMap().remove(t)),this},DebuggerOutputManager.prototype.reorderPartLogs=function(){var t=1;return this.getPartLogMap().sort(t,function(e,r){return r.setNumber(t),t+=1}),this},DebuggerOutputManager.prototype.splitParts=function(t){var e=this,r=t.getPartOutput(),u=r.getNextPartOutput(!0),g=new Map;u==r&&(u=this.createNewPartOutput()),r.eachBarOutput(function(e,r){e>=t.getNumber()&&(g.put(e,{firstSync:r.isFirstSync(),startTime:r.getStartTime(),endTime:r.getEndTime(),customLineBars:r.getCustomLineBars()}),e>t.getNumber()&&(r.getMirror().delete(),r.delete()))});var a;return g.each(function(t,r){void 0==a&&(a=1*t);var g=e.createNewBarOutput(u,!0);g.setFirstSync(r.firstSync),g.setStartTime(r.startTime),g.setEndTime(r.endTime),g.setCustomLineBars(r.customLineBars,!1),g.getMirror().setFirstSync(r.firstSync),g.getMirror().setStartTime(r.startTime),g.getMirror().setEndTime(r.endTime),g.getMirror().setCustomLineBars(r.customLineBars,!1)}),u.select(),void 0==a&&(a=1),u.setFirstCreatedBarNumber(a),u.getMirror().setFirstCreatedBarNumber(a),this},DebuggerOutputManager.prototype.startEditing=function(){var t=this.getSongBook().getPlayer();this.setFirstSync(!0);var e,r;void 0!=(e=this.selectFirstSpeedOutput())&&(r=e.selectFirstPartOutput()),void 0!=r&&(barPartOutput=r.selectFirstBarOutput()),this.getDebugger().isReview()||(this.getDebugger().getMessenger().showMessage("001",!0),t.hideSheets(),t.seekTo(0),t.pause())},DebuggerOutputManager.prototype.stopEditing=function(){if(!this.getDebugger().isReview()){var t=this.getSongBook(),e=t.getPlayer(),r=t.getSelectedMusic();this.setFirstSync(!1),this.resetAllBarsSync(),e.hideSheets(),this.getDebugger().isReview()||(e.setPlaySpeedType(SongBookPlayer.PLAY_NORMAL_SPEED_TYPE),this.getDebugger().getMessenger().hide(),r.selectFirstPart(),e.seekTo(0),e.play())}},DebuggerOutputManager.prototype.startReview=function(){return this.getSongBook().getPlayer().stop().disable(),this.getSongBook().getSheetReviewer().reset(),this.getDebugger().getMessenger().hide(),this},DebuggerOutputManager.prototype.stopReview=function(){return this.getSongBook().getPlayer().enable(),this.getDebugger().isEditing()&&this.startEditing(),this};
function SpeedDebuggerOutput(t,e,r){SelectableElement.call(this,r),this.outputManager=t,this.speedLabel=e,this.element=r,this.partsMap=new Map,this.buildMappings()}SpeedDebuggerOutput.prototype=Object.create(SelectableElement.prototype),SpeedDebuggerOutput.prototype.constructor=SpeedDebuggerOutput,SpeedDebuggerOutput.prototype.getSongBook=function(){return this.getOutputManager().getSongBook()},SpeedDebuggerOutput.prototype.getDebugger=function(){return this.getOutputManager().getDebugger()},SpeedDebuggerOutput.prototype.getOutputManager=function(){return this.outputManager},SpeedDebuggerOutput.prototype.getSpeedLabel=function(){return this.speedLabel},SpeedDebuggerOutput.prototype.getElement=function(){return this.element},SpeedDebuggerOutput.prototype.getLabelElement=function(){return this.getElement().find(">span.label")},SpeedDebuggerOutput.prototype.getPartsMap=function(){return this.partsMap},SpeedDebuggerOutput.prototype.getPartOutput=function(t){return this.getPartsMap().get(t)},SpeedDebuggerOutput.prototype.isFirstPart=function(t){return this.getPartsMap().isFirstValue(t)},SpeedDebuggerOutput.prototype.isLastPart=function(t){return this.getPartsMap().isLastValue(t)},SpeedDebuggerOutput.prototype.addPart=function(t,e){return this.getPartsMap().put(t.getNumber(),new PartDebuggerOutput(this,t,e)),this},SpeedDebuggerOutput.prototype.deselectAllParts=function(){return this.getPartsMap().each(function(t,e){e.setSelected(!1)}),this},SpeedDebuggerOutput.prototype.select=function(){var t=this.getSongBook().getPlayer().getButton(SongBookPlayerButton.NORMAL_VIDEO_BUTTON),e=this.getSongBook().getPlayer().getButton(SongBookPlayerButton.SLOW_VIDEO_BUTTON);return this.getOutputManager().deselectAll(),this.setSelected(!0),this.getSpeedLabel()==SongBookPlayer.PLAY_NORMAL_SPEED_TYPE?(e.deselect(),t.select()):this.getSpeedLabel()==SongBookPlayer.PLAY_SLOW_SPEED_TYPE&&(e.select(),t.deselect()),this.getDebugger().scrollTo(this),this},SpeedDebuggerOutput.prototype.selectFirstPartOutput=function(){var t=null,e=this.getPartsMap().contents;for(var r in e)return(t=e[r]).select(),t;if(null==t)return(t=this.getOutputManager().createNewPartOutput(this)).select(),t},SpeedDebuggerOutput.prototype.getFirstPartOutput=function(){var t=this.getPartsMap().contents;for(var e in t)return t[e]},SpeedDebuggerOutput.prototype.getPreviousSpeedOutput=function(){var t=this.getSpeedLabel(),e=this.getOutputManager();return t==SongBookPlayer.PLAY_NORMAL_SPEED_TYPE?this:e.getSpeedOutput(SongBookPlayer.PLAY_NORMAL_SPEED_TYPE)},SpeedDebuggerOutput.prototype.getNextSpeedOutput=function(){var t=this.getSpeedLabel(),e=this.getOutputManager();return t==SongBookPlayer.PLAY_SLOW_SPEED_TYPE?this:e.getSpeedOutput(SongBookPlayer.PLAY_SLOW_SPEED_TYPE)},SpeedDebuggerOutput.prototype.getLastPartOutput=function(){var t,e=this.getPartsMap().contents;for(var r in e)t=e[r];return t},SpeedDebuggerOutput.prototype.eachPartOutput=function(t){this.getPartsMap().each(function(e,r){return t.call(this,e,r)})},SpeedDebuggerOutput.prototype.getPartsSize=function(){return this.getPartsMap().size()},SpeedDebuggerOutput.prototype.removePart=function(t){return this.getPartsMap().remove(t)},SpeedDebuggerOutput.prototype.reorderParts=function(){var t=1;return this.getPartsMap().sort(t,function(e,r){return r.setNumber(t),t+=1}),this},SpeedDebuggerOutput.prototype.reorderBarsAfter=function(t){if(void 0==t){var e=this.getFirstPartOutput();if(void 0==e)return this;if(void 0==(t=e.getFirstBarOutput()))return this}var r=t.getPartOutput(),u=this.getSongBook().getSelectedMusic(),p=u.getPart(r.getNumber()),o=r.reorderBars();return p.reorderBars(),this.eachPartOutput(function(t,e){if(e.getNumber()>r.getNumber()){var p=u.getPart(e.getNumber());o=e.reorderBars(o),p.reorderBars(o)}}),this},SpeedDebuggerOutput.prototype.buildMappings=function(){var t=this;return this.getLabelElement().click(function(){t.select()}),this};
function PartDebuggerOutput(t,e,r){SelectableElement.call(this,r),this.speedOutput=t,this.partConfig=e,this.firstCreatedBarNumber=1,this.currentSpeedLabel=t.getSpeedLabel(),this.element=r,this.barsMap=new Map,this.buildMappings()}PartDebuggerOutput.prototype=Object.create(SelectableElement.prototype),PartDebuggerOutput.prototype.constructor=PartDebuggerOutput,PartDebuggerOutput.prototype.getSongBook=function(){return this.getDebugger().getSongBook()},PartDebuggerOutput.prototype.getDebugger=function(){return this.getOutputManager().getDebugger()},PartDebuggerOutput.prototype.getOutputManager=function(){return this.getSpeedOutput().getOutputManager()},PartDebuggerOutput.prototype.getSpeedOutput=function(){return this.speedOutput},PartDebuggerOutput.prototype.getPartConfig=function(){return this.partConfig},PartDebuggerOutput.prototype.getCurrentSpeedLabel=function(){return this.currentSpeedLabel},PartDebuggerOutput.prototype.getNumber=function(){return this.getPartConfig().getNumber()},PartDebuggerOutput.prototype.getNumber=function(){return this.getPartConfig().getNumber()},PartDebuggerOutput.prototype.setNumber=function(t){return this.getPartConfig().setNumber(t),this.getNumberLabelElement().text(t),this},PartDebuggerOutput.prototype.setFirstCreatedBarNumber=function(t){return this.firstCreatedBarNumber=t,this},PartDebuggerOutput.prototype.getFirstCreatedBarNumber=function(){return this.firstCreatedBarNumber},PartDebuggerOutput.prototype.getElement=function(){return this.element},PartDebuggerOutput.prototype.getLabelElement=function(){return this.getElement().find(">span.label")},PartDebuggerOutput.prototype.getNumberLabelElement=function(){return this.getLabelElement().find("em.number")},PartDebuggerOutput.prototype.getTimeStartElement=function(){return this.getElement().find(">span.part-times em.part-start")},PartDebuggerOutput.prototype.getTimeEndElement=function(){return this.getElement().find(">span.part-times em.part-end")},PartDebuggerOutput.prototype.setNormalStartTime=function(t){return this.getPartConfig().setNormalSeekStartTime(t),this.getTimeStartElement().text(t),this},PartDebuggerOutput.prototype.setNormalEndTime=function(t){return this.getPartConfig().setNormalSeekEndTime(t),this.getTimeEndElement().text(t),this},PartDebuggerOutput.prototype.setSlowStartTime=function(t){return this.getPartConfig().setSlowSeekStartTime(t),this.getTimeStartElement().text(t),this},PartDebuggerOutput.prototype.setSlowEndTime=function(t){return this.getPartConfig().setSlowSeekEndTime(t),this.getTimeEndElement().text(t),this},PartDebuggerOutput.prototype.getBarsMap=function(){return this.barsMap},PartDebuggerOutput.prototype.isFirstBar=function(t){return this.getBarsMap().isFirstValue(t)},PartDebuggerOutput.prototype.isLastBar=function(t){return this.getBarsMap().isLastValue(t)},PartDebuggerOutput.prototype.isFirst=function(){return this.getSpeedOutput().isFirstPart(this)},PartDebuggerOutput.prototype.isLast=function(){return this.getSpeedOutput().isLastPart(this)},PartDebuggerOutput.prototype.deselectAllBars=function(){return this.getBarsMap().each(function(t,e){e.setSelected(!1)}),this},PartDebuggerOutput.prototype.getBarOutput=function(t){return this.getBarsMap().get(t)},PartDebuggerOutput.prototype.addBar=function(t,e){return this.getBarsMap().put(t.getNumber(),new BarDebuggerOutput(this,t,e)),this},PartDebuggerOutput.prototype.select=function(){var t=this.getOutputManager(),e=(this.getSpeedOutput(),this.getSongBook()),r=e.getSelectedMusic();if(void 0!=r){t.deselectAll(),this.setSelected(!0);var u=this.getPartConfig().getNumber(),g=r.getPart(u);if(void 0!=g){var p=this.getSpeedOutput().getSpeedLabel();t.getSpeedOutput(p).setSelected(!0),e.getPlayer().setPlaySpeedType(p),g.select()}this.getDebugger().scrollTo(this)}return this},PartDebuggerOutput.prototype.eachBarOutput=function(t){this.getBarsMap().each(function(e,r){return t.call(this,e,r)})},PartDebuggerOutput.prototype.selectFirstBarOutput=function(){var t=this.getBarsMap().contents;for(var e in t){var r=t[e];return r.select(),r}},PartDebuggerOutput.prototype.getFirstBarOutput=function(){var t=this.getBarsMap().contents;for(var e in t)return t[e]},PartDebuggerOutput.prototype.getLastBarOutput=function(){var t,e=this.getBarsMap().contents;for(var r in e)t=e[r];return t},PartDebuggerOutput.prototype.getPreviousPartOutput=function(t){var e=this.getNumber();"string"==typeof e&&(e*=1);var r=e-1,u=this.getOutputManager(),g=this.getSpeedOutput().getPartOutput(r),p=this.getSpeedOutput().getSpeedLabel();if(1==t){if(r<1)return this;g=u.getSpeedOutput(p).getPartOutput(r)}else{if(r<1&&p==SongBookPlayer.PLAY_NORMAL_SPEED_TYPE)return this;g=p==SongBookPlayer.PLAY_NORMAL_SPEED_TYPE?u.getSpeedOutput(SongBookPlayer.PLAY_SLOW_SPEED_TYPE).getPartOutput(r):u.getSpeedOutput(SongBookPlayer.PLAY_NORMAL_SPEED_TYPE).getPartOutput(e)}return g},PartDebuggerOutput.prototype.getNextPartOutput=function(t){var e=this.getSpeedOutput().getPartsSize(),r=this.getNumber();"string"==typeof r&&(r*=1);var u=r+1,g=this.getOutputManager(),p=this.getSpeedOutput().getPartOutput(u),a=this.getSpeedOutput().getSpeedLabel();if(u>e&&"slow"==a)return this;if(1==t){if(void 0==(p=g.getSpeedOutput(a).getPartOutput(u)))return this}else p=a==SongBookPlayer.PLAY_NORMAL_SPEED_TYPE?g.getSpeedOutput(SongBookPlayer.PLAY_SLOW_SPEED_TYPE).getPartOutput(r):g.getSpeedOutput(SongBookPlayer.PLAY_NORMAL_SPEED_TYPE).getPartOutput(u);return p},PartDebuggerOutput.prototype.getBarsSize=function(){return this.getBarsMap().size()},PartDebuggerOutput.prototype.getMirror=function(){var t=this.getOutputManager();return this.getSpeedOutput().getSpeedLabel()==SongBookPlayer.PLAY_NORMAL_SPEED_TYPE?t.getSpeedOutput(SongBookPlayer.PLAY_SLOW_SPEED_TYPE).getPartOutput(this.getNumber()):t.getSpeedOutput(SongBookPlayer.PLAY_NORMAL_SPEED_TYPE).getPartOutput(this.getNumber())},PartDebuggerOutput.prototype.delete=function(t){var e=this.getOutputManager(),r=(e.getPartLogOutput(this.getNumber()),this.getSpeedOutput()),u=this.getSongBook().getSelectedMusic(),g=this.getPreviousPartOutput(!0),p=g.getLastBarOutput();this.getElement().remove(),t||e.removePartLog(this.getNumber()),t||u.removePart(this.getNumber()),r.removePart(this.getNumber()),u.reorderParts(),r.reorderParts(),e.reorderPartLogs(),g==this&&(p=void 0),r.reorderBarsAfter(p)},PartDebuggerOutput.prototype.removeBar=function(t){return this.getBarsMap().remove(t)},PartDebuggerOutput.prototype.reorderBars=function(t){var e=this.getBarsMap(),r=this.getFirstCreatedBarNumber();return void 0!=t&&(r=t),e.sort(r,function(t,e){return e.setNumber(r),e.isLast()||(e.hasCustomLineBars()?r+=e.getCustomLineBars():r+=BarDebuggerOutput.BARS_PER_LINE),r}),this.getOutputManager().setLastCreatedBarNumber(r),r},PartDebuggerOutput.prototype.isEmpty=function(){return void 0==this.getFirstBarOutput()},PartDebuggerOutput.prototype.buildMappings=function(){var t=this;return this.getLabelElement().click(function(){t.select()}),this};
function PartLogDebuggerOutput(t,e,r){SelectableElement.call(this,r),this.outputManager=t,this.partConfig=e,this.element=r,this.buildMappings()}PartLogDebuggerOutput.prototype=Object.create(SelectableElement.prototype),PartLogDebuggerOutput.prototype.constructor=PartLogDebuggerOutput,PartLogDebuggerOutput.prototype.getOutputManager=function(){return this.outputManager},PartLogDebuggerOutput.prototype.getPartConfig=function(){return this.partConfig},PartLogDebuggerOutput.prototype.getNumber=function(){return this.getPartConfig().getNumber()},PartLogDebuggerOutput.prototype.setNumber=function(t){return this.getPartConfig().setNumber(t),this.getLabelElement().text(t),this},PartLogDebuggerOutput.prototype.getElement=function(){return this.element},PartLogDebuggerOutput.prototype.getLabelElement=function(){return this.getElement().find("em.number")},PartLogDebuggerOutput.prototype.getNormalTimeStartElement=function(){return this.getElement().find("em.ns")},PartLogDebuggerOutput.prototype.getNormalTimeEndElement=function(){return this.getElement().find("em.ne")},PartLogDebuggerOutput.prototype.getSlowTimeStartElement=function(){return this.getElement().find("em.ss")},PartLogDebuggerOutput.prototype.getSlowTimeEndElement=function(){return this.getElement().find("em.se")},PartLogDebuggerOutput.prototype.setNormalStartTime=function(t){return this.getNormalTimeStartElement().text(t),this},PartLogDebuggerOutput.prototype.setNormalEndTime=function(t){return this.getNormalTimeEndElement().text(t),this},PartLogDebuggerOutput.prototype.setSlowStartTime=function(t){return this.getSlowTimeStartElement().text(t),this},PartLogDebuggerOutput.prototype.setSlowEndTime=function(t){return this.getSlowTimeEndElement().text(t),this},PartLogDebuggerOutput.prototype.buildMappings=function(){var t=this;return this.getElement().click(function(){t.select()}),this};
function BarDebuggerOutput(t,e,r){SelectableElement.call(this,r),this.partOutput=t,this.barConfig=e,this.element=r,this.firstSync=!0,this.buildMappings()}BarDebuggerOutput.prototype=Object.create(SelectableElement.prototype),BarDebuggerOutput.prototype.constructor=BarDebuggerOutput,BarDebuggerOutput.BARS_PER_LINE=4,BarDebuggerOutput.prototype.getSongBook=function(){return this.getDebugger().getSongBook()},BarDebuggerOutput.prototype.getDebugger=function(){return this.getOutputManager().getDebugger()},BarDebuggerOutput.prototype.getOutputManager=function(){return this.getSpeedOutput().getOutputManager()},BarDebuggerOutput.prototype.getSpeedOutput=function(){return this.getPartOutput().getSpeedOutput()},BarDebuggerOutput.prototype.getPartOutput=function(){return this.partOutput},BarDebuggerOutput.prototype.getPartLogOutput=function(){var t=this.getOutputManager(),e=this.getPartOutput().getNumber();return t.getPartLogOutput(e)},BarDebuggerOutput.prototype.getBarConfig=function(){return this.barConfig},BarDebuggerOutput.prototype.setFirstSync=function(t){return this.firstSync=t,this},BarDebuggerOutput.prototype.isFirstSync=function(){return 1==this.firstSync},BarDebuggerOutput.prototype.isFirst=function(){return this.getPartOutput().isFirstBar(this)},BarDebuggerOutput.prototype.isLast=function(){return this.getPartOutput().isLastBar(this)},BarDebuggerOutput.prototype.isEmpty=function(){var t=this.getBarConfig().getStartTime(),e=this.getBarConfig().getStartTime();return void 0==t&&void 0==e},BarDebuggerOutput.prototype.isLastOfSheet=function(){var t=this.getOutputManager();this.getSongBook().getSelectedMusic().getConfig();return this.getNumber()==t.getLastBarNumber()},BarDebuggerOutput.prototype.getNumber=function(){return this.getBarConfig().getNumber()},BarDebuggerOutput.prototype.setNumber=function(t){return this.getBarConfig().setNumber(t),this.getNumberLabelElement().text(t),this},BarDebuggerOutput.prototype.getElement=function(){return this.element},BarDebuggerOutput.prototype.getNumberLabelElement=function(){return this.getElement().find("em.number")},BarDebuggerOutput.prototype.getStartTimeElement=function(){return this.getElement().find("em.start")},BarDebuggerOutput.prototype.getEndTimeElement=function(){return this.getElement().find("em.end")},BarDebuggerOutput.prototype.getLineBarsElement=function(){return this.getElement().find("em.line-bars span.bar-num")},BarDebuggerOutput.prototype.select=function(t){void 0==t&&(t=!1);var e=this.getOutputManager(),r=this.getSongBook().getPlayer(),u=this.getSpeedOutput().getSpeedLabel(),g=this.getBarConfig().getStartTime();return e.selectBarOutput(this,u),this.getDebugger().isReview()?this.getSongBook().getSheetReviewer().setCurrentBarOutput(this):this.getDebugger().isEditing()&&this.getDebugger().isSyncStarted()?(this.isEmpty()||(r.seekTo(g),r.getSheetViewer().updateWithBarOutput(this),r.checkSheetDisplayRange(g)),r.pause()):r.seekTo(g),this},BarDebuggerOutput.prototype.getPreviousBarOutput=function(){var t=this.getNumber();"string"==typeof t&&(t*=1);var e=BarDebuggerOutput.BARS_PER_LINE;this.hasCustomLineBars()&&(e=this.getCustomLineBars());this.getSpeedOutput().getOutputManager();var r=t-e,u=this.getPartOutput().getBarOutput(r);if(void 0==u)for(var g=this.getNumber()-1;g>=1&&void 0==(u=this.getPartOutput().getBarOutput(g));)g--;var i=this.getSpeedOutput().getSpeedLabel();return void 0==u?i==SongBookPlayer.PLAY_NORMAL_SPEED_TYPE&&1==t?this:u=this.getPartOutput().getPreviousPartOutput().getLastBarOutput():u},BarDebuggerOutput.prototype.getNextBarOutput=function(){var t=this.getNumber();"string"==typeof t&&(t*=1);var e=BarDebuggerOutput.BARS_PER_LINE;this.hasCustomLineBars()&&(e=this.getCustomLineBars());var r=this.getOutputManager().getLastBarNumber(),u=t+e,g=this.getPartOutput().getBarOutput(u),i=this.getSpeedOutput().getSpeedLabel();if(void 0==g){if(u>r&&i==SongBookPlayer.PLAY_SLOW_SPEED_TYPE)return this;var a=this.getPartOutput().getNextPartOutput();if(void 0==a)return;return g=a.getFirstBarOutput()}return g},BarDebuggerOutput.prototype.setStartTime=function(t){return this.getBarConfig().setStartTime(t),this.getStartTimeElement().text(t),this},BarDebuggerOutput.prototype.setEndTime=function(t){return this.getBarConfig().setEndTime(t),this.getEndTimeElement().text(t),this},BarDebuggerOutput.prototype.getStartTime=function(){return this.getBarConfig().getStartTime()},BarDebuggerOutput.prototype.getEndTime=function(){return this.getBarConfig().getEndTime()},BarDebuggerOutput.prototype.hasCustomLineBars=function(){return this.getBarConfig().hasCustomLineBars()},BarDebuggerOutput.prototype.getCustomLineBars=function(){return this.getBarConfig().getCustomLineBars()},BarDebuggerOutput.prototype.setCustomLineBars=function(t,e){return void 0==e&&(e=!0),this.getBarConfig().setCustomLineBars(t),this.updateLineBars(),e&&(this.getSpeedOutput().reorderBarsAfter(this),this.getMirror().getSpeedOutput().reorderBarsAfter(this.getMirror())),this},BarDebuggerOutput.prototype.updateLineBars=function(){if(this.hasCustomLineBars()){var t=this.getCustomLineBars();t!=BarDebuggerOutput.BARS_PER_LINE?(this.getElement().addClass("custom-bars"),this.getLineBarsElement().text(t)):this.getElement().removeClass("custom-bars")}else this.getElement().removeClass("custom-bars")},BarDebuggerOutput.prototype.getMirror=function(){var t=this.getOutputManager(),e=this.getPartOutput();return this.getSpeedOutput().getSpeedLabel()==SongBookPlayer.PLAY_NORMAL_SPEED_TYPE?t.getSpeedOutput(SongBookPlayer.PLAY_SLOW_SPEED_TYPE).getPartOutput(e.getNumber()).getBarOutput(this.getNumber()):t.getSpeedOutput(SongBookPlayer.PLAY_NORMAL_SPEED_TYPE).getPartOutput(e.getNumber()).getBarOutput(this.getNumber())},BarDebuggerOutput.prototype.delete=function(){this.getOutputManager();var t=this.getSpeedOutput(),e=this.getPartOutput(),r=this.getSongBook().getSelectedMusic().getPart(e.getNumber());e.setFirstCreatedBarNumber(e.getFirstBarOutput().getNumber()),this.getElement().remove(),e.removeBar(this.getNumber()),r.removeBar(this.getNumber(),t.getSpeedLabel()),t.reorderBarsAfter(this)},BarDebuggerOutput.prototype.buildMappings=function(){var t=this;return this.getElement().click(function(){t.select(!0)}),this.updateLineBars(),this};
function SongBookPlayer(e,t){this.name=t,this.element=null,this.songBook=e,this.player=null,this.playerSize=SongBookPlayer.FULLHD_PLAYER_SIZE,this.enabled=!0,this.repeat=!1,this.playSpeedType=SongBookPlayer.PLAY_NORMAL_SPEED_TYPE,this.playerPanel=new SongBookPlayerPanel(this),this.sheetViewer=new SongBookSheetViewer(this),this.watchTimeout=null}SongBookPlayer.PLAY_NORMAL_SPEED_TYPE="normal",SongBookPlayer.PLAY_SLOW_SPEED_TYPE="slow",SongBookPlayer.SMALL_PLAYER_SIZE="small",SongBookPlayer.MEDIUM_PLAYER_SIZE="medium",SongBookPlayer.FULLHD_PLAYER_SIZE="fullhd",SongBookPlayer.TIME_WHATCH_FUNCTIONS={selectPartByTime:function(e){var t=e.getCurrentTime(),o=e.getSongBook(),n=o.getSelectedMusic().getSelectedPart(),r=o.getPartByTime(t),i=0,a=0,l=0,s=0;void 0!=n&&void 0!=r&&(e.checkSheetDisplayRange(t),e.getPlaySpeedType()==SongBookPlayer.PLAY_NORMAL_SPEED_TYPE?(i=n.getNormalSyncStartTime(),a=n.getNormalSyncEndTime(),l=r.getNormalSyncStartTime(),s=r.getNormalSyncEndTime()):(i=n.getSlowSyncStartTime(),a=n.getSlowSyncEndTime(),l=r.getSlowSyncStartTime(),s=r.getSlowSyncEndTime()),i!=l&&a!=s&&(e.isRepeating()?e.seekTo(i):(o.getSelectedMusic().clearSelectedPart(),r.setSelected(!0))))},updateSheetDisplay:function(e){var t=e.getCurrentTime();e.getSheetViewer().update(t)}},SongBookPlayer.onReadyHandler=function(e){return function(){}},SongBookPlayer.onStateChangeHandler=function(e){return function(){if(e.getPlayer().getPlayerState()==YT.PlayerState.PLAYING?e.startTimeWatch():e.pauseTimeWatch(),e.getSongBook().checkButtonsState(),e.isPaused()){var t=e.getSongBook().getDebugger(),o=e.getCurrentTime();(!t.isDebugging()||t.isDebugging()&&!t.isEditing())&&(e.getSongBook().selectPartByTime(o),e.getSheetViewer().update(o))}}},SongBookPlayer.prototype.getButton=function(e){return this.getPlayerPanel().getButton(e)},SongBookPlayer.prototype.getPlayer=function(){return this.player},SongBookPlayer.prototype.getPlayerPanel=function(){return this.playerPanel},SongBookPlayer.prototype.getSheetViewer=function(){return this.sheetViewer},SongBookPlayer.prototype.getPlaySpeedType=function(){return this.playSpeedType},SongBookPlayer.prototype.setPlaySpeedType=function(e){return this.playSpeedType=e,this},SongBookPlayer.prototype.getPlayerSize=function(){return this.playerSize},SongBookPlayer.prototype.setPlayerSize=function(e){return this.playerSize=e,this.getElement().removeClass(SongBookPlayer.SMALL_PLAYER_SIZE),this.getElement().removeClass(SongBookPlayer.MEDIUM_PLAYER_SIZE),this.getElement().removeClass(SongBookPlayer.FULLHD_PLAYER_SIZE),this.getElement().addClass(e),this},SongBookPlayer.prototype.getName=function(){return this.name},SongBookPlayer.prototype.setName=function(e){return this.name=e,this},SongBookPlayer.prototype.getSongBook=function(){return this.songBook},SongBookPlayer.prototype.getElement=function(){return null==this.element&&(this.element=this.getSongBook().getElement().find("div.smb7-songbook-player")),this.element},SongBookPlayer.prototype.disable=function(){return this.enabled=!1,this},SongBookPlayer.prototype.enable=function(){return this.enabled=!0,this},SongBookPlayer.prototype.isEnabled=function(){return 1==this.enabled},SongBookPlayer.prototype.getCurrentTime=function(){return this.getPlayer().getCurrentTime()},SongBookPlayer.prototype.toggleNoteNames=function(){return this.getSheetViewer().toggleNoteNames(),this},SongBookPlayer.prototype.updateButtons=function(){var e=this.getButton(SongBookPlayerButton.NORMAL_VIDEO_BUTTON),t=this.getButton(SongBookPlayerButton.SLOW_VIDEO_BUTTON);return this.getPlaySpeedType()==SongBookPlayer.PLAY_NORMAL_SPEED_TYPE?(e.setSelected(!0),t.setSelected(!1)):(e.setSelected(!1),t.setSelected(!0)),this},SongBookPlayer.prototype.runWatchFunctions=function(){var e=SongBookPlayer.TIME_WHATCH_FUNCTIONS,t=this.getSongBook().getDebugger();if(!t.isDebugging()||t.isDebugging()&&!t.isEditing())for(var o in e){var n=e[o];"function"==typeof n&&n.call(this,this)}return this},SongBookPlayer.prototype.startTimeWatch=function(){var e=this,t=this.getPlayer();return this.watchTimeout=window.setTimeout(function(){t.getCurrentTime();e.runWatchFunctions(),e.startTimeWatch()},100),this},SongBookPlayer.prototype.pauseTimeWatch=function(){return window.clearTimeout(this.watchTimeout),this},SongBookPlayer.prototype.updateViewSize=function(){var e=this.getSheetViewer().getDisplayType();e==SongBookSheetViewer.PART_TYPE?(this.getElement().addClass(SongBookSheetViewer.PART_TYPE+"-view"),this.getElement().removeClass(SongBookSheetViewer.TAB_TYPE+"-view")):e==SongBookSheetViewer.TAB_TYPE&&(this.getElement().removeClass(SongBookSheetViewer.PART_TYPE+"-view"),this.getElement().addClass(SongBookSheetViewer.TAB_TYPE+"-view"))},SongBookPlayer.prototype.checkSheetDisplayRange=function(e){var t=this.getSongBook().getConfiguration(),o=this.getSongBook().getSelectedMusic().getNumber(),n=t.getMusic(o),r=n.getSheetStartTime(),i=n.getSheetEndTime();e>=r&&e<=i?this.showSheets():this.hideSheets()},SongBookPlayer.prototype.hideSheets=function(){this.getElement().addClass("no-sheet")},SongBookPlayer.prototype.showSheets=function(){this.getElement().removeClass("no-sheet")},SongBookPlayer.prototype.setRepeat=function(e){return this.repeat=e,this},SongBookPlayer.prototype.isRepeating=function(){return 1==this.repeat},SongBookPlayer.prototype.playVideoById=function(e){if(null!=this.getPlayer()&&void 0!=this.getPlayer())return void 0==e&&(e=""),this.getPlayer().loadVideoById(e),this},SongBookPlayer.prototype.play=function(){if(null!=this.getPlayer()&&void 0!=this.getPlayer()&&this.isEnabled())return this.getPlayer().playVideo(),this},SongBookPlayer.prototype.pause=function(){if(null!=this.getPlayer()&&void 0!=this.getPlayer()&&this.isEnabled())return this.getPlayer().pauseVideo(),this},SongBookPlayer.prototype.stop=function(){if(null!=this.getPlayer()&&void 0!=this.getPlayer()&&this.isEnabled())return void 0!=this.getPlayer().stopVideo&&this.getPlayer().stopVideo(),this},SongBookPlayer.prototype.seekTo=function(e){if(null!=this.getPlayer()&&void 0!=this.getPlayer()&&this.isEnabled())return void 0!=this.getPlayer().seekTo&&this.getPlayer().seekTo(e),this},SongBookPlayer.prototype.setPlaybackRate=function(e){if(null!=this.getPlayer()&&void 0!=this.getPlayer()&&this.isEnabled())return this.getPlayer().setPlaybackRate(e),this},SongBookPlayer.prototype.isPlaying=function(){return null!=this.getPlayer()&&void 0!=this.getPlayer()&&this.getPlayer().getPlayerState()==YT.PlayerState.PLAYING},SongBookPlayer.prototype.isPaused=function(){return null!=this.getPlayer()&&void 0!=this.getPlayer()&&this.getPlayer().getPlayerState()==YT.PlayerState.PAUSED},SongBookPlayer.prototype.isStopped=function(){return null!=this.getPlayer()&&void 0!=this.getPlayer()&&this.getPlayer().getPlayerState()==YT.PlayerState.CUED},SongBookPlayer.prototype.create=function(e){var t=this.getSongBook().getSelectedMusic();this.setName(e),this.player=new YT.Player(this.getName(),{videoId:t.getYoutubeUrl(),events:{onReady:SongBookPlayer.onReadyHandler(this),onStateChange:SongBookPlayer.onStateChangeHandler(this)},playerVars:{rel:0,modestbranding:1}})};
function SongBookSheetViewer(e){this.element=null,this.displayImageElement=null,this.songBookPlayer=e,this.showNoteNames=!1,this.lastUrl=null,this.lastPartNumber=null,this.url=null,this.displayType=SongBookSheetViewer.PART_TYPE,this.getElement(),this.zoomController=new SongBookSheetZoomController(this),this.buildMappings()}SongBookSheetViewer.PART_TYPE="parts",SongBookSheetViewer.PARTNOTES_TYPE="partnotes",SongBookSheetViewer.TAB_TYPE="tabs",SongBookSheetViewer.PARTS_REPOSITORY="images/musics/parts",SongBookSheetViewer.PARTNOTES_REPOSITORY="images/musics/partnotes",SongBookSheetViewer.TABS_REPOSITORY="images/musics/tabs",SongBookSheetViewer.prototype.getElement=function(){return null==this.element&&(this.element=this.getSongBookPlayer().getElement().find("div.player-sheets")),this.element},SongBookSheetViewer.prototype.getDisplayImageElement=function(){return null==this.displayImageElement&&(this.displayImageElement=this.getElement().find("img.display-image")),this.displayImageElement},SongBookSheetViewer.prototype.getZoomController=function(){return this.zoomController},SongBookSheetViewer.prototype.getSongBookPlayer=function(){return this.songBookPlayer},SongBookSheetViewer.prototype.getUrl=function(){return this.url},SongBookSheetViewer.prototype.setUrl=function(e){return this.url=e,this.getDisplayImageElement().attr("src",e),this},SongBookSheetViewer.prototype.getLastUrl=function(){return this.lastUrl},SongBookSheetViewer.prototype.setLastUrl=function(){var e=this.getDisplayImageElement();return this.lastUrl=e.attr("src"),this},SongBookSheetViewer.prototype.getLastPartNumber=function(){return this.lastPartNumber},SongBookSheetViewer.prototype.setLastPartNumber=function(e){return this.lastPartNumber=e,this},SongBookSheetViewer.prototype.getDisplayType=function(){return this.displayType},SongBookSheetViewer.prototype.setDisplayType=function(e){return this.displayType=e,this.getSongBookPlayer().updateViewSize(),this},SongBookSheetViewer.prototype.isShowNoteNames=function(){return 1==this.showNoteNames},SongBookSheetViewer.prototype.setShowNoteNames=function(e){return this.showNoteNames=e,this},SongBookSheetViewer.prototype.toggleNoteNames=function(){return this.isShowNoteNames()?this.showNoteNames=!1:this.showNoteNames=!0,this},SongBookSheetViewer.prototype.updateZoomProperties=function(e){return this.getZoomController().update(e),this},SongBookSheetViewer.prototype.getPath=function(e){void 0==e&&(e=this.getDisplayType());var t=this.getSongBookPlayer().getSongBook().getSelectedMusic().getNumber();t<10&&(t="0"+t);var o="";return this.isShowNoteNames()?o=SongBookSheetViewer.PARTNOTES_REPOSITORY+"/"+t:e==SongBookSheetViewer.PART_TYPE?o=SongBookSheetViewer.PARTS_REPOSITORY+"/"+t:e==SongBookSheetViewer.TAB_TYPE&&(o=SongBookSheetViewer.TABS_REPOSITORY+"/"+t),o},SongBookSheetViewer.prototype.getSyncTimes=function(e){var t=this.getSongBookPlayer().getSongBook().getSelectedMusic(),o=(this.getSongBookPlayer().getSongBook().getConfiguration(),t.getNumber());return configParser.getMusicSyncTimes(o,SongBookSheetViewer.PART_TYPE)},SongBookSheetViewer.prototype.update=function(e){var t=this.getSongBookPlayer().getSongBook(),o=t.getConfiguration(),r=t.getSelectedMusic(),i=r.getSelectedPart();if(void 0==i)return this;var n=i.getNumber(),s=o.getMusic(r.getNumber()).getPart(n),g=this.getPath(),S="",h=!1,a=0,u="",l=0;return this.setLastUrl(),s.eachBar(SongBookSheetViewer.PART_TYPE,SongBookPlayer.PLAY_NORMAL_SPEED_TYPE,function(t,o){var r=o.getStartTime(),i=o.getEndTime(),t=o.getNumber();if(e>=r&&e<=i)return h=!0,S=g+"/"+t+".png",u=SongBookPlayer.PLAY_NORMAL_SPEED_TYPE,a=t,l=s.getNumber(),!1}),0==h&&s.eachBar(SongBookSheetViewer.PART_TYPE,SongBookPlayer.PLAY_SLOW_SPEED_TYPE,function(t,o){var r=o.getStartTime(),i=o.getEndTime(),t=o.getNumber();if(e>=r&&e<=i)return S=g+"/"+o.getNumber()+".png",u=SongBookPlayer.PLAY_SLOW_SPEED_TYPE,a=t,l=s.getNumber(),!1}),(this.getLastUrl()!=S&&""!=S||l!=this.getLastPartNumber())&&(this.setUrl(S),this.updateZoomProperties(S),t.getDebugger().isDebugging()&&!t.getDebugger().isEditing()&&t.getDebugger().selectBarOutput(a,u)),this},SongBookSheetViewer.prototype.updateWithBarOutput=function(e){this.setLastUrl(),this.getSongBookPlayer().showSheets();var t=this.getPath()+"/"+e.getNumber()+".png";this.setUrl(t),this.updateZoomProperties(t)},SongBookSheetViewer.prototype.buildMappings=function(){this.getElement()};
function SongBookSheetReviewer(e){this.element=null,this.songBook=e,this.currentBarNumber=null,this.currentBarOutput=null,this.viewsMap=new Map,this.compassButtonsMap=new Map,this.getElement(),this.buildViewsMap(),this.buildCompassButtonsMap(),this.buildMappings()}SongBookSheetReviewer.prototype.getSongBook=function(){return this.songBook},SongBookSheetReviewer.prototype.getDebugger=function(){return this.getSongBook().getDebugger()},SongBookSheetReviewer.prototype.getOutputManager=function(){return this.getDebugger().getOutputManager()},SongBookSheetReviewer.prototype.getElement=function(){return null==this.element&&(this.element=this.getSongBook().getElement().find("div.sheet-reviewer")),this.element},SongBookSheetReviewer.prototype.getViewElements=function(){return this.getElement().find("div.rvw-view")},SongBookSheetReviewer.prototype.getCompassButtonElements=function(){return this.getElement().find("ul.cmp-numbers li.cmp-num")},SongBookSheetReviewer.prototype.getViewsMap=function(){return this.viewsMap},SongBookSheetReviewer.prototype.getCompassButtonsMap=function(){return this.compassButtonsMap},SongBookSheetReviewer.prototype.getCurrentBarNumber=function(){return this.currentBarNumber},SongBookSheetReviewer.prototype.setCurrentBarNumber=function(e){return this.currentBarNumber=e,this},SongBookSheetReviewer.prototype.setCurrentBarOutput=function(e){var t=this;return void 0==e?this.setCurrentBarNumber(1):(this.currentBarOutput=e,this.setCurrentBarNumber(e.getNumber()),e.hasCustomLineBars()?this.setCompassNumber(e.getCustomLineBars()):this.setCompassNumber(BarDebuggerOutput.BARS_PER_LINE)),this.eachView(function(e,o){o.setBarNumber(t.getCurrentBarNumber())}),this},SongBookSheetReviewer.prototype.getCurrentBarOutput=function(){return this.currentBarOutput},SongBookSheetReviewer.prototype.eachView=function(e){return this.getViewsMap().each(function(t,o){return e.call(this,t,o)}),this},SongBookSheetReviewer.prototype.eachCompassButton=function(e){return this.getCompassButtonsMap().each(function(t,o){return e.call(this,t,o)}),this},SongBookSheetReviewer.prototype.clearSelectedCompassButton=function(){return this.eachCompassButton(function(e,t){t.deselect()}),this},SongBookSheetReviewer.prototype.clearViews=function(){return this.getViewsMap().clear(),this},SongBookSheetReviewer.prototype.clearCompassButtons=function(){return this.getCompassButtonsMap().clear(),this},SongBookSheetReviewer.prototype.addView=function(e,t){return this.getViewsMap().put(e,t),this},SongBookSheetReviewer.prototype.getView=function(e){return this.getViewsMap().get(e)},SongBookSheetReviewer.prototype.addCompassButton=function(e,t){return this.getCompassButtonsMap().put(e,t),this},SongBookSheetReviewer.prototype.getCompassButton=function(e){return this.getCompassButtonsMap().get(e)},SongBookSheetReviewer.prototype.setCompassNumber=function(e){var t=this.getCompassButton(e);return void 0!=t&&(this.clearSelectedCompassButton(),t.setSelected(!0)),this},SongBookSheetReviewer.prototype.reset=function(){return this.eachView(function(e,t){t.setUrl("")}),this.getOutputManager().selectFirstBarOutput(),this},SongBookSheetReviewer.prototype.buildViewsMap=function(){var e=this;this.clearViews(),this.getViewElements().each(function(){var t=jQuery(this),o=t.attr("name");e.addView(o,new SheetReviewerView(e,o,t))})},SongBookSheetReviewer.prototype.buildCompassButtonsMap=function(){var e=this;this.clearCompassButtons(),this.getCompassButtonElements().each(function(){var t=jQuery(this),o=t.attr("name");e.addCompassButton(o,new SheetReviewerCompassButton(e,o,t))})},SongBookSheetReviewer.prototype.buildMappings=function(){};
function SheetReviewerView(e,t,i){this.sheetReviewer=e,this.name=t,this.element=i,this.url=null,this.barNumber=null,this.getElement(),this.buildMappings()}SheetReviewerView.prototype.getSongBook=function(){return this.getSheetReviewer().getSongBook()},SheetReviewerView.prototype.getSheetReviewer=function(){return this.sheetReviewer},SheetReviewerView.prototype.getName=function(){return this.name},SheetReviewerView.prototype.getElement=function(){return this.element},SheetReviewerView.prototype.getLabelElement=function(){return this.getElement().find("div.view-label")},SheetReviewerView.prototype.getNotFoundElement=function(){return this.getElement().find("div.not-found-message")},SheetReviewerView.prototype.getNotFoundPathElement=function(){return this.getNotFoundElement().find("em.path")},SheetReviewerView.prototype.getDisplayImageElement=function(){return this.getElement().find("img.display-image")},SheetReviewerView.prototype.getUrl=function(){return this.url},SheetReviewerView.prototype.setUrl=function(e){return this.url=e,this.getNotFoundPathElement().text(e),this.getDisplayImageElement().attr("src",e),this},SheetReviewerView.prototype.getPath=function(){var e=this.getName(),t=this.getSongBook().getSelectedMusic().getNumber();t<10&&(t="0"+t);var i="";return e==SongBookSheetViewer.PARTNOTES_TYPE?i=SongBookSheetViewer.PARTNOTES_REPOSITORY+"/"+t:e==SongBookSheetViewer.PART_TYPE?i=SongBookSheetViewer.PARTS_REPOSITORY+"/"+t:e==SongBookSheetViewer.TAB_TYPE&&(i=SongBookSheetViewer.TABS_REPOSITORY+"/"+t),i},SheetReviewerView.prototype.getBarNumber=function(){return this.barNumber},SheetReviewerView.prototype.setBarNumber=function(e){var t=this.getPath()+"/"+e+".png";return this.barNumber=e,this.setUrl(t),this.getElement().addClass("opened"),this},SheetReviewerView.prototype.buildMappings=function(){};
function SheetReviewerCompassButton(e,t,o){SelectableElement.call(this,o),this.sheetReviewer=e,this.name=t,this.element=o,this.compassNumber=0,this.getElement(),this.buildMappings()}SheetReviewerCompassButton.prototype=Object.create(SelectableElement.prototype),SheetReviewerCompassButton.prototype.constructor=SheetReviewerCompassButton,SheetReviewerCompassButton.prototype.getSongBook=function(){return this.getSheetReviewer().getSongBook()},SheetReviewerCompassButton.prototype.getSheetReviewer=function(){return this.sheetReviewer},SheetReviewerCompassButton.prototype.getName=function(){return this.name},SheetReviewerCompassButton.prototype.getElement=function(){return this.element},SheetReviewerCompassButton.prototype.getCompassNumber=function(){return this.compassNumber},SheetReviewerCompassButton.prototype.setCompassNumber=function(e){return this.compassNumber=e,this},SheetReviewerCompassButton.prototype.select=function(){return this.getSheetReviewer().clearSelectedCompassButton(),this.setSelected(!0),this},SheetReviewerCompassButton.prototype.buildMappings=function(){var e=this,t=1*this.getElement().text();this.setCompassNumber(t),this.getElement().click(function(){return e.select(),!1})};
function SongBookSheetZoomController(e){this.sheetViewer=e,this.element=null,this.placeHoldElement=null,this.placeHoldDeimiterElement=null,this.zoomContainerElement=null,this.enabled=!0,this.getElement(),this.getPlaceHoldElement(),this.getPlaceHoldDelimiterElement(),this.getZoomContainerElement(),this.buildMappings()}SongBookSheetZoomController.CONTROLLER_MARGIN=5,SongBookSheetZoomController.PLACEHOLD_BOLDER=4,SongBookSheetZoomController.CONTROLLER_MOVE=function(e){return function(o){if(e.isEnabled()){var t=$(this).parent().offset(),n=o.pageX-t.left,l=(o.pageY,t.top,e.getElement()),i=e.getZoomContainerElement(),r=e.getPlaceHoldElement(),m=r.width(),h=l.width(),s=n-m/2;s<SongBookSheetZoomController.CONTROLLER_MARGIN?s=SongBookSheetZoomController.CONTROLLER_MARGIN:s+m>h&&(s=h-m-SongBookSheetZoomController.CONTROLLER_MARGIN-SongBookSheetZoomController.PLACEHOLD_BOLDER);var g=n/h*100;r.css("left",s+"px"),i.css("background-position",g+"% center")}}},SongBookSheetZoomController.prototype.getSheetViewer=function(){return this.sheetViewer},SongBookSheetZoomController.prototype.isEnabled=function(){return 1==this.enabled},SongBookSheetZoomController.prototype.disable=function(){return this.getElement().addClass("disabled"),this.enabled=!1,this},SongBookSheetZoomController.prototype.enable=function(){return this.getElement().removeClass("disabled"),this.enabled=!0,this},SongBookSheetZoomController.prototype.toggle=function(){return this.isEnabled()?this.disable():this.enable(),this},SongBookSheetZoomController.prototype.getElement=function(){return null==this.element&&(this.element=this.getSheetViewer().getElement().find("div.zoom-controller")),this.element},SongBookSheetZoomController.prototype.getPlaceHoldElement=function(){return null==this.placeHoldElement&&(this.placeHoldElement=this.getElement().find("div.zoom-placehold")),this.placeHoldElement},SongBookSheetZoomController.prototype.getPlaceHoldDelimiterElement=function(){return null==this.placeHoldDeimiterElement&&(this.placeHoldDeimiterElement=this.getElement().find("div.zoom-placehold-delimiter")),this.placeHoldDeimiterElement},SongBookSheetZoomController.prototype.getZoomContainerElement=function(){return null==this.zoomContainerElement&&(this.zoomContainerElement=this.getElement().find("div.zoom-container")),this.zoomContainerElement},SongBookSheetZoomController.prototype.update=function(e){this.getSheetViewer().getDisplayImageElement().height();return this.getZoomContainerElement().css("background-image","url('"+e+"')"),this},SongBookSheetZoomController.prototype.buildMappings=function(){this.getElement().on("mousemove",SongBookSheetZoomController.CONTROLLER_MOVE(this))};
function SongBookPlayerPanel(e){this.player=e,this.buttons=this.buildButtons(),this.element=null}SongBookPlayerPanel.CONTROL_BUTTONS_PREFIX=".smb7-player-button",SongBookPlayerPanel.BUTTON_FUNCTIONS={speed:{normal:function(e){var t=e.getPlayerPanel().getPlayer(),o=t.getSongBook().getSelectedMusic().getSelectedPart();if(void 0!=o){var n=o.getNormalSyncTime();t.setPlaySpeedType(SongBookPlayer.PLAY_NORMAL_SPEED_TYPE),t.seekTo(n)}},slow:function(e){var t=e.getPlayerPanel().getPlayer(),o=t.getSongBook().getSelectedMusic().getSelectedPart().getSlowSyncTime();t.setPlaySpeedType(SongBookPlayer.PLAY_SLOW_SPEED_TYPE),t.seekTo(o)},.75:function(e){var t=e.getPlayerPanel().getPlayer(),o=t.getButton(SongBookPlayerButton.SLOW_PLAYER_BUTTON),n=t.getButton(SongBookPlayerButton.VERYSLOW_PLAYER_BUTTON),l=t.getButton(SongBookPlayerButton.ULTRASLOW_PLAYER_BUTTON),a=t.getButton(SongBookPlayerButton.NORMAL_PLAYER_BUTTON);o.setSelected(!0),n.setSelected(!1),l.setSelected(!1),a.setSelected(!1),t.setPlaybackRate(.75)},.5:function(e){var t=e.getPlayerPanel().getPlayer(),o=t.getButton(SongBookPlayerButton.SLOW_PLAYER_BUTTON),n=t.getButton(SongBookPlayerButton.VERYSLOW_PLAYER_BUTTON),l=t.getButton(SongBookPlayerButton.ULTRASLOW_PLAYER_BUTTON),a=t.getButton(SongBookPlayerButton.NORMAL_PLAYER_BUTTON);o.setSelected(!1),n.setSelected(!0),l.setSelected(!1),a.setSelected(!1),t.setPlaybackRate(.5)},.25:function(e){var t=e.getPlayerPanel().getPlayer(),o=t.getButton(SongBookPlayerButton.SLOW_PLAYER_BUTTON),n=t.getButton(SongBookPlayerButton.VERYSLOW_PLAYER_BUTTON),l=t.getButton(SongBookPlayerButton.ULTRASLOW_PLAYER_BUTTON),a=t.getButton(SongBookPlayerButton.NORMAL_PLAYER_BUTTON);o.setSelected(!1),n.setSelected(!1),l.setSelected(!0),a.setSelected(!1),t.setPlaybackRate(.25)},1:function(e){var t=e.getPlayerPanel().getPlayer(),o=t.getButton(SongBookPlayerButton.SLOW_PLAYER_BUTTON),n=t.getButton(SongBookPlayerButton.VERYSLOW_PLAYER_BUTTON),l=t.getButton(SongBookPlayerButton.ULTRASLOW_PLAYER_BUTTON),a=t.getButton(SongBookPlayerButton.NORMAL_PLAYER_BUTTON);o.setSelected(!1),n.setSelected(!1),l.setSelected(!1),a.setSelected(!0),t.setPlaybackRate(1)}},sheet:{zoom:function(e){var t=e.getPlayerPanel().getPlayer(),o=t.getButton(SongBookPlayerButton.ZOOM_SHEET_BUTTON),n=t.getSheetViewer().getZoomController();n.toggle(),o.setSelected(n.isEnabled())},notes:function(e){var t=e.getPlayerPanel().getPlayer(),o=t.getButton(SongBookPlayerButton.NOTE_SHEET_BUTTON),n=t.getButton(SongBookPlayerButton.NORMAL_SHEET_BUTTON),l=t.getButton(SongBookPlayerButton.TABLATURE_SHEET_BUTTON);t.toggleNoteNames(),t.getSheetViewer().setDisplayType(SongBookSheetViewer.PART_TYPE),o.setSelected(t.getSheetViewer().isShowNoteNames()),l.setSelected(!1),n.setSelected(!0),t.isPaused()&&t.getSheetViewer().update(t.getCurrentTime())},parts:function(e){var t=e.getPlayerPanel().getPlayer(),o=t.getButton(SongBookPlayerButton.NORMAL_SHEET_BUTTON),n=t.getButton(SongBookPlayerButton.TABLATURE_SHEET_BUTTON),l=t.getCurrentTime();t.getSheetViewer().setDisplayType(SongBookSheetViewer.PART_TYPE),o.setSelected(!0),n.setSelected(!1),t.getSheetViewer().update(l)},tabs:function(e){var t=e.getPlayerPanel().getPlayer(),o=t.getButton(SongBookPlayerButton.NORMAL_SHEET_BUTTON),n=t.getButton(SongBookPlayerButton.TABLATURE_SHEET_BUTTON),l=t.getButton(SongBookPlayerButton.NOTE_SHEET_BUTTON),a=t.getCurrentTime();l.setSelected(!1),t.getSheetViewer().setShowNoteNames(!1),t.getSheetViewer().setDisplayType(SongBookSheetViewer.TAB_TYPE),o.setSelected(!1),n.setSelected(!0),t.getSheetViewer().update(a)}}},SongBookPlayerPanel.prototype.getPlayer=function(){return this.player},SongBookPlayerPanel.prototype.getButtons=function(){return this.buttons},SongBookPlayerPanel.prototype.getButton=function(e){return this.getButtons()[e]},SongBookPlayerPanel.prototype.getElement=function(){return null==this.element&&(this.element=this.getPlayer().getElement().find("div.player-controls")),this.element},SongBookPlayerPanel.prototype.eachButton=function(e){var t=this.getButtons();for(var o in t)e(t[o]);return this},SongBookPlayerPanel.prototype.clearSelectedButton=function(){return this.eachButton(function(e){e.deselect()}),this},SongBookPlayerPanel.prototype.runButton=function(e){var t=SongBookPlayerPanel.BUTTON_FUNCTIONS[e.getType()];void 0==t&&(t={});var o=t[e.getValue()];return"function"==typeof o&&o.call(this,e),this},SongBookPlayerPanel.prototype.buildButtons=function(){var e={},t=this,o=0;return this.getElement().find(SongBookPlayerPanel.CONTROL_BUTTONS_PREFIX).each(function(){var n=jQuery(this),l=new SongBookPlayerButton(t,n);e[o]=l,l.isStartSelected()&&l.setSelected(!0),o++}),e};
function SongBookPlayerButton(t,e){SelectableElement.call(this,e),this.playerPanel=t,this.element=e,this.selected=!1,this.startSelected=null,this.type=null,this.value=null,this.getType(),this.getValue(),this.buildMappings()}SongBookPlayerButton.prototype=Object.create(SelectableElement.prototype),SongBookPlayerButton.prototype.constructor=SongBookPlayerButton,SongBookPlayerButton.NORMAL_VIDEO_BUTTON=0,SongBookPlayerButton.SLOW_VIDEO_BUTTON=1,SongBookPlayerButton.NORMAL_PLAYER_BUTTON=2,SongBookPlayerButton.SLOW_PLAYER_BUTTON=3,SongBookPlayerButton.VERYSLOW_PLAYER_BUTTON=4,SongBookPlayerButton.ULTRASLOW_PLAYER_BUTTON=5,SongBookPlayerButton.ZOOM_SHEET_BUTTON=6,SongBookPlayerButton.NOTE_SHEET_BUTTON=7,SongBookPlayerButton.NORMAL_SHEET_BUTTON=8,SongBookPlayerButton.TABLATURE_SHEET_BUTTON=9,SongBookPlayerButton.prototype.getPlayerPanel=function(){return this.playerPanel},SongBookPlayerButton.prototype.getType=function(){return null==this.type&&(this.type=this.getElement().attr("type")),this.type},SongBookPlayerButton.prototype.getValue=function(){return null==this.value&&(this.value=this.getElement().attr("value")),this.value},SongBookPlayerButton.prototype.getStartSelected=function(){return null==this.startSelected&&(this.startSelected=this.getElement().attr("startSelected"),this.startSelected=this.startSelected+"","true"==this.startSelected?this.startSelected=!0:this.startSelected=!1),this.startSelected},SongBookPlayerButton.prototype.isStartSelected=function(){return 1==this.getStartSelected()},SongBookPlayerButton.prototype.run=function(){return this.getPlayerPanel().runButton(this)},SongBookPlayerButton.prototype.select=function(){return this.setSelected(!0),this.run(),this},SongBookPlayerButton.prototype.buildMappings=function(){var t=this;return this.getElement().click(function(){t.select()}),this};
function SongBookMusicList(t){this.element=null,this.songbook=t,this.list={},this.getElement(),this.buildMusicList()}SongBookMusicList.prototype.getSongBook=function(){return this.songbook},SongBookMusicList.prototype.getList=function(){return this.list},SongBookMusicList.prototype.getElement=function(){return null==this.element&&(this.element=this.getSongBook().getElement().find("ul.smb7-music-list")),this.element},SongBookMusicList.prototype.getMusicElements=function(){return this.getElement().find("li.smb7-music")},SongBookMusicList.prototype.get=function(t){return this.list[t]},SongBookMusicList.prototype.getFirstMusic=function(){return this.get(1)},SongBookMusicList.prototype.add=function(t){return this.list[t.getNumber()]=t,this},SongBookMusicList.prototype.buildMusicList=function(){var t=this;this.getMusicElements().each(function(){var i=jQuery(this);t.add(new SongBookMusic(t.getSongBook(),i))})},SongBookMusicList.prototype.clear=function(){return this.list={},this},SongBookMusicList.prototype.eachMusic=function(t){var i=this.getList();for(var o in i)t(i[o])},SongBookMusicList.prototype.clearSelectedMusic=function(){return this.eachMusic(function(t){t.deselect()}),this},SongBookMusicList.prototype.getSelectedMusic=function(){var t=null;return this.eachMusic(function(i){i.isSelected()&&(t=i)}),null==t?this.getFirstMusic():t},SongBookMusicList.prototype.create=function(){var t=this.getSongBook().getFirstMusicElement(),i=this;return this.getSongBook().getConfiguration().getMusicMap().each(function(o,e){var s=i.getSongBook().getLastMusicElement(),n=t.clone(),u=o;o<=9&&(o="0"+u);var c=e.getName(),r=e.getTonality(),g=e.getComposer(),l=e.getSpotifyLink(),h=e.getOpenLink();n.find("div.smb7-music-number").html(u),n.find("em.m-name").html(c+" ("+r+")"),n.find("em.m-composer").html(g),n.find("a.music-button.spotify").attr("href",l),n.find("a.music-button.play").attr("href",h),n.insertAfter(s)}),this.clear(),t.remove(),this.buildMusicList(),this};
function SongBookMusic(t,e){SelectableElement.call(this,e),this.songbook=t,this.element=e,this.number=null,this.name=null,this.composer=null,this.tonality=null,this.youtubeUrl="",this.buttons={},this.selected=!1,this.partList=new SongBookMusicPartList(this),this.getName(),this.getComposer(),this.getTonality(),this.buildMappings()}SongBookMusic.prototype=Object.create(SelectableElement.prototype),SongBookMusic.prototype.constructor=SongBookMusic,SongBookMusic.prototype.getSongBook=function(){return this.songbook},SongBookMusic.prototype.getConfig=function(){return this.getSongBook().getConfiguration().getMusic(this.getNumber())},SongBookMusic.prototype.getNumberElement=function(){return this.getElement().find("div.smb7-music-number")},SongBookMusic.prototype.getNameElement=function(){return this.getElement().find("div.smb7-music-info em.m-name")},SongBookMusic.prototype.getComposerElement=function(){return this.getElement().find("div.smb7-music-info em.m-composer")},SongBookMusic.prototype.getPartList=function(){return this.partList},SongBookMusic.prototype.getFirstPart=function(){return this.getPartList().getFirstPart()},SongBookMusic.prototype.getSelectedPart=function(){return this.getPartList().getSelectedPart()},SongBookMusic.prototype.selectFirstPart=function(){this.clearSelectedPart();var t=this.getFirstPart();return void 0!=t&&t.setSelected(!0),this},SongBookMusic.prototype.getPart=function(t){return this.getPartList().get(t)},SongBookMusic.prototype.removePart=function(t){var e=this.getPart(t);return void 0!=e&&e.getElement().remove(),this.getConfig().removePart(t),this.getPartList().remove(t),this},SongBookMusic.prototype.getNumber=function(){return null==this.number&&(this.number=this.getNumberElement().text(),this.number=1*this.number,isNaN(this.number)&&(this.number=0)),this.number},SongBookMusic.prototype.setYoutubeUrl=function(t){return this.youtubeUrl=t,this},SongBookMusic.prototype.getYoutubeUrl=function(){return this.youtubeUrl},SongBookMusic.prototype.setNumber=function(t){return this.number=t,this},SongBookMusic.prototype.getName=function(){return null==this.name&&(this.name=this.getNameElement().text(),void 0!=this.name&&null!=this.name||(this.name="")),this.name},SongBookMusic.prototype.setName=function(t){return this.name=t,this},SongBookMusic.prototype.getComposer=function(){return null==this.composer&&(this.composer=this.getComposerElement().text(),void 0!=this.composer&&null!=this.composer||(this.composer="")),this.composer},SongBookMusic.prototype.setComposer=function(t){return this.composer=t,this},SongBookMusic.prototype.getTonality=function(){if(null==this.tonality&&(this.tonality=this.getName(),this.tonality.indexOf("(")>-1)){var t=this.tonality.split(" ");this.tonality=t[t.length-1],this.tonality=this.tonality.replace("(",""),this.tonality=this.tonality.replace(")","")}return this.tonality},SongBookMusic.prototype.setTonality=function(t){return this.tonality=t,this},SongBookMusic.prototype.setSheetStartTime=function(t){return this.getSongBook().getConfiguration().getMusic(this.getNumber()).setSheetStartTime(t),this},SongBookMusic.prototype.setSheetEndTime=function(t){return this.getSongBook().getConfiguration().getMusic(this.getNumber()).setSheetEndTime(t),this},SongBookMusic.prototype.select=function(){return this.getSongBook().getMusicList().clearSelectedMusic(),this.setSelected(!0),this.getSongBook().getPlayer().hideSheets(),this.getSongBook().getPlayer().seekTo(0),this.getSongBook().getMusicPanel().setCurrentSongBookMusic(this),this.getSongBook().updateInfo(),this.getSongBook().getMusicPanel().populateMusicParts(this),void 0!=this.getSongBook().getDebugger()&&this.getSongBook().getDebugger().isDebugging()&&(this.getSongBook().getDebugger().setReview(!1),this.getSongBook().getDebugger().setEditing(!1),this.getSongBook().getDebugger().updateOutput()),this},SongBookMusic.prototype.clearSelectedPart=function(){return this.getPartList().clearSelectedPart(),this},SongBookMusic.prototype.open=function(){return this.select(),this},SongBookMusic.prototype.eachPart=function(t){return this.getPartList().eachPart(t)},SongBookMusic.prototype.createPart=function(t,e){var o=this.getSongBook(),i=this.getPartList(),n=t.getNumber(),s=SongBookMusicConfig.SYNC_PREFIX+"."+SongBookSheetViewer.PART_TYPE+"."+e+"."+n;t.setDisplay(n),this.getConfig().put(s,{}),this.getConfig().addPart(n,t),i.add(n,new SongBookMusicPart(i.getSongBookMusic(),t)),o.getMusicPanel().populateMusicParts(this)},SongBookMusic.prototype.reorderParts=function(){var t=this.getPartList(),e=1;return this.getConfig().getPartMap().sort(e,function(t,o){return o.setNumber(e),e+=1}),e=1,t.sort(e,function(t,o){return o.setNumber(e),e+=1}),this},SongBookMusic.prototype.buildMappings=function(){var t=this;this.getElement().click(function(){return t.open(),t.getSongBook().toggleMenu(),!1})};
function SongBookMusicPanel(t){this.element=null,this.songbook=t,this.currentSongBookMusic=null,this.getElement()}SongBookMusicPanel.prototype.getSongBook=function(){return this.songbook},SongBookMusicPanel.prototype.getCurrentSongBookMusic=function(){return this.currentSongBookMusic},SongBookMusicPanel.prototype.setCurrentSongBookMusic=function(t){return this.currentSongBookMusic=t,this},SongBookMusicPanel.prototype.getElement=function(){return null==this.element&&(this.element=this.getSongBook().getElement().find("div.smb7-music-panel")),this.element},SongBookMusicPanel.prototype.clear=function(){return this.getPartsElement().html("<li></li>"),this},SongBookMusicPanel.prototype.getPartsElement=function(){return this.getElement().find("ul.songbook-music-part-list")},SongBookMusicPanel.prototype.getFirstPartElement=function(){return this.getPartsElement().find("li:first")},SongBookMusicPanel.prototype.getLastPartElement=function(){return this.getPartsElement().find("li:last")},SongBookMusicPanel.prototype.selectFirstPart=function(){var t=this.getCurrentSongBookMusic().getFirstPart();return null!=t&&void 0!=t&&t.select(),this},SongBookMusicPanel.prototype.populateMusicParts=function(t){var e=this;e.clear();var o=this.getFirstPartElement();return t.eachPart(function(t){var n=e.getLastPartElement(),i=o.clone();i.text(t.getDisplay()),i.insertAfter(n),t.setElement(i)}),o.remove(),e.selectFirstPart(),this};
function SongBookMusicPartList(t){this.songBookMusic=t,this.list={},this.buildMusicPartList()}SongBookMusicPartList.prototype.getSongBookMusic=function(){return this.songBookMusic},SongBookMusicPartList.prototype.getList=function(){return this.list},SongBookMusicPartList.prototype.get=function(t){return this.list[t]},SongBookMusicPartList.prototype.getFirstPart=function(){return this.get(1)},SongBookMusicPartList.prototype.eachPart=function(t){var o=this.getList();for(var i in o)if(0==t(o[i]))break;return this},SongBookMusicPartList.prototype.clearSelectedPart=function(){return this.eachPart(function(t){t.deselect()}),this},SongBookMusicPartList.prototype.getSelectedPart=function(){var t=null;return this.eachPart(function(o){o.isSelected()&&(t=o)}),null==t?this.getFirstPart():t},SongBookMusicPartList.prototype.add=function(t,o){return this.list[t]=o,this},SongBookMusicPartList.prototype.remove=function(t){return delete this.list[t],this},SongBookMusicPartList.prototype.sort=function(t,o){var i=this.list,s={};for(var r in i){var n=i[r];s[t]=n,t=o.call(this,r,n)}return this.list=s,this},SongBookMusicPartList.prototype.buildMusicPartList=function(){var t=this,o=this.getSongBookMusic().getSongBook().getConfiguration(),i=this.getSongBookMusic().getNumber(),s=o.getMusic(i);return void 0==s?this:(s.eachPart(function(o,i){t.add(o,new SongBookMusicPart(t.getSongBookMusic(),i))}),this)};
function SongBookMusicPart(t,o){SelectableElement.call(this),this.songBookMusic=t,this.element=null,this.partConfig=o,this.selected=!1}SongBookMusicPart.prototype=Object.create(SelectableElement.prototype),SongBookMusicPart.prototype.constructor=SongBookMusicPart,SongBookMusicPart.prototype.getSongBookMusic=function(){return this.songBookMusic},SongBookMusicPart.prototype.getElement=function(){return null==this.element?jQuery():this.element},SongBookMusicPart.prototype.setElement=function(t){return this.element=t,this.buildMappings(),this},SongBookMusicPart.prototype.getPartConfig=function(){return this.partConfig},SongBookMusicPart.prototype.setNumber=function(t){return this.getElement().text(t),this},SongBookMusicPart.prototype.getSlowBarMap=function(){return this.getPartConfig().getSlowBarMap()},SongBookMusicPart.prototype.getNormalBarMap=function(){return this.getPartConfig().getNormalBarMap()},SongBookMusicPart.prototype.getNumber=function(){return this.getPartConfig().getNumber()},SongBookMusicPart.prototype.getDisplay=function(){return this.getPartConfig().getDisplay()},SongBookMusicPart.prototype.getSlowSyncStartTime=function(){return this.getPartConfig().getSlowSeekStartTime()},SongBookMusicPart.prototype.getSlowSyncEndTime=function(){return this.getPartConfig().getSlowSeekEndTime()},SongBookMusicPart.prototype.getSlowSyncTime=function(){return this.getSlowSyncStartTime()},SongBookMusicPart.prototype.getNormalSyncStartTime=function(){return this.getPartConfig().getNormalSeekStartTime()},SongBookMusicPart.prototype.getNormalSyncEndTime=function(){return this.getPartConfig().getNormalSeekEndTime()},SongBookMusicPart.prototype.getNormalSyncTime=function(){return this.getNormalSyncStartTime()},SongBookMusicPart.prototype.select=function(t){void 0==t&&(t=!1),this.getSongBookMusic().getPartList().clearSelectedPart(),this.setSelected(!0);var o=this.getSongBookMusic().getSongBook().getPlayer();return this.getSongBookMusic().getSongBook().getDebugger().isEditing()||(t?(o.setPlaySpeedType(SongBookPlayer.PLAY_NORMAL_SPEED_TYPE),o.seekTo(this.getNormalSyncTime())):o.getPlaySpeedType()==SongBookPlayer.PLAY_NORMAL_SPEED_TYPE?o.seekTo(this.getNormalSyncTime()):o.seekTo(this.getSlowSyncTime())),this},SongBookMusicPart.prototype.removeBar=function(t,o){return this.getPartConfig().removeBar(t,o),this},SongBookMusicPart.prototype.reorderBarsFrom=function(t,o){var e=1;return void 0!=o&&(e=o),t.sort(e,function(t,o){return o.setNumber(e),o.hasCustomLineBars()?e+=o.getCustomLineBars():e+=BarDebuggerOutput.BARS_PER_LINE,e}),e},SongBookMusicPart.prototype.reorderBars=function(t){return this.reorderBarsFrom(this.getNormalBarMap(),t),this.reorderBarsFrom(this.getSlowBarMap(),t),this},SongBookMusicPart.prototype.buildMappings=function(){var t=this;return this.getElement().click(function(){t.select(!0)}),this};
